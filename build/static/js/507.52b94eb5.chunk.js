"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[507],{4998:function(e,t,r){r.d(t,{r:function(){return h}});var a,n,o,s,i,_,c=r(2791),l=["title","titleId"];function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},d.apply(this,arguments)}function u(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function f(e,t){var r=e.title,f=e.titleId,h=u(e,l);return c.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":f},h),r?c.createElement("title",{id:f},r):null,a||(a=c.createElement("path",{d:"M6,15H36",transform:"translate(6 15)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),n||(n=c.createElement("path",{d:"M36,19H6",transform:"translate(6 19)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),o||(o=c.createElement("path",{d:"M15,11H27",transform:"translate(15 11)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),s||(s=c.createElement("path",{d:"M27,7H15",transform:"translate(15 7)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),i||(i=c.createElement("path",{d:"M9,12.5h2a2,2,0,1,1-2,2v-5a4,4,0,0,1,4-4",transform:"translate(9 5.5)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),_||(_=c.createElement("path",{d:"M3,12.5H5a2,2,0,1,1-2,2v-5a4,4,0,0,1,4-4",transform:"translate(3 5.5)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var h=c.forwardRef(f);r.p},8859:function(e,t,r){r(2791);t.Z=r.p+"static/media/star-empty-half-rtl.115b4ca6259808a2530cc7ed54a5980d.svg"},9528:function(e,t,r){r(2791);t.Z=r.p+"static/media/star-empty.094ca61be3c7cac574115be9ba058f0e.svg"},7852:function(e,t,r){r(2791);t.Z=r.p+"static/media/star-filled-half.761b90355c2504219c50b81be5514339.svg"},9186:function(e,t,r){r(2791);t.Z=r.p+"static/media/star-filled.cdd8f18fce9ac9a685489286d8f9e501.svg"},4254:function(e,t,r){var a=r(9528),n=r(9186),o=r(7852),s=r(8859),i=r(184);t.Z=function(e){var t=e.rating,r=e.size;return(0,i.jsx)("div",{className:function(){var e=["stars"];return"small"===r&&e.push("stars--small"),e.join(" ")}(),children:function(e){for(var t=[],r=1;r<=5;r++)r<=e?t.push((0,i.jsx)("div",{className:"stars__star",children:(0,i.jsx)("img",{src:n.Z,alt:"star",className:"stars__star__icon",loading:"lazy"})},"STAR"+r)):e<r&&e>r-1?t.push((0,i.jsxs)("div",{className:"stars__star",children:[(0,i.jsx)("img",{src:o.Z,alt:"half star",className:"stars__star__icon stars__star__icon--half",loading:"lazy"}),(0,i.jsx)("img",{src:s.Z,alt:"half star",className:"stars__star__icon stars__star__icon--half",loading:"lazy"})]},"STAR"+r)):t.push((0,i.jsx)("div",{className:"stars__star",children:(0,i.jsx)("img",{src:a.Z,alt:"empty star",className:"stars__star__icon",loading:"lazy"})},"STAR"+r));return t}(t)})}},2507:function(e,t,r){r.r(t),r.d(t,{default:function(){return et}});var a,n,o,s,i,_,c=r(1413),l=r(5861),d=r(885),u=r(7757),f=r.n(u),h=r(4569),p=r.n(h),m=r(2426),b=r.n(m),k=r(6030),v=r(6871),y=r(2791),g=r(8979),j=r(733),w=r(4254),x=r(5454),O=r(6539),N=r(9018),E=r(3958),Z=r(7928),R=r(5899),S=r(9316),L=r(184),T=function(e){var t=e.book,r=e.userCopy,a=e.onListHandler,n=(0,k.I0)(),o=(0,k.v9)((function(e){return e.ModalState})),s=(0,y.useState)(!1),i=(0,d.Z)(s,2),_=i[0],c=i[1],l=(0,y.useState)(""),u=(0,d.Z)(l,2),f=u[0],h=u[1];(0,y.useEffect)((function(){!0===o.show&&o.type===Z.gG?((0,R.Z)("modal_view_list_books"),c(!0)):c(!1)}),[o]);return(0,S.fb)(r)&&(0,S.fb)(t)?(0,L.jsx)(N.Z,{show:_,children:(0,L.jsxs)(O.Z,{title:"List eBook",open:_,toggleModal:function(e){!1===e&&n((0,Z.VG)())},cancellable:!0,children:[(0,L.jsxs)("p",{className:"utils__margin__bottom--n typo__transform--capital",children:["Book: ",t.title]}),(0,L.jsxs)("p",{className:"utils__margin__bottom--n typo__transform--capital",children:["Author: ",t.author]}),(0,L.jsxs)("p",{className:"typo__transform--capital",children:["purchased at: ",(0,S.fb)(r.purchase_price)?parseFloat(r.purchase_price).toFixed(2):null]}),(0,L.jsxs)("p",{className:"typo__transform--capital",children:["DA Score: ",(0,S.fb)(r.da_score)?parseFloat(r.da_score).toFixed(2):null]}),(0,L.jsx)(E.Z,{type:"string",label:"listing price in USDC",onChange:function(e){return h(e.target.value)}}),(0,L.jsx)("div",{style:{flex:1}}),(0,L.jsx)(x.Z,{type:"primary",onClick:function(){return a(f)},children:"List eBook"})]})}):null},P=function(e){var t=e.QuotesForm,r=e.setQuotesForm,a=e.quoteHandler,n=(0,k.I0)(),o=(0,k.v9)((function(e){return e.ModalState})),s=(0,y.useState)(!1),i=(0,d.Z)(s,2),_=i[0],l=i[1];(0,y.useEffect)((function(){!0===o.show&&o.type===Z.D4?((0,R.Z)("modal_view_quote"),l(!0)):l(!1)}),[o]);return(0,L.jsx)(N.Z,{show:_,children:(0,L.jsxs)(O.Z,{title:"Write Quote",open:_,toggleModal:function(e){!1===e&&n((0,Z.VG)())},cancellable:!0,children:[(0,L.jsx)(E.Z,{type:"string",label:"quote",value:t.quote,onChange:function(e){return r((0,c.Z)((0,c.Z)({},t),{},{quote:e.target.value}))}}),(0,L.jsx)(x.Z,{className:"utils__margin__top--m utils__margin__left--auto",type:"primary",onClick:function(){return a()},children:"submit"})]})})},A=r(9528),C=r(9186),M=r(7852),F=r(8859),W=function(e){var t=e.ReviewForm,r=e.setReviewForm,a=e.reviewHandler,n=(0,k.I0)(),o=(0,k.v9)((function(e){return e.ModalState})),s=(0,y.useState)(!1),i=(0,d.Z)(s,2),_=i[0],l=i[1];(0,y.useEffect)((function(){!0===o.show&&o.type===Z.wW?((0,R.Z)("modal_view_review"),l(!0)):l(!1)}),[o]);return(0,L.jsx)(N.Z,{show:_,children:(0,L.jsxs)(O.Z,{title:"Review",open:_,toggleModal:function(e){!1===e&&n((0,Z.VG)())},cancellable:!0,children:[(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__review__rating",children:function(){for(var e=[],a=function(a){a<=t.rating?e.push((0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__review__rating__item",children:[(0,L.jsx)("img",{src:C.Z,alt:"star",className:"book__data__container__desc__tabs__data__review__rating__item__icon",loading:"lazy"}),(0,L.jsx)("div",{onClick:function(){return r((0,c.Z)((0,c.Z)({},t),{},{rating:a-.5}))},className:"book__data__container__desc__tabs__data__review__rating__item__trigger"}),(0,L.jsx)("div",{onClick:function(){return r((0,c.Z)((0,c.Z)({},t),{},{rating:a}))},className:"book__data__container__desc__tabs__data__review__rating__item__trigger"})]},"STAR"+a)):t.rating<a&&t.rating>a-1?e.push((0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__review__rating__item",children:[(0,L.jsx)("img",{src:M.Z,alt:"half star",className:"book__data__container__desc__tabs__data__review__rating__item__icon book__data__container__desc__tabs__data__review__rating__item__icon--half",loading:"lazy"}),(0,L.jsx)("img",{src:F.Z,alt:"half star",className:"book__data__container__desc__tabs__data__review__rating__item__icon book__data__container__desc__tabs__data__review__rating__item__icon--half",loading:"lazy"}),(0,L.jsx)("div",{onClick:function(){return r((0,c.Z)((0,c.Z)({},t),{},{rating:a-.5}))},className:"book__data__container__desc__tabs__data__review__rating__item__trigger"}),(0,L.jsx)("div",{onClick:function(){return r((0,c.Z)((0,c.Z)({},t),{},{rating:a}))},className:"book__data__container__desc__tabs__data__review__rating__item__trigger"})]},"STAR"+a)):e.push((0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__review__rating__item",children:[(0,L.jsx)("img",{src:A.Z,alt:"empty star",className:"book__data__container__desc__tabs__data__review__rating__item__icon",loading:"lazy"}),(0,L.jsx)("div",{onClick:function(){return r((0,c.Z)((0,c.Z)({},t),{},{rating:a-.5}))},className:"book__data__container__desc__tabs__data__review__rating__item__trigger"}),(0,L.jsx)("div",{onClick:function(){return r((0,c.Z)((0,c.Z)({},t),{},{rating:a}))},className:"book__data__container__desc__tabs__data__review__rating__item__trigger"})]},"STAR"+a))},n=1;n<=5;n++)a(n);return e}()}),(0,L.jsx)(E.Z,{type:"string",label:"title",value:t.title,onChange:function(e){return r((0,c.Z)((0,c.Z)({},t),{},{title:e.target.value}))}}),(0,L.jsx)(E.Z,{type:"text",label:"body",value:t.body,onChange:function(e){return r((0,c.Z)((0,c.Z)({},t),{},{body:e.target.value}))}}),(0,L.jsx)(x.Z,{className:"utils__margin__top--m",type:"primary",onClick:function(){return a()},children:"submit"})]})})},B=r(4643),I=r(4127),H=r(9135),G=["title","titleId"];function V(){return V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},V.apply(this,arguments)}function Y(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function q(e,t){var r=e.title,c=e.titleId,l=Y(e,G);return y.createElement("svg",V({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:t,"aria-labelledby":c},l),r?y.createElement("title",{id:c},r):null,a||(a=y.createElement("path",{d:"M0,0H24V24H0Z",fill:"none"})),n||(n=y.createElement("path",{d:"M3,7v4a1,1,0,0,0,1,1H7",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),o||(o=y.createElement("path",{d:"M7,7V17",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),s||(s=y.createElement("path",{d:"M10,8v8a1,1,0,0,0,1,1h2a1,1,0,0,0,1-1V8a1,1,0,0,0-1-1H11A1,1,0,0,0,10,8Z",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),i||(i=y.createElement("path",{d:"M17,7v4a1,1,0,0,0,1,1h3",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),_||(_=y.createElement("path",{d:"M21,7V17",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})))}var D=y.forwardRef(q),z=(r.p,r(5248)),U=function(e){var t=e.onOldBookPurchase,r=e.onNewBookPurchase,a=e.data,n=(0,k.I0)(),o=(0,k.v9)((function(e){return e.UserState})),s=(0,k.v9)((function(e){return e.ModalState})),i=(0,y.useState)(!1),_=(0,d.Z)(i,2),c=_[0],l=_[1],u=(0,y.useState)([]),f=(0,d.Z)(u,2),h=f[0],m=f[1],b=(0,y.useState)(!1),v=(0,d.Z)(b,2),g=v[0],j=v[1],w=(0,y.useState)(0),O=(0,d.Z)(w,2),E=O[0],T=O[1],P=(0,y.useState)(null),A=(0,d.Z)(P,2),C=A[0],M=A[1],F=function(){if((0,S.vd)(h)){var e=h.sort((function(e,t){return e.price>t.price}));return parseFloat(e[0].price).toFixed(2)}};return(0,y.useEffect)((function(){window.document.documentElement.style.overflowY=c?"hidden":"auto"}),[c]),(0,y.useEffect)((function(){n(g?(0,I.yh)():(0,I.v3)())}),[g,n]),(0,y.useEffect)((function(){!0===s.show&&s.type===Z.m0?((0,R.Z)("modal_view_purchase"),l(!0)):l(!1)}),[s]),(0,y.useEffect)((function(){!0===c&&(0,S.fb)(a)&&p()({url:z._+"/api/book/list",method:"GET",headers:{"user-id":o.user.uid,authorization:"Bearer ".concat(o.tokens.acsTkn.tkn)},params:{bookAddress:a.book_address}}).then((function(e){200===e.status?m(e.data):n((0,B.e1)("NOT200"))})).catch((function(e){n((0,B.e1)("ERROR"))})).finally((function(){return j(!1)}))}),[c,n,a,o]),(0,L.jsx)(N.Z,{show:c,children:(0,L.jsxs)("div",{className:function(){var e=["purchase purchase__wrapper"];return c?e.push("purchase__wrapper--open"):e.push("purchase__wrapper--close"),e.join(" ")}(),children:[(0,L.jsxs)("div",{className:"purchase__wrapper__header",children:[(0,L.jsx)("div",{className:"purchase__wrapper__header__title typo__head--6 typo__transform--capital",children:a.title.toLowerCase()}),(0,L.jsx)("div",{className:"purchase__wrapper__header__close-button",children:(0,L.jsx)("div",{onClick:function(){return l(!1)},children:(0,L.jsx)(H.r,{width:20,height:20})})})]}),(0,L.jsx)("div",{className:"purchase__wrapper__content",children:E?(0,L.jsxs)("div",{className:"purchase__wrapper__content__offers",children:[(0,L.jsxs)("div",{className:"typo__body typo__body--2 utils__d__flex purchase__wrapper__content__offers__count",children:[h.length," offer(s) starting from\xa0",0===a.price?"FREE":(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",F()]})]}),(0,L.jsx)("div",{className:"purchase__wrapper__content__offers__list",children:function(){var e=[];return(0,S.vd)(h)&&h.forEach((function(t){t.previous_owner===(null===C||void 0===C?void 0:C.previous_owner)?e.push((0,L.jsxs)("div",{className:"purchase__wrapper__content__offers__item purchase__wrapper__content__offers__item--active",children:[(0,L.jsxs)("p",{className:"utils__margin__bottom--n utils__d__flex utils__align__center",children:["Price:\xa0",0===t.price?"FREE":(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",(0,S.fb)(t.price)?parseFloat(t.price).toFixed(2):null]})]}),(0,L.jsxs)("p",{className:"utils__margin__bottom--n",children:["DA Score: ",(0,S.fb)(t.da_score)?parseFloat(t.da_score).toFixed(2):null]}),(0,L.jsxs)("p",{className:"utils__margin__bottom--n",children:["Seller: ",t.previous_owner]})]},t.book_address+"-"+t.order_id)):e.push((0,L.jsxs)("div",{onClick:function(){return M(t)},className:"purchase__wrapper__content__offers__item",children:[(0,L.jsxs)("p",{className:"utils__margin__bottom--n utils__d__flex utils__align__center",children:["Price:\xa0",0===t.price?"FREE":(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",(0,S.fb)(t.price)?parseFloat(t.price).toFixed(2):null]})]}),(0,L.jsxs)("p",{className:"utils__margin__bottom--n",children:["DA Score: ",(0,S.fb)(t.da_score)?parseFloat(t.da_score).toFixed(2):null]}),(0,L.jsxs)("p",{className:"utils__margin__bottom--n",children:["Seller: ",t.previous_owner]})]},t.book_address+"-"+t.order_id))})),0===e.length&&e.push((0,L.jsx)("div",{className:"typo__color--n600 utils__d__flex utils__justify__center",children:"No Offers"})),e}()}),(0,L.jsxs)("div",{className:"purchase__wrapper__content__offers__cta",children:[(0,L.jsx)(x.Z,{type:"secondary",onClick:function(){return T(!1)},className:"purchase__wrapper__content__offers__cta__button",children:"Back"}),(0,L.jsx)(x.Z,{type:"primary",onClick:function(){(0,S.fb)(C)?t(C):n((0,B.e1)({show:!0,message:"Please select an old copy.",type:3}))},className:"purchase__wrapper__content__offers__cta__button",children:"Purchase"})]})]}):(0,L.jsxs)("div",{className:"purchase__wrapper__content__options",children:[(0,L.jsxs)("div",{className:"purchase__wrapper__content__options__item",onClick:function(){return r()},children:[(0,L.jsx)("p",{className:"typo__body utils__d__flex typo__align--center",children:"Purchase new copy for"}),(0,L.jsx)("h5",{className:"typo__head typo__head--4 typo__transform--upper utils__d__flex utils__align__center",children:0===a.price?"FREE":(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:32,height:32,objectFit:"contain"},alt:"USDC"}),"\xa0",parseFloat(a.price).toFixed(2)]})})]}),(0,S.vd)(h)?(0,L.jsxs)("div",{className:"purchase__wrapper__content__options__item",onClick:function(){return T(!0)},children:[(0,L.jsx)("p",{className:"typo__body utils__d__flex typo__align--center",children:"Old copies start from"}),(0,L.jsx)("h5",{className:"typo__head typo__head--4 typo__transform--upper utils__d__flex utils__align__center",children:0===a.price?"FREE":(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:32,height:32,objectFit:"contain"},alt:"USDC"}),"\xa0",F()]})})]}):(0,L.jsxs)("div",{className:"purchase__wrapper__content__options__item",children:[(0,L.jsx)("p",{className:"typo__body utils__d__flex typo__align--center",children:"No old copies available yet."}),(0,L.jsxs)("h5",{className:"typo__head typo__head--4 typo__transform--upper utils__d__flex utils__align__center",children:["\xa0",(0,L.jsx)(D,{height:32,width:32})]})]})]})})]})})},Q=r(2043),K=r(6026),J=r(7793);var X,$=r.p+"static/media/background-book.ab78f91e6c81e45864253502041ae721.svg",ee=["title","titleId"];function te(){return te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},te.apply(this,arguments)}function re(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ae(e,t){var r=e.title,a=e.titleId,n=re(e,ee);return y.createElement("svg",te({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":a},n),r?y.createElement("title",{id:a},r):null,X||(X=y.createElement("path",{d:"M36.013,22.155l-15,14.856-15-14.856m0,0a10,10,0,1,1,15-13.132,10,10,0,1,1,15,13.139",transform:"translate(2.987 4.989)",fill:"rgba(32,33,36,0)",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var ne,oe,se,ie=y.forwardRef(ae),_e=(r.p,["title","titleId"]);function ce(){return ce=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ce.apply(this,arguments)}function le(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function de(e,t){var r=e.title,a=e.titleId,n=le(e,_e);return y.createElement("svg",ce({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":a},n),r?y.createElement("title",{id:a},r):null,ne||(ne=y.createElement("path",{d:"M31,25h4a4,4,0,0,0,4-4V13a4,4,0,0,0-4-4H7a4,4,0,0,0-4,4v8a4,4,0,0,0,4,4h4",transform:"translate(3 9)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),oe||(oe=y.createElement("path",{d:"M27,15V7a4,4,0,0,0-4-4H11A4,4,0,0,0,7,7v8",transform:"translate(7 3)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),se||(se=y.createElement("rect",{width:20,height:16,rx:2,transform:"translate(14 26)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var ue,fe=y.forwardRef(de),he=(r.p,["title","titleId"]);function pe(){return pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pe.apply(this,arguments)}function me(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function be(e,t){var r=e.title,a=e.titleId,n=me(e,he);return y.createElement("svg",pe({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":a},n),r?y.createElement("title",{id:a},r):null,ue||(ue=y.createElement("g",{transform:"translate(48 48) rotate(180)"},y.createElement("path",{d:"M15,16H7a2,2,0,0,1-2-2V8A2,2,0,0,1,7,6h6a2,2,0,0,1,2,2V20q0,8-8,10",transform:"translate(5 6)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6}),y.createElement("path",{d:"M24,16H16a2,2,0,0,1-2-2V8a2,2,0,0,1,2-2h6a2,2,0,0,1,2,2V20q0,8-8,10",transform:"translate(14 6)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6}))))}var ke,ve,ye,ge,je,we=y.forwardRef(be),xe=(r.p,["title","titleId"]);function Oe(){return Oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Oe.apply(this,arguments)}function Ne(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ee(e,t){var r=e.title,a=e.titleId,n=Ne(e,xe);return y.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":a},n),r?y.createElement("title",{id:a},r):null,ke||(ke=y.createElement("circle",{cx:4,cy:4,r:4,transform:"translate(8 34)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),ve||(ve=y.createElement("circle",{cx:4,cy:4,r:4,transform:"translate(30 34)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),ye||(ye=y.createElement("path",{d:"M30,31H8V3H4",transform:"translate(4 3)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),ge||(ge=y.createElement("path",{d:"M6,5l12.01.858M32.286,19,32,21H6",transform:"translate(6 5)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),je||(je=y.createElement("path",{d:"M15,9H27M21,3V15",transform:"translate(15 3)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var Ze,Re,Se,Le=y.forwardRef(Ee),Te=(r.p,["title","titleId"]);function Pe(){return Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Pe.apply(this,arguments)}function Ae(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ce(e,t){var r=e.title,a=e.titleId,n=Ae(e,Te);return y.createElement("svg",Pe({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":a},n),r?y.createElement("title",{id:a},r):null,Ze||(Ze=y.createElement("line",{x2:32,transform:"translate(8 12)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Re||(Re=y.createElement("line",{x2:32,transform:"translate(8 24)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Se||(Se=y.createElement("line",{x2:24,transform:"translate(8 36)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var Me,Fe,We,Be=y.forwardRef(Ce),Ie=(r.p,["title","titleId"]);function He(){return He=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},He.apply(this,arguments)}function Ge(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ve(e,t){var r=e.title,a=e.titleId,n=Ge(e,Ie);return y.createElement("svg",He({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":a},n),r?y.createElement("title",{id:a},r):null,Me||(Me=y.createElement("path",{d:"M4,37V11a6,6,0,0,1,6-6H30a6,6,0,0,1,6,6V23a6,6,0,0,1-6,6H12L4,37",transform:"translate(4 5)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Fe||(Fe=y.createElement("line",{x2:16,transform:"translate(16 18)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),We||(We=y.createElement("line",{x2:12,transform:"translate(16 26)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var Ye,qe,De,ze=y.forwardRef(Ve),Ue=(r.p,r(4998)),Qe=["title","titleId"];function Ke(){return Ke=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ke.apply(this,arguments)}function Je(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Xe(e,t){var r=e.title,a=e.titleId,n=Je(e,Qe);return y.createElement("svg",Ke({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":a},n),r?y.createElement("title",{id:a},r):null,Ye||(Ye=y.createElement("path",{d:"M18,7H8a4,4,0,0,0-4,4V29a4,4,0,0,0,4,4H26a4,4,0,0,0,4-4V19",transform:"translate(4 7)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),qe||(qe=y.createElement("line",{y1:20,x2:20,transform:"translate(20 8)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),De||(De=y.createElement("path",{d:"M15,4H25V14",transform:"translate(15 4)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var $e=y.forwardRef(Xe),et=(r.p,function(e){var t=[{id:"TAB01",label:"Synopsis",icon:(0,L.jsx)(Be,{})},{id:"TAB02",label:"reviews",icon:(0,L.jsx)(ze,{})},{id:"TAB03",label:"quotes",icon:(0,L.jsx)(Ue.r,{})}],r=(0,v.TH)(),a=(0,k.I0)(),n=(0,v.s0)(),o=(0,J.Z)(),s=(0,k.v9)((function(e){return e.UserState})),i=(0,k.v9)((function(e){return e.WalletState})),_=(0,y.useState)(null),u=(0,d.Z)(_,2),h=u[0],m=u[1],O=(0,y.useState)(!1),N=(0,d.Z)(O,2),E=N[0],A=N[1],C=(0,y.useState)("TAB01"),M=(0,d.Z)(C,2),F=M[0],H=M[1],G=(0,y.useState)(null),V=(0,d.Z)(G,2),Y=V[0],q=V[1],D=(0,y.useState)(null),X=(0,d.Z)(D,2),ee=X[0],te=X[1],re=(0,y.useState)(null),ae=(0,d.Z)(re,2),ne=ae[0],oe=ae[1],se=(0,y.useState)(null),_e=(0,d.Z)(se,2),ce=_e[0],le=_e[1],de=(0,y.useState)(null),ue=(0,d.Z)(de,2),he=ue[0],pe=ue[1],me=(0,y.useState)(0),be=(0,d.Z)(me,2),ke=be[0],ve=be[1],ye=(0,y.useState)(!1),ge=(0,d.Z)(ye,2),je=ge[0],xe=ge[1],Oe=(0,y.useState)(0),Ne=(0,d.Z)(Oe,2),Ee=Ne[0],Ze=Ne[1],Re=(0,y.useState)(null),Se=(0,d.Z)(Re,2),Te=Se[0],Pe=Se[1],Ae=(0,y.useState)([]),Ce=(0,d.Z)(Ae,2),Me=Ce[0],Fe=Ce[1],We=(0,y.useState)(0),Ie=(0,d.Z)(We,2),He=Ie[0],Ge=Ie[1],Ve=(0,y.useState)({title:"",body:"",rating:0}),Ye=(0,d.Z)(Ve,2),qe=Ye[0],De=Ye[1],Qe=(0,y.useState)(null),Ke=(0,d.Z)(Qe,2),Je=Ke[0],Xe=Ke[1],et=(0,y.useState)([]),tt=(0,d.Z)(et,2),rt=tt[0],at=tt[1],nt=(0,y.useState)({quote:""}),ot=(0,d.Z)(nt,2),st=ot[0],it=ot[1],_t=(0,y.useState)(0),ct=(0,d.Z)(_t,2),lt=ct[0],dt=ct[1],ut=(0,y.useState)(0),ft=(0,d.Z)(ut,2),ht=ft[0],pt=ft[1],mt=(0,y.useRef)();(0,y.useEffect)((function(){(0,R.Z)("page_view_book")}),[]),(0,y.useEffect)((function(){"TAB01"===F?(0,R.Z)("tab_view_book_synopsis"):"TAB02"===F?(0,R.Z)("tab_view_book_reviews"):(0,R.Z)("tab_view_book_quotes")}),[F]),(0,y.useEffect)((function(){(0,S.fb)(Y)&&oe(1===Y.listed)}),[Y]);var bt=(0,y.useCallback)((function(){(0,S.fb)(Y)&&(A(!0),p()({url:"".concat(z._,"/api/book/reviews"),method:"GET",params:{bookAddress:Y.book_address}}).then((function(e){200===e.status?(Fe(e.data.reviews),Ze(e.data.rating),Ge(e.data.total)):a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})))}),[Y,a]),kt=(0,y.useCallback)((function(){(0,S.fb)(Y)&&(0,S.fb)(h)&&(A(!0),p()({url:"".concat(z._,"/api/book/reviewed"),method:"GET",params:{bookAddress:Y.book_address,ownerAddress:h}}).then((function(e){200===e.status&&(0,S.UE)(e.data)&&Pe(e.data)})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})))}),[Y,h,a]),vt=(0,y.useCallback)((function(){(0,S.fb)(Y)&&(A(!0),p()({url:"".concat(z._,"/api/book/quotes"),method:"GET",params:{bookAddress:Y.book_address}}).then((function(e){200===e.status?at(e.data):a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})))}),[Y,a]),yt=(0,y.useCallback)((function(){(0,S.fb)(Y)&&(0,S.fb)(h)&&(A(!0),p()({url:"".concat(z._,"/api/book/quoted"),method:"GET",params:{bookAddress:Y.book_address,ownerAddress:h}}).then((function(e){200===e.status&&(0,S.UE)(e.data)&&Xe(e.data)})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})))}),[Y,h,a]);(0,y.useEffect)((function(){bt()}),[bt]),(0,y.useEffect)((function(){kt()}),[kt]),(0,y.useEffect)((function(){vt()}),[vt]),(0,y.useEffect)((function(){yt()}),[yt]),(0,y.useEffect)((function(){(0,S.fb)(Y)&&(A(!0),p()({url:"".concat(z._,"/api/book/likes"),method:"GET",params:{bookAddress:Y.book_address}}).then((function(e){200===e.status?ve(e.data.likes):a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})))}),[Y,a]),(0,y.useEffect)((function(){(0,S.fb)(Y)&&(0,S.fb)(h)&&(A(!0),p()({url:"".concat(z._,"/api/book/liked"),method:"GET",params:{bookAddress:Y.book_address,ownerAddress:h}}).then((function(e){200===e.status&&xe(e.data.liked)})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})))}),[Y,h,a]),(0,y.useEffect)((function(){(0,S.fb)(Y)&&(A(!0),p()({url:"".concat(z._,"/api/reader/count"),method:"GET",params:{bookAddress:Y.book_address}}).then((function(e){200===e.status&&dt(e.data.reader_count)})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})))}),[Y,a]),(0,y.useEffect)((function(){(0,S.fb)(Y)&&(A(!0),p()({url:"".concat(z._,"/api/reader/total-read-time"),method:"GET",params:{bookAddress:Y.book_address}}).then((function(e){200===e.status&&pt(e.data.total_read_time)})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})))}),[Y,a]),(0,y.useEffect)((function(){A(!0),(0,S.fb)(i.wallet.provider)&&m(i.wallet.address),A(!1)}),[i]),(0,y.useEffect)((function(){(0,S.fb)(Te)&&De({title:Te.title,body:Te.body,rating:Te.rating})}),[Te]),(0,y.useEffect)((function(){if(q(r.state),(0,S.fb)(h)){A(!0);var e=r.state;e.new_owner===h?te(!0):te(!1),e.publisher_address===h?pe(!0):pe(!1),p()({url:z._+"/api/book/owner",method:"GET",params:{ownerAddress:h,bookAddress:e.book_address}}).then((function(e){200===e.status&&te(!0)})).catch((function(e){})).finally((function(){return A(!1)}))}}),[r,a,h]),(0,y.useEffect)((function(){(0,S.fb)(Y)&&(0,S.fb)(he)&&(0,S.fb)(ee)&&A(!1)}),[Y,he,ee]),(0,y.useEffect)((function(){a(E?(0,I.yh)():(0,I.v3)())}),[E,a]),(0,y.useEffect)((function(){var e=document.getElementById("BOOK_PAGE_"+F);(0,S.fb)(e)&&(0,S.fb)(mt.current)&&mt.current.style.setProperty("--marker-x",e.offsetLeft)}),[F]),(0,y.useEffect)((function(){ee&&p()({url:"".concat(z._,"/api/user/book"),method:"GET",headers:{"user-id":s.user.uid,address:i.wallet.address,authorization:"Bearer ".concat(s.tokens.acsTkn.tkn)},params:{walletAddress:i.wallet.address,bookAddress:Y.book_address}}).then((function(e){200===e.status?(le(e.data),oe(e.data.listed)):a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))}))}),[ee,s,i,a,Y]);var gt=function(){if((0,S.fb)(i.support)&&!0===i.support&&(0,S.fb)(i.wallet.provider))return m(i.wallet.address),!0;A(!0),Q.Z.connectWallet().then((function(e){return a((0,K.kH)({wallet:e.wallet,provider:e.provider,signer:e.signer,address:e.address})),m(e.address),a((0,B.e1)({show:!0,message:"Wallet connected.",type:1})),!0})).catch((function(e){return a((0,B.e1)({show:!0,message:"Error while connecting to wallet",type:4})),!1})).finally((function(){return A(!1)}))},jt=function(){var e=(0,l.Z)(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,R.Z)("event_book_read"),A(!0);try{p()({url:"".concat(z._,"/api/verify"),method:"GET",params:{bookAddress:Y.book_address,ownerAddress:h}}).then((function(e){if(200===e.status){var t=e.data;Q.Z.signMessage(i.wallet.signer,JSON.stringify(t)).then((function(e){!0===e.isValid?p()({url:z._+"/api/verify",method:"POST",headers:{address:i.wallet.address,"user-id":s.user.uid,authorization:"Bearer ".concat(s.tokens.acsTkn.tkn)},data:{accountAddress:h,bookAddress:Y.book_address,signedData:e.signedData,cid:Y.book.slice(Y.book.lastIndexOf("/")+1)}}).then((function(e){200===e.status?((0,R.Z)("navigate_book_reader"),n("/library/reader",{state:{book:(0,c.Z)((0,c.Z)({},Y),{},{url:e.data.url}),preview:!1}})):a((0,B.e1)({show:!0,message:"Error",type:4}))})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})):a((0,B.e1)({show:!0,message:"Could not verify the authenticity of the signature.",type:3}))}))}else a((0,B.e1)("NOT200"))}))}catch(t){A(!1)}case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,L.jsxs)(g.Z,{children:[(0,L.jsx)("div",{className:"book__bg",children:(0,L.jsx)("img",{src:$,alt:"background",loading:"lazy"})}),(0,S.fb)(Y)?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)("div",{className:"book__data",children:[(0,L.jsx)("div",{className:"book__data__background"}),(0,L.jsxs)("div",{className:"book__data__container",children:[(0,L.jsxs)("div",{children:[(0,L.jsx)("div",{className:"book__data__container__cover",children:(0,L.jsx)("img",{className:"book__data__container__cover__image",src:Y.cover_display_url?Y.cover_display_url:Y.cover_public_url?Y.cover_public_url:Y.cover,alt:Y.name})}),(0,L.jsxs)("div",{className:"book__data__container__meta",children:[(0,L.jsx)("h3",{className:"typo__color--n700 typo__head typo__head--3 typo__transform--capital",children:Y.title}),(0,L.jsx)("h5",{className:"typo__color--n500 typo__head typo__head--6 typo__transform--upper",children:Y.author}),ee||he?null:(0,L.jsx)("div",{className:"book__data__container__meta__price typo-head--6 typo__act typo__color--success",children:0===Y.price?"FREE":(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",Y.price]})}),(0,L.jsxs)("div",{className:"book__data__container__meta__rating",children:[(0,L.jsx)("div",{className:"book__data__container__meta__rating__stars",children:(0,L.jsx)(w.Z,{size:"small",rating:Ee})}),(0,L.jsxs)("div",{className:"book__data__container__meta__rating__count typo__body",children:[He," reviews"]})]}),(0,L.jsx)("div",{className:"book__data__container__meta__cta",children:ne?(0,L.jsx)(x.Z,{type:"primary",size:"lg",onClick:function(){return(0,R.Z)("event_book_unlist"),void((0,S.fb)(h)&&(A(!0),p()({url:z._+"/api/user/book/listed",method:"GET",headers:{"user-id":s.user.uid,authorization:"Bearer ".concat(s.tokens.acsTkn.tkn)},params:{ownerAddress:h,tokenId:ce.token_id,bookAddress:Y.book_address}}).then((function(e){if(200===e.status){A(!0);var t=e.data.order_id;j.Z.unlistBookFromMarketplace(t,i.wallet.signer).then((function(e){A(!0),p()({url:z._+"/api/book/unlist",method:"POST",data:{ownerAddress:h,bookAddress:Y.book_address}}).then((function(e){200===e.status?(oe(!1),a((0,Z.VG)()),a((0,B.e1)({show:!0,message:"Book unlisted from marketplace.",type:1}))):a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){A(!1)}))})).catch((function(e){A(!1),(0,S.fb)(e.reason)?e.reason.includes("NFT not yet listed / already sold")&&a((0,B.e1)({show:!0,message:"eBook already sold or not listed.",type:3})):a((0,B.e1)("ERROR"))}))}else a((0,B.e1)("NOT200"))})).catch((function(e){A(!1),a((0,B.e1)("ERROR"))}))))},children:"Unlist"}):he?(0,L.jsx)(L.Fragment,{children:(0,L.jsx)(x.Z,{type:"primary",size:"lg",onClick:function(){return jt()},children:"Read"})}):ee?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(x.Z,{type:"primary",size:"lg",onClick:function(){return jt()},children:"Read"}),(0,L.jsx)(x.Z,{onClick:function(){return a((0,Z.K4)(Z.gG)),void(b()(Y.secondary_sales_from).isSame(b()())||b()(Y.secondary_sales_from).isBefore(b()())?a((0,Z.K4)(Z.gG)):b()(Y.secondary_sales_from).isAfter(b()())&&a((0,B.e1)({show:!0,message:"Secondary Sales will open only after ".concat(b()(Y.secondary_sales_from).format("D MMM, YYYY"),"."),type:2})))},children:"List"})]}):(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(x.Z,{type:"primary",size:"lg",onClick:function(){return a(o?(0,Z.K4)(Z.m0):(0,B.e1)("NOT_LOGGED_IN"))},children:"Buy Now"}),(0,L.jsx)(x.Z,{onClick:function(){return(0,R.Z)("navigate_book_preview"),void n("/book/preview",{state:{book:Y,preview:!0}})},children:"Preview"})]})})]})]}),(0,L.jsxs)("div",{className:"book__data__container__desc",children:[(0,L.jsx)("div",{className:"book__data__container__desc__left",children:(0,L.jsxs)("div",{className:"book__data__container__desc__summary",children:[(0,L.jsxs)("div",{className:"book__data__container__desc__summary__contract",children:[(0,L.jsxs)("div",{className:"book__data__container__desc__summary__contract__data",children:[(0,L.jsx)("div",{className:"book__data__container__desc__summary__contract__label typo__color--n700",children:"Contract Address"}),(0,L.jsxs)("div",{className:"book__data__container__desc__summary__contract__value typo__color--n500",onClick:function(){return window.open("https://mumbai.polygonscan.com/address/".concat(Y.book_address),"_blank")},children:[(Y.book_address||"").slice(0,12),"\u2026",(Y.book_address||"").slice((Y.contract||"").length-10)]})]}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__contract__icon",children:(0,L.jsx)($e,{width:24,height:24})})]}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Genres"}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__chips typo__transform--capital",children:JSON.parse(Y.genres).map((function(e){return(0,L.jsx)("div",{className:"book__data__container__desc__summary__chips__item",children:e})}))}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Prefered Age Group"}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__chips typo__transform--capital",children:JSON.parse(Y.age_group).map((function(e){return(0,L.jsx)("div",{className:"book__data__container__desc__summary__chips__item",children:e})}))}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Language"}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__data",children:Y.language}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Price"}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__data utils__d__flex utils__align__center",children:0===Y.price?"FREE":(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",Y.price]})}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Published On"}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__data",children:b()(Y.publication_date).add(6,"h").format("D MMM, YYYY")}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Live Readers"}),(0,L.jsxs)("div",{className:"book__data__container__desc__summary__data",children:[lt," people reading"]}),(0,L.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Total Read Time"}),(0,L.jsxs)("div",{className:"book__data__container__desc__summary__data",children:[Math.ceil(ht/60)," minutes"]})]})}),(0,L.jsxs)("div",{className:"book__data__container__desc__right",children:[(0,L.jsxs)("div",{className:"book__data__container__desc__interacts",children:[(0,L.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,L.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Likes"}),(0,L.jsx)(ie,{width:24,height:24,className:"book__data__container__desc__interacts__item__icon",stroke:je?"#ff5722":"currentColor",fill:je?"#ff5722":"transparent",onClick:function(){gt()?ee?(je?(ve((function(e){return e-1})),(0,R.Z)("event_book_unlike")):(ve((function(e){return e+1})),(0,R.Z)("event_book_like")),p()({url:"".concat(z._,"/api/book/likes"),method:"POST",data:{bookAddress:Y.book_address,ownerAddress:h,likedState:!je}}).then((function(e){200===e.status?xe((function(e){return!e})):a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)}))):a((0,B.e1)({show:!0,message:"Only owners can like a book.",type:3})):a((0,B.e1)({show:!0,message:"Please login first.",type:3}))}}),(0,L.jsx)("div",{className:"typo__head--5 typo__color--n600",children:ke||"0"})]}),(0,L.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,L.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Reviews"}),(0,L.jsx)(ze,{width:24,height:24,stroke:"currentColor"}),(0,L.jsx)("div",{className:"typo__head--5 typo__color--n600",children:He||"0"})]}),(0,L.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,L.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Pages"}),(0,L.jsx)(fe,{width:24,height:24,stroke:"currentColor"}),(0,L.jsx)("div",{className:"typo__head--5 typo__color--n600",children:Y.print||"00"})]}),(0,L.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,L.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Sold"}),(0,L.jsx)(Le,{width:24,height:24,stroke:"currentColor"}),(0,L.jsx)("div",{className:"typo__head--5 typo__color--n600",children:Y.copies||"00"})]})]}),(0,L.jsxs)("div",{className:"book__data__container__desc__tabs",children:[(0,L.jsx)("div",{ref:mt,className:"book__data__container__desc__tabs__container",children:function(){var e=[];return t.forEach((function(t){e.push((0,L.jsxs)("div",{onClick:function(){return H(t.id)},id:"BOOK_PAGE_"+t.id,className:t.id===F?"book__data__container__desc__tabs__container__item book__data__container__desc__tabs__container__item--active":"book__data__container__desc__tabs__container__item utils__cursor--pointer",children:[(0,S.fb)(t.icon)&&t.icon,(0,L.jsx)("h5",{className:"typo__head typo__head--6 typo__transform--capital",children:t.label})]},t.id))})),e}()}),(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data",children:function(){switch(F){case"TAB01":return(0,L.jsx)("p",{className:"typo--break-spaces typo__body typo__color--n600",children:Y.synopsis});case"TAB02":return(0,L.jsxs)(y.Fragment,{children:[!(0,S.fb)(Te)&&ee?(0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__action",children:[(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__action__icon",children:(0,L.jsx)(ze,{width:32,height:32,stroke:"currentColor"})}),(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__action__label typo__head--6",children:"Write a Review"}),(0,L.jsx)(x.Z,{type:"primary",onClick:function(){return a(o?(0,Z.K4)(Z.wW):(0,B.e1)("NOT_LOGGED_IN"))},children:"Review"})]}):null,(0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__reviews",children:[function(e){var t=[];return(0,S.vd)(e)&&e.forEach((function(e){return t.push((0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__reviews__item",children:[(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__reviews__item__header__head typo__head typo__head--6",children:e.title}),(0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__reviews__item__header",children:[(0,L.jsx)(w.Z,{rating:e.rating,size:"small"}),(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__reviews__item__header__time typo__color--n500",children:b()(e.reviewed_at).format("D MMM, YYYY")})]}),(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__reviews__item__body typo__body typo__body--2",children:e.body})]}))})),t}(Me),0===(null===Me||void 0===Me?void 0:Me.length)?(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__empty",children:"No Reviews"}):""]})]});case"TAB03":return(0,L.jsxs)(y.Fragment,{children:[(0,S.fb)(Je)||!he&&!ee?null:(0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__action",children:[(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__action__icon",children:(0,L.jsx)(Ue.r,{width:32,height:32,stroke:"currentColor"})}),(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__action__label typo__head--6",children:"Write a Quote"}),(0,L.jsx)(x.Z,{type:"primary",onClick:function(){return a(o?(0,Z.K4)(Z.D4):(0,B.e1)("NOT_LOGGED_IN"))},children:"Quote"})]}),(0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__quotes",children:[function(e){var t=[];return e.forEach((function(e,r){t.push((0,L.jsxs)("div",{className:"book__data__container__desc__tabs__data__quotes__item",children:[(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__quotes__item__icon",children:(0,L.jsx)(we,{width:32,height:32,fill:"currentColor"})}),(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__quotes__item__body typo__body",children:e.body}),(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__quotes__item__time typo__cap typo__cap--2",children:b()(e.created_at).format("D MMM, YYYY")||"-"})]},r))})),t}(rt),0===(null===rt||void 0===rt?void 0:rt.length)?(0,L.jsx)("div",{className:"book__data__container__desc__tabs__data__empty",children:"No Quotes"}):""]})]})}}()})]})]})]})]})]}),(0,L.jsx)(U,{data:Y,onNewBookPurchase:function(){return function(){var e=function(){j.Z.purchaseNft(h,Y.book_address,Y.price.toString(),i.wallet.signer).then((function(e){a((0,B.e1)({show:!0,message:"Book purchased.",type:1})),a((0,Z.VG)());var t=Number(e.events.filter((function(e){return"Transfer(address,address,uint256)"===e.eventSignature}))[0].args[2]._hex);p()({url:z._+"/api/book/purchase",method:"POST",data:{ownerAddress:h,bookAddress:Y.book_address,tokenId:t,purchasePrice:Y.price}}).then((function(e){200===e.status?te(!0):a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})),p()({url:z._+"/api/book/copies",method:"POST",data:{bookAddress:Y.book_address,copies:t}}).then((function(e){200!==e.status&&a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))}))})).catch((function(e){var t,r;A(!1),e.message?(null===e||void 0===e||null===(t=e.message)||void 0===t?void 0:t.indexOf("execution reverted: ERC20: transfer amount exceeds balance"))>-1?a((0,B.e1)({show:!0,message:"You do not have enough USDC to purchase this book. Please visit the faucet to get some.",type:3})):(null===e||void 0===e||null===(r=e.message)||void 0===r?void 0:r.indexOf("execution reverted: NalndaBook: Book unapproved from marketplace!"))>-1?a((0,B.e1)({show:!0,message:"The book has not been approved for sales yet. Please try again later.",type:3})):4001===e.code&&a((0,B.e1)({show:!0,message:"Transaction denied by user.",type:3})):a((0,B.e1)("ERROR"))}))};(0,R.Z)("event_book_purchase_new"),A(!0),(0,S.fb)(i.wallet.signer)&&(0,S.fb)(h)?e():(A(!0),Q.Z.connectWallet().then((function(t){A(!1),a((0,K.kH)({wallet:t.wallet,provider:t.provider,signer:t.signer,address:t.address})),m(t.address),e()})).catch((function(e){a((0,B.e1)({show:!0,message:"Error while connecting wallet.",type:4})),A(!1)})))}()},onOldBookPurchase:function(e){return function(e){(0,R.Z)("event_book_purchase_old"),gt()&&(A(!0),j.Z.buyListedCover(e.order_id,e.price,i.wallet.signer).then((function(t){p()({url:z._+"/api/book/purchase/secondary",method:"POST",data:{newOwnerAddress:h,previousOwnerAddress:e.previous_owner,bookAddress:e.book_address,tokenId:e.token_id,purchasePrice:e.price,orderId:e.order_id,daScore:e.da_score}}).then((function(e){200===e.status?(a((0,Z.VG)()),te(!0)):a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)}))})).catch((function(e){A(!1)})))}(e)}}),(0,L.jsx)(T,{book:Y,userCopy:ce,onListHandler:function(e){return function(e){(0,R.Z)("event_book_list"),(0,S.fb)(h)&&(A(!0),j.Z.listBookToMarketplace(Y.book_address,ce.token_id,e,i.wallet.signer).then((function(t){A(!0);var r=parseInt(t.events.filter((function(e){return"CoverListed"===e.event}))[0].args[0]._hex);p()({url:z._+"/api/book/list",method:"POST",data:{ownerAddress:h,bookAddress:Y.book_address,bookPrice:e,bookOrderId:r,bookTokenId:ce.token_id}}).then((function(e){200===e.status?(oe(!0),a((0,Z.VG)()),a((0,B.e1)({show:!0,message:"Book listed on marketplace.",type:1}))):a((0,B.e1)("NOT200"))})).catch((function(e){a((0,B.e1)("ERROR"))})).finally((function(){A(!1)}))})).catch((function(e){(0,S.fb)(e.reason)?e.reason.includes("Can't list the cover at this time")?a((0,B.e1)({show:!0,message:"Please wait for some more time before listing the book.",type:3})):e.reason.includes("Listing for this book is disabled")?a((0,B.e1)({show:!0,message:"Listing this book is not allowed right now. Please try again later.",type:3})):e.reason.includes("Seller should own the NFT to list")&&a((0,B.e1)({show:!0,message:"Book is already listed. Please contact us on support@nalnda.com",type:3})):a((0,B.e1)("ERROR"))})).finally((function(){return A(!1)})))}(e)}}),(0,L.jsx)(W,{ReviewForm:qe,setReviewForm:De,reviewHandler:function(){(0,R.Z)("event_book_review"),(0,S.fb)(h)?(0,S.UE)(qe.body)&&(0,S.UE)(qe.rating)&&(0,S.UE)(qe.title)?(A(!0),p()({url:"".concat(z._,"/api/book/reviews"),method:"POST",data:{review:(0,c.Z)({},qe),bookAddress:Y.book_address,ownerAddress:h}}).then((function(e){200===e.status?(a((0,Z.VG)()),kt(),bt()):a((0,B.e1)("NOT200"))})).catch((function(e){A(!1),a((0,B.e1)("ERROR"))}))):a((0,B.e1)({show:!0,message:"Please fill the review.",type:3})):a((0,B.e1)({show:!0,message:"Please login first",type:3}))}}),(0,L.jsx)(P,{QuotesForm:st,setQuotesForm:it,quoteHandler:function(){(0,R.Z)("event_book_quote"),(0,S.fb)(h)?(0,S.UE)(st.quote)?(A(!0),p()({url:"".concat(z._,"/api/book/quotes"),method:"POST",data:{quote:{body:st.quote},bookAddress:Y.book_address,ownerAddress:h}}).then((function(e){200===e.status?(a((0,Z.VG)()),yt(),vt()):a((0,B.e1)("NOT200"))})).catch((function(e){A(!1),a((0,B.e1)("ERROR"))}))):a((0,B.e1)({show:!0,message:"Please enter the quote.",type:3})):a((0,B.e1)({show:!0,message:"Please login first",type:3}))}})]}):null]})})}}]);
//# sourceMappingURL=507.52b94eb5.chunk.js.map