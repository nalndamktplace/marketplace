"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[501],{50906:(e,t,a)=>{a.d(t,{r:()=>c});var s,r,o=a(72791);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},l.apply(this,arguments)}function n(e,t){let{title:a,titleId:n,...c}=e;return o.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":n},c),a?o.createElement("title",{id:n},a):null,s||(s=o.createElement("rect",{width:32,height:12,rx:2,transform:"translate(8 8)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),r||(r=o.createElement("rect",{width:32,height:12,rx:2,transform:"translate(8 28)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}const c=o.forwardRef(n);a.p},6501:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var s=a(74569),r=a.n(s),o=a(16871),l=a(72791),n=a(16030),c=a(44643),i=a(29316),d=a(4127),_=a(65248),u=a(50639),h=a(88952),p=a(43935),f=a(75454),k=a(56759),b=a(40354),m=a(72808),x=a(15602),y=a(50906),g=a(95899),v=a(54270),j=a(80184);const w=()=>{const e=[{key:"price",value:null,type:"range"},{key:"genres",value:[],type:"multiselect"},{key:"age_group",value:[],type:"multiselect"},{key:"orderby",value:null,type:"select"}],t=(0,o.TH)(),a=(0,o.s0)(),s=(0,n.I0)(),w=(0,n.v9)((e=>e.BWalletState)),[E,N]=(0,l.useState)(null),[R,O]=(0,l.useState)([]),[S,T]=(0,l.useState)(null),[I,L]=(0,l.useState)(e),[C,Z]=(0,l.useState)(!1),[A,P]=(0,l.useState)(!1),[G,H]=(0,l.useState)(window.innerWidth<600?"LIST":"GRID"),[W,B]=(0,l.useState)([]),[F,D]=(0,l.useState)(100);return(0,l.useEffect)((()=>{N(t.state)}),[t]),(0,l.useEffect)((()=>{s(C?(0,d.yh)():(0,d.v3)())}),[C,s]),(0,l.useEffect)((()=>{(0,i.fb)(E)&&(Z(!0),r()({url:_._+"/api/collections/books?cid="+E.id,method:"GET"}).then((e=>{200===e.status?B(e.data):s((0,c.e1)("NOT200"))})).catch((e=>{s((0,c.e1)("ERROR"))})).finally((()=>Z(!1))))}),[s,E]),(0,l.useEffect)((()=>{Z(!0),(0,i.fb)(w.smartAccount)&&T(w.smartAccount.address),Z(!1)}),[w]),(0,l.useEffect)((()=>{let e=W;(0,i.fb)(e)&&(I.forEach((t=>{switch(t.type){case"range":(0,i.fb)(t.value)&&(e=e.filter((e=>e[t.key]<=t.value)));break;case"multiselect":if((0,i.vd)(t.value)){let a=[];t.value.forEach((s=>e.forEach((e=>{e[t.key].indexOf(s)>-1&&a.filter((t=>t.id===e.id)).length<1&&a.push(e)})))),e=a}break;case"select":if("orderby"===t.key)switch(t.value){case"PRICE_L_H":e.sort(((e,t)=>e.price<t.price));break;case"PRICE_H_L":e.sort(((e,t)=>e.price>t.price));break;case"RATING_L_H":e.sort(((e,t)=>e.rating<t.rating));break;case"RATING_H_L":e.sort(((e,t)=>e.rating>t.rating))}}})),O(e))}),[I,W]),(0,l.useEffect)((()=>{if(!(0,i.vd)(W))return;let e=Math.max(...W.map((e=>e.price)));e=10*Math.ceil(e/10),D(e||100)}),[W]),(0,l.useEffect)((()=>{(0,g.Z)("page_view_collection")}),[]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(v.q,{children:(0,j.jsx)("meta",{name:"Collection",content:"View your books collection"})}),(0,j.jsx)(h.Z,{noFooter:!0,showRibbion:!1,noPadding:!0,fluid:!0,containerClass:"explore",children:(0,j.jsxs)("div",{className:"explore__data",children:[(0,j.jsx)("div",{className:"explore__data__filter-panel-container","data-filter-open":A,children:(0,j.jsx)(b.Z,{maxPrice:F,setFiltersPanelOpen:P,config:u.j,defaults:e,filters:I,setFilters:L})}),(0,j.jsxs)("div",{className:"explore__data__books","data-filter-open":A,children:[(0,j.jsxs)("div",{className:"explore__data__books__header",children:[(0,j.jsxs)("div",{className:"explore__data__books__header__filter",children:[(0,j.jsx)(f.Z,{type:"icon",onClick:()=>P((e=>!e)),children:(0,j.jsx)(m.r,{fill:A?"currentColor":"transparent"})}),(0,j.jsxs)("div",{className:"typo__color--n500",children:["Found ",(0,j.jsx)("span",{className:"typo__color--n700",style:{fontWeight:"500"},children:R.length})," results"]})]}),(0,j.jsxs)("div",{className:"explore__data__books__header__layout",children:[(0,j.jsxs)(f.Z,{className:"account__data__books__header__layout__button",onClick:()=>H("LIST"),children:[(0,j.jsx)(y.r,{}),(0,j.jsx)("span",{children:"List"})]}),(0,j.jsxs)(f.Z,{className:"account__data__books__header__layout__button",onClick:()=>H("GRID"),children:[(0,j.jsx)(x.r,{}),(0,j.jsx)("span",{children:"GRID"})]})]})]}),(0,j.jsx)("div",{className:"explore__data__books__wrapper","data-layout":G,children:(0,i.fb)(R)&&R.length>0?(()=>{let e=[];return R.forEach((t=>{e.push((0,j.jsx)(k.Z,{layout:G,book:t,onBuy:()=>(e=>{(0,g.Z)("event_collection_purchase_new"),Z(!0),p.Z.purchaseNft(S,e.book_address,e.price.toString(),w.smartAccount.signer).then((t=>{s((0,c.e1)({show:!0,message:"Book purchased.",type:1}));const a=Number(t.events.filter((e=>"Transfer(address,address,uint256)"===e.eventSignature))[0].args[2]._hex);r()({url:_._+"/api/book/purchase",method:"POST",data:{ownerAddress:S,bookAddress:e.book_address,tokenId:a}}).then((e=>{200!==e.status&&s((0,c.e1)("NOT200"))})).catch((e=>{s((0,c.e1)("ERROR"))})).finally((()=>Z(!1))),r()({url:_._+"/api/book/copies",method:"POST",data:{bookAddress:e.book_address,copies:a}}).then((e=>{200!==e.status&&s((0,c.e1)("NOT200"))})).catch((e=>{s((0,c.e1)("ERROR"))}))})).catch((e=>{Z(!1),4001===e.code?s((0,c.e1)({show:!0,message:"Transaction denied by user.",type:3})):s((0,c.e1)("ERROR"))}))})(t),onOpen:()=>(e=>{(0,g.Z)("navigate_collection_book"),a(`/book/${e.id}`)})(t)},t.id))})),e})():(0,j.jsxs)("div",{className:"explore__data__books__wrapper__empty",children:[(0,j.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/fb06196e-29ca-4c59-9460-6fdbd43fa700/square240",alt:"books shelf",className:"explore__data__books__wrapper__image",loading:"lazy"}),(0,j.jsx)("h4",{className:"typo__head typo__head--4",children:"No eBooks yet"})]})})]})]})})]})}}}]);
//# sourceMappingURL=501.73ede5ca.chunk.js.map