"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[994],{3994:function(e,a,t){t.r(a),t.d(a,{default:function(){return Q}});var _=t(1413),s=t(5861),o=t(885),n=t(7757),r=t.n(n),i=t(4569),c=t.n(i),d=t(2426),l=t.n(d),u=t(6030),h=t(6871),m=t(2791),f=t(1634),b=t(733),p=t(4254),k=t(5454),y=t(709),v=t(5807),x=t(6472),j=t(7107),w=t(9018),g=t(5899),N=t(9316),E=t(7928),R=t(9135),Z=t(5843),O=t(184),T=function(e){var a=e.onOldBookPurchase,t=e.data,_=(0,u.v9)((function(e){return e.ModalState})),s=(0,m.useState)(!1),n=(0,o.Z)(s,2),r=n[0],i=n[1],c=(0,m.useState)([]),d=(0,o.Z)(c,2),l=d[0],h=d[1];return(0,m.useEffect)((function(){window.document.documentElement.style.overflowY=r?"hidden":"auto"}),[r]),(0,m.useEffect)((function(){!0===_.show&&_.type===E.m0?((0,g.Z)("modal_view_purchase"),i(!0)):i(!1)}),[_]),(0,m.useEffect)((function(){if(!0===r&&(0,N.fb)(t)){var e=[];e.push(t),h(e)}}),[r,t]),(0,O.jsx)(w.Z,{show:r,children:(0,O.jsxs)("div",{className:function(){var e=["purchase purchase__wrapper"];return r?e.push("purchase__wrapper--open"):e.push("purchase__wrapper--close"),e.join(" ")}(),children:[(0,O.jsx)("div",{className:"purchase__wrapper__header",children:(0,O.jsx)("div",{className:"purchase__wrapper__header__close-button",children:(0,O.jsx)("div",{onClick:function(){return i(!1)},children:(0,O.jsx)(R.r,{width:20,height:20})})})}),(0,O.jsx)("div",{className:"purchase__wrapper__content",children:(0,O.jsx)("div",{className:"purchase__wrapper__content__options",children:(0,N.vd)(l)?(0,O.jsxs)("div",{className:"purchase__wrapper__content__options__item",onClick:function(){a(t)},children:[(0,O.jsx)("p",{className:"typo__body utils__d__flex typo__align--center",children:"Buy Copy at"}),(0,O.jsx)("h5",{className:"typo__head typo__head--4 typo__transform--upper utils__d__flex utils__align__center",children:0===t.price?"FREE":(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:32,height:32,objectFit:"contain"},alt:"USDC"}),"\xa0",t.price]})})]}):(0,O.jsxs)("div",{className:"purchase__wrapper__content__options__item",children:[(0,O.jsx)("p",{className:"typo__body utils__d__flex typo__align--center",children:"No old copies available yet."}),(0,O.jsxs)("h5",{className:"typo__head typo__head--4 typo__transform--upper utils__d__flex utils__align__center",children:["\xa0",(0,O.jsx)(Z.r,{height:32,width:32})]})]})})})]})})},A=t(2043),S=t(5248),C=t(6026),G=t(4643),B=t(4127),P=t(7793),F=t(5897),q=t(3358),D=t(8465),I=t(3653),M=t(116),Y=t(6744),L=t(7445),U=t(4998),z=t(8079),K=t(1692),W=t(7215),H=t(5748),V=t(476),Q=function(e){var a=[{id:"TAB01",label:"Synopsis",icon:(0,O.jsx)(Y.r,{})},{id:"TAB02",label:"reviews",icon:(0,O.jsx)(L.r,{})},{id:"TAB03",label:"quotes",icon:(0,O.jsx)(U.r,{})}],t=(0,h.UO)(),n=(0,u.I0)(),i=(0,h.s0)(),d=(0,P.Z)(),w=(0,u.v9)((function(e){return e.UserState})),R=(0,u.v9)((function(e){return e.WalletState})),Z=(0,m.useState)(null),Q=(0,o.Z)(Z,2),J=Q[0],X=Q[1],$=(0,m.useState)(!1),ee=(0,o.Z)($,2),ae=ee[0],te=ee[1],_e=(0,m.useState)("TAB01"),se=(0,o.Z)(_e,2),oe=se[0],ne=se[1],re=(0,m.useState)(null),ie=(0,o.Z)(re,2),ce=ie[0],de=ie[1],le=(0,m.useState)(null),ue=(0,o.Z)(le,2),he=ue[0],me=ue[1],fe=(0,m.useState)(null),be=(0,o.Z)(fe,2),pe=be[0],ke=be[1],ye=(0,m.useState)(null),ve=(0,o.Z)(ye,2),xe=ve[0],je=ve[1],we=(0,m.useState)(null),ge=(0,o.Z)(we,2),Ne=ge[0],Ee=ge[1],Re=(0,m.useState)(null),Ze=(0,o.Z)(Re,2),Oe=Ze[0],Te=Ze[1],Ae=(0,m.useState)(null),Se=(0,o.Z)(Ae,2),Ce=Se[0],Ge=Se[1],Be=(0,m.useState)(0),Pe=(0,o.Z)(Be,2),Fe=Pe[0],qe=Pe[1],De=(0,m.useState)(!1),Ie=(0,o.Z)(De,2),Me=Ie[0],Ye=Ie[1],Le=(0,m.useState)(0),Ue=(0,o.Z)(Le,2),ze=Ue[0],Ke=Ue[1],We=(0,m.useState)(null),He=(0,o.Z)(We,2),Ve=He[0],Qe=He[1],Je=(0,m.useState)([]),Xe=(0,o.Z)(Je,2),$e=Xe[0],ea=Xe[1],aa=(0,m.useState)(0),ta=(0,o.Z)(aa,2),_a=ta[0],sa=ta[1],oa=(0,m.useState)({title:"",body:"",rating:0}),na=(0,o.Z)(oa,2),ra=na[0],ia=na[1],ca=(0,m.useState)(null),da=(0,o.Z)(ca,2),la=da[0],ua=da[1],ha=(0,m.useState)([]),ma=(0,o.Z)(ha,2),fa=ma[0],ba=ma[1],pa=(0,m.useState)({quote:""}),ka=(0,o.Z)(pa,2),ya=ka[0],va=ka[1],xa=(0,m.useState)(0),ja=(0,o.Z)(xa,2),wa=ja[0],ga=ja[1],Na=(0,m.useState)(0),Ea=(0,o.Z)(Na,2),Ra=Ea[0],Za=Ea[1],Oa=(0,m.useState)(0),Ta=(0,o.Z)(Oa,2),Aa=Ta[0],Sa=Ta[1],Ca=(0,m.useRef)();(0,m.useEffect)((function(){(0,g.Z)("page_view_book")}),[]),(0,m.useEffect)((function(){"TAB01"===oe?(0,g.Z)("tab_view_book_synopsis"):"TAB02"===oe?(0,g.Z)("tab_view_book_reviews"):(0,g.Z)("tab_view_book_quotes")}),[oe]),(0,m.useEffect)((function(){(0,N.fb)(ce)&&ke(1===ce.listed)}),[ce]);var Ga=(0,m.useCallback)((function(){(0,N.fb)(ce)&&(te(!0),c()({url:"".concat(S._,"/api/book/reviews"),method:"GET",params:{bookAddress:ce.book_address}}).then((function(e){200===e.status?(ea(e.data.reviews),Ke(e.data.rating),sa(e.data.total)):n((0,G.e1)("NOT200"))})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}),[ce,n]),Ba=(0,m.useCallback)((function(){(0,N.fb)(ce)&&(0,N.fb)(J)&&(te(!0),c()({url:"".concat(S._,"/api/book/reviewed"),method:"GET",params:{bookAddress:ce.book_address,ownerAddress:J}}).then((function(e){200===e.status&&(0,N.UE)(e.data)&&Qe(e.data)})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}),[ce,J,n]),Pa=(0,m.useCallback)((function(){(0,N.fb)(ce)&&(te(!0),c()({url:"".concat(S._,"/api/book/quotes"),method:"GET",params:{bookAddress:ce.book_address}}).then((function(e){200===e.status?ba(e.data):n((0,G.e1)("NOT200"))})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}),[ce,n]),Fa=(0,m.useCallback)((function(){(0,N.fb)(ce)&&(0,N.fb)(J)&&(te(!0),c()({url:"".concat(S._,"/api/book/quoted"),method:"GET",params:{bookAddress:ce.book_address,ownerAddress:J}}).then((function(e){200===e.status&&(0,N.UE)(e.data)&&ua(e.data)})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}),[ce,J,n]);(0,m.useEffect)((function(){Ga()}),[Ga]),(0,m.useEffect)((function(){Ba()}),[Ba]),(0,m.useEffect)((function(){Pa()}),[Pa]),(0,m.useEffect)((function(){Fa()}),[Fa]),(0,m.useEffect)((function(){(0,N.fb)(ce)&&(te(!0),c()({url:"".concat(S._,"/api/book/likes"),method:"GET",params:{bookAddress:ce.book_address}}).then((function(e){200===e.status?qe(e.data.likes):n((0,G.e1)("NOT200"))})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}),[ce,n]),(0,m.useEffect)((function(){(0,N.fb)(ce)&&(0,N.fb)(J)&&(te(!0),c()({url:"".concat(S._,"/api/book/liked"),method:"GET",params:{bookAddress:ce.book_address,ownerAddress:J}}).then((function(e){200===e.status&&Ye(e.data.liked)})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}),[ce,J,n]),(0,m.useEffect)((function(){(0,N.fb)(ce)&&(te(!0),c()({url:"".concat(S._,"/api/reader/total-reader-count"),method:"GET",params:{bookAddress:ce.book_address}}).then((function(e){200===e.status&&ga(e.data.total_readers)})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}),[ce,n]),(0,m.useEffect)((function(){(0,N.fb)(ce)&&(te(!0),c()({url:"".concat(S._,"/api/reader/count"),method:"GET",params:{bookAddress:ce.book_address}}).then((function(e){200===e.status&&Za(e.data.reader_count)})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}),[ce,n]),(0,m.useEffect)((function(){(0,N.fb)(ce)&&(te(!0),c()({url:"".concat(S._,"/api/reader/total-read-time"),method:"GET",params:{bookAddress:ce.book_address}}).then((function(e){200===e.status&&Sa(e.data.total_read_time)})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}),[ce,n]),(0,m.useEffect)((function(){te(!0),(0,N.fb)(R.wallet.provider)&&X(R.wallet.address),te(!1)}),[R]),(0,m.useEffect)((function(){(0,N.fb)(Ve)&&ia({title:Ve.title,body:Ve.body,rating:Ve.rating})}),[Ve]),(0,m.useEffect)((function(){var e=t.bookID;c()({url:"".concat(S._,"/api/book/listedbook"),method:"GET",params:{bookID:e}}).then((function(e){de(e.data.book),Ge(e.data.secondary_book)}))}),[t]),(0,m.useEffect)((function(){if((0,N.fb)(J)){te(!0);var e=ce;e.new_owner===J?me(!0):me(!1),e.publisher_address===J?Ee(!0):Ee(!1),c()({url:S._+"/api/book/owner",method:"GET",params:{ownerAddress:J,bookAddress:e.book_address}}).then((function(e){200===e.status&&me(!0)})).catch((function(e){})).finally((function(){return te(!1)}))}}),[ce,t,n,J]),(0,m.useEffect)((function(){(0,N.fb)(ce)&&(0,N.fb)(Ne)&&(0,N.fb)(he)&&te(!1)}),[ce,Ne,he]),(0,m.useEffect)((function(){n(ae?(0,B.yh)():(0,B.v3)())}),[ae,n]),(0,m.useEffect)((function(){var e=document.getElementById("BOOK_PAGE_"+oe);(0,N.fb)(e)&&(0,N.fb)(Ca.current)&&Ca.current.style.setProperty("--marker-x",e.offsetLeft)}),[oe]),(0,m.useEffect)((function(){he&&c()({url:"".concat(S._,"/api/user/book"),method:"GET",headers:{"user-id":w.user.uid,address:R.wallet.address,authorization:"Bearer ".concat(w.tokens.acsTkn.tkn)},params:{walletAddress:R.wallet.address,bookAddress:ce.book_address}}).then((function(e){200===e.status?(je(e.data),ke(e.data.listed)):n((0,G.e1)("NOT200"))})).catch((function(e){n((0,G.e1)("ERROR"))}))}),[he,w,R,n,ce]);var qa=function(){if((0,N.fb)(R.support)&&!0===R.support&&(0,N.fb)(R.wallet.provider))return X(R.wallet.address),!0;te(!0),A.Z.connectWallet().then((function(e){return n((0,C.kH)({wallet:e.wallet,provider:e.provider,signer:e.signer,address:e.address})),X(e.address),n((0,G.e1)({show:!0,message:"Wallet connected.",type:1})),!0})).catch((function(e){return n((0,G.e1)({show:!0,message:"Error while connecting to wallet",type:4})),!1})).finally((function(){return te(!1)}))},Da=function(){var e=(0,s.Z)(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,g.Z)("event_book_read"),te(!0);try{c()({url:"".concat(S._,"/api/verify"),method:"GET",params:{bookAddress:ce.book_address,ownerAddress:J}}).then((function(e){if(200===e.status){var a=e.data;A.Z.signMessage(R.wallet.signer,JSON.stringify(a)).then((function(e){!0===e.isValid?c()({url:S._+"/api/verify",method:"POST",headers:{address:R.wallet.address,"user-id":w.user.uid,authorization:"Bearer ".concat(w.tokens.acsTkn.tkn)},data:{accountAddress:J,bookAddress:ce.book_address,signedData:e.signedData,cid:ce.book.slice(ce.book.lastIndexOf("/")+1)}}).then((function(e){200===e.status?((0,g.Z)("navigate_book_reader"),i("/library/reader",{state:{book:(0,_.Z)((0,_.Z)({},ce),{},{url:e.data.url}),preview:!1}})):n((0,G.e1)({show:!0,message:"Error",type:4}))})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})):n((0,G.e1)({show:!0,message:"Could not verify the authenticity of the signature.",type:3}))}))}else n((0,G.e1)("NOT200"))}))}catch(a){te(!1)}case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,O.jsxs)(f.Z,{children:[(0,O.jsx)("div",{className:"book__bg",children:(0,O.jsx)("img",{src:F.Z,alt:"background",loading:"lazy"})}),(0,N.fb)(ce)?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsxs)("div",{className:"book__data",children:[(0,O.jsx)("div",{className:"book__data__background"}),(0,O.jsxs)("div",{className:"book__data__container",children:[(0,O.jsxs)("div",{children:[(0,O.jsx)("div",{className:"book__data__container__cover",children:(0,O.jsx)("img",{className:"book__data__container__cover__image",src:ce.cover_display_url?ce.cover_display_url:ce.cover_public_url?ce.cover_public_url:ce.cover,alt:ce.name})}),(0,O.jsxs)("div",{className:"book__data__container__meta",children:[(0,O.jsx)("h3",{className:"typo__color--n700 typo__head typo__head--3 typo__transform--capital",children:ce.title}),(0,O.jsx)("h5",{className:"typo__color--n500 typo__head typo__head--6 typo__transform--upper",children:ce.author}),he||Ne?null:(0,O.jsx)("div",{className:"book__data__container__meta__price typo-head--6 typo__act typo__color--success",children:0===Ce.price?"FREE":(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",Ce.price]})}),(0,O.jsxs)("div",{className:"book__data__container__meta__rating",children:[(0,O.jsx)("div",{className:"book__data__container__meta__rating__stars",children:(0,O.jsx)(p.Z,{size:"small",rating:ze})}),(0,O.jsxs)("div",{className:"book__data__container__meta__rating__count typo__body",children:[_a," reviews"]})]}),(0,O.jsx)("div",{className:"book__data__container__meta__cta",children:pe?(0,O.jsx)(k.Z,{type:"primary",size:"lg",onClick:function(){return(0,g.Z)("event_book_unlist"),void((0,N.fb)(J)&&(te(!0),c()({url:S._+"/api/user/book/listed",method:"GET",headers:{"user-id":w.user.uid,authorization:"Bearer ".concat(w.tokens.acsTkn.tkn)},params:{ownerAddress:J,tokenId:xe.token_id,bookAddress:ce.book_address}}).then((function(e){if(200===e.status){te(!0);var a=e.data.order_id;b.Z.unlistBookFromMarketplace(a,R.wallet.signer).then((function(e){te(!0),c()({url:S._+"/api/book/unlist",method:"POST",data:{ownerAddress:J,bookAddress:ce.book_address}}).then((function(e){200===e.status?(ke(!1),n((0,E.VG)()),n((0,G.e1)({show:!0,message:"Book unlisted from marketplace.",type:1})),i("/")):n((0,G.e1)("NOT200"))})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){te(!1)}))})).catch((function(e){te(!1),(0,N.fb)(e.reason)?e.reason.includes("NFT not yet listed / already sold")&&n((0,G.e1)({show:!0,message:"eBook already sold or not listed.",type:3})):n((0,G.e1)("ERROR"))}))}else n((0,G.e1)("NOT200"))})).catch((function(e){te(!1),n((0,G.e1)("ERROR"))}))))},children:"Unlist"}):Ne?(0,O.jsx)(O.Fragment,{children:(0,O.jsx)(k.Z,{type:"primary",size:"lg",onClick:function(){return Da()},children:"Read"})}):he?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(k.Z,{type:"primary",size:"lg",onClick:function(){return Da()},children:"Read"}),(0,O.jsx)(k.Z,{onClick:function(){return n((0,E.K4)(E.gG)),void(l()(ce.secondary_sales_from).isSame(l()())||l()(ce.secondary_sales_from).isBefore(l()())?n((0,E.K4)(E.gG)):l()(ce.secondary_sales_from).isAfter(l()())&&n((0,G.e1)({show:!0,message:"Secondary Sales will open only after ".concat(l()(ce.secondary_sales_from).format("D MMM, YYYY"),"."),type:2})))},children:"List"})]}):(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(k.Z,{type:"primary",size:"lg",onClick:function(){return n(d?(0,E.K4)(E.m0):(0,G.e1)("NOT_LOGGED_IN"))},children:"Buy Now"}),(0,O.jsx)(k.Z,{onClick:function(){return(0,g.Z)("navigate_book_preview"),void i("/book/preview",{state:{book:ce,preview:!0}})},children:"Preview"})]})})]})]}),(0,O.jsxs)("div",{className:"book__data__container__desc",children:[(0,O.jsx)("div",{className:"book__data__container__desc__left",children:(0,O.jsxs)("div",{className:"book__data__container__desc__summary",children:[(0,O.jsxs)("div",{className:"book__data__container__desc__summary__contract",children:[(0,O.jsxs)("div",{className:"book__data__container__desc__summary__contract__data",children:[(0,O.jsx)("div",{className:"book__data__container__desc__summary__contract__label typo__color--n700",children:"Contract Address"}),(0,O.jsxs)("div",{className:"book__data__container__desc__summary__contract__value typo__color--n500",onClick:function(){return window.open("https://mumbai.polygonscan.com/address/".concat(ce.book_address),"_blank")},children:[(ce.book_address||"").slice(0,12),"\u2026",(ce.book_address||"").slice((ce.contract||"").length-10)]})]}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__contract__icon",children:(0,O.jsx)(z.r,{width:24,height:24})})]}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"DA Score"}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__data",children:Ce.da_score}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Token ID"}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__data",children:Ce.token_id}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Genres"}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__chips typo__transform--capital",children:JSON.parse(ce.genres).map((function(e){return(0,O.jsx)("div",{className:"book__data__container__desc__summary__chips__item",children:e})}))}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Prefered Age Group"}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__chips typo__transform--capital",children:JSON.parse(ce.age_group).map((function(e){return(0,O.jsx)("div",{className:"book__data__container__desc__summary__chips__item",children:e})}))}),(0,O.jsxs)("div",{className:"book__data__container__desc__summary__grid typo__color--n700",children:[(0,O.jsxs)("div",{className:"book__data__container__desc__summary__grid__item",children:[(0,O.jsx)(K.r,{}),(0,O.jsx)("div",{className:"book__data__container__desc__summary__grid__item__data",children:ce.language})]}),(0,O.jsxs)("div",{className:"book__data__container__desc__summary__grid__item",children:[(0,O.jsx)(V.r,{}),(0,O.jsxs)("div",{className:"book__data__container__desc__summary__grid__item__data",children:[wa," readers"]})]}),(0,O.jsxs)("div",{className:"book__data__container__desc__summary__grid__item",children:[(0,O.jsx)(W.r,{}),(0,O.jsxs)("div",{className:"book__data__container__desc__summary__grid__item__data",children:[Ra," people reading"]})]}),(0,O.jsxs)("div",{className:"book__data__container__desc__summary__grid__item",children:[(0,O.jsx)(H.r,{}),(0,O.jsxs)("div",{className:"book__data__container__desc__summary__grid__item__data",children:[Math.ceil(Aa/60)," minutes"]})]})]})]})}),(0,O.jsxs)("div",{className:"book__data__container__desc__right",children:[(0,O.jsxs)("div",{className:"book__data__container__desc__interacts",children:[(0,O.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,O.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Likes"}),(0,O.jsx)(q.r,{width:24,height:24,className:"book__data__container__desc__interacts__item__icon",stroke:Me?"#ff5722":"currentColor",fill:Me?"#ff5722":"transparent",onClick:function(){qa()?he?(Me?(qe((function(e){return e-1})),(0,g.Z)("event_book_unlike")):(qe((function(e){return e+1})),(0,g.Z)("event_book_like")),c()({url:"".concat(S._,"/api/book/likes"),method:"POST",data:{bookAddress:ce.book_address,ownerAddress:J,likedState:!Me}}).then((function(e){200===e.status?Ye((function(e){return!e})):n((0,G.e1)("NOT200"))})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)}))):n((0,G.e1)({show:!0,message:"Only owners can like a book.",type:3})):n((0,G.e1)({show:!0,message:"Please login first.",type:3}))}}),(0,O.jsx)("div",{className:"typo__head--5 typo__color--n600",children:Fe||"0"})]}),(0,O.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,O.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Reviews"}),(0,O.jsx)(L.r,{width:24,height:24,stroke:"currentColor"}),(0,O.jsx)("div",{className:"typo__head--5 typo__color--n600",children:_a||"0"})]}),(0,O.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,O.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Pages"}),(0,O.jsx)(D.r,{width:24,height:24,stroke:"currentColor"}),(0,O.jsx)("div",{className:"typo__head--5 typo__color--n600",children:ce.print||"00"})]}),(0,O.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,O.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Sold"}),(0,O.jsx)(M.r,{width:24,height:24,stroke:"currentColor"}),(0,O.jsx)("div",{className:"typo__head--5 typo__color--n600",children:ce.copies||"00"})]})]}),(0,O.jsxs)("div",{className:"book__data__container__desc__tabs",children:[(0,O.jsx)("div",{ref:Ca,className:"book__data__container__desc__tabs__container",children:function(){var e=[];return a.forEach((function(a){e.push((0,O.jsxs)("div",{onClick:function(){return ne(a.id)},id:"BOOK_PAGE_"+a.id,className:a.id===oe?"book__data__container__desc__tabs__container__item book__data__container__desc__tabs__container__item--active":"book__data__container__desc__tabs__container__item utils__cursor--pointer",children:[(0,N.fb)(a.icon)&&a.icon,(0,O.jsx)("h5",{className:"typo__head typo__head--6 typo__transform--capital",children:a.label})]},a.id))})),e}()}),(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data",children:function(){switch(oe){case"TAB01":return(0,O.jsx)("p",{className:"typo--break-spaces typo__body typo__color--n600",children:ce.synopsis});case"TAB02":return(0,O.jsxs)(m.Fragment,{children:[!(0,N.fb)(Ve)&&he?(0,O.jsxs)("div",{className:"book__data__container__desc__tabs__data__action",children:[(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__action__icon",children:(0,O.jsx)(L.r,{width:32,height:32,stroke:"currentColor"})}),(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__action__label typo__head--6",children:"Write a Review"}),(0,O.jsx)(k.Z,{type:"primary",onClick:function(){return n(d?(0,E.K4)(E.wW):(0,G.e1)("NOT_LOGGED_IN"))},children:"Review"})]}):null,(0,O.jsxs)("div",{className:"book__data__container__desc__tabs__data__reviews",children:[function(e){var a=[];return(0,N.vd)(e)&&e.forEach((function(e){return a.push((0,O.jsxs)("div",{className:"book__data__container__desc__tabs__data__reviews__item",children:[(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__reviews__item__header__head typo__head typo__head--6",children:e.title}),(0,O.jsxs)("div",{className:"book__data__container__desc__tabs__data__reviews__item__header",children:[(0,O.jsx)(p.Z,{rating:e.rating,size:"small"}),(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__reviews__item__header__time typo__color--n500",children:l()(e.reviewed_at).format("D MMM, YYYY")})]}),(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__reviews__item__body typo__body typo__body--2",children:e.body})]}))})),a}($e),0===(null===$e||void 0===$e?void 0:$e.length)?(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__empty",children:"No Reviews"}):""]})]});case"TAB03":return(0,O.jsxs)(m.Fragment,{children:[(0,N.fb)(la)||!Ne&&!he?null:(0,O.jsxs)("div",{className:"book__data__container__desc__tabs__data__action",children:[(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__action__icon",children:(0,O.jsx)(U.r,{width:32,height:32,stroke:"currentColor"})}),(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__action__label typo__head--6",children:"Write a Quote"}),(0,O.jsx)(k.Z,{type:"primary",onClick:function(){return n(d?(0,E.K4)(E.D4):(0,G.e1)("NOT_LOGGED_IN"))},children:"Quote"})]}),(0,O.jsxs)("div",{className:"book__data__container__desc__tabs__data__quotes",children:[function(e){var a=[];return e.forEach((function(e,t){a.push((0,O.jsxs)("div",{className:"book__data__container__desc__tabs__data__quotes__item",children:[(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__quotes__item__icon",children:(0,O.jsx)(I.r,{width:32,height:32,fill:"currentColor"})}),(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__quotes__item__body typo__body",children:e.body}),(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__quotes__item__time typo__cap typo__cap--2",children:l()(e.created_at).format("D MMM, YYYY")||"-"})]},t))})),a}(fa),0===(null===fa||void 0===fa?void 0:fa.length)?(0,O.jsx)("div",{className:"book__data__container__desc__tabs__data__empty",children:"No Quotes"}):""]})]})}}()})]})]})]})]})]}),(0,O.jsx)(T,{data:Ce,onOldBookPurchase:function(e){return function(e){(0,g.Z)("event_book_purchase_old"),qa()&&(te(!0),b.Z.buyListedCover(e.order_id,e.price,R.wallet.signer).then((function(a){c()({url:S._+"/api/book/purchase/secondary",method:"POST",data:{newOwnerAddress:J,previousOwnerAddress:e.previous_owner,bookAddress:e.book_address,tokenId:e.token_id,purchasePrice:e.price,orderId:e.order_id,daScore:e.da_score}}).then((function(e){200===e.status?(n((0,E.VG)()),me(!0)):n((0,G.e1)("NOT200"))})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)}))})).catch((function(e){te(!1)})))}(e)}}),(0,O.jsx)(y.Z,{book:ce,userCopy:xe,onListHandler:function(e){return function(e){(0,g.Z)("event_book_list"),(0,N.fb)(J)&&(te(!0),b.Z.listBookToMarketplace(ce.book_address,xe.token_id,e,R.wallet.signer).then((function(a){te(!0);var t=parseInt(a.events.filter((function(e){return"CoverListed"===e.event}))[0].args[0]._hex);c()({url:S._+"/api/book/list",method:"POST",data:{ownerAddress:J,bookAddress:ce.book_address,bookPrice:e,bookOrderId:t,bookTokenId:xe.token_id}}).then((function(e){200===e.status?(ke(!0),n((0,E.VG)()),n((0,G.e1)({show:!0,message:"Book listed on marketplace.",type:1})),e.data&&(Te(e.data),n((0,E.K4)(E.Sh)))):n((0,G.e1)("NOT200"))})).catch((function(e){n((0,G.e1)("ERROR"))})).finally((function(){te(!1)}))})).catch((function(e){(0,N.fb)(e.reason)?e.reason.includes("Can't list the cover at this time")?n((0,G.e1)({show:!0,message:"Please wait for some more time before listing the book.",type:3})):e.reason.includes("Listing for this book is disabled")?n((0,G.e1)({show:!0,message:"Listing this book is not allowed right now. Please try again later.",type:3})):e.reason.includes("Seller should own the NFT to list")&&n((0,G.e1)({show:!0,message:"Book is already listed. Please contact us on support@nalnda.com",type:3})):n((0,G.e1)("ERROR"))})).finally((function(){return te(!1)})))}(e)}}),(0,O.jsx)(x.Z,{ReviewForm:ra,setReviewForm:ia,reviewHandler:function(){(0,g.Z)("event_book_review"),(0,N.fb)(J)?(0,N.UE)(ra.body)&&(0,N.UE)(ra.rating)&&(0,N.UE)(ra.title)?(te(!0),c()({url:"".concat(S._,"/api/book/reviews"),method:"POST",data:{review:(0,_.Z)({},ra),bookAddress:ce.book_address,ownerAddress:J}}).then((function(e){200===e.status?(n((0,E.VG)()),Ba(),Ga()):n((0,G.e1)("NOT200"))})).catch((function(e){te(!1),n((0,G.e1)("ERROR"))}))):n((0,G.e1)({show:!0,message:"Please fill the review.",type:3})):n((0,G.e1)({show:!0,message:"Please login first",type:3}))}}),(0,O.jsx)(v.Z,{QuotesForm:ya,setQuotesForm:va,quoteHandler:function(){(0,g.Z)("event_book_quote"),(0,N.fb)(J)?(0,N.UE)(ya.quote)?(te(!0),c()({url:"".concat(S._,"/api/book/quotes"),method:"POST",data:{quote:{body:ya.quote},bookAddress:ce.book_address,ownerAddress:J}}).then((function(e){200===e.status?(n((0,E.VG)()),Fa(),Pa()):n((0,G.e1)("NOT200"))})).catch((function(e){te(!1),n((0,G.e1)("ERROR"))}))):n((0,G.e1)({show:!0,message:"Please enter the quote.",type:3})):n((0,G.e1)({show:!0,message:"Please login first",type:3}))}}),(0,O.jsx)(j.Z,{bookID:Oe})]}):null]})}}}]);
//# sourceMappingURL=994.4098ceac.chunk.js.map