"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[501],{906:function(e,t,n){n.d(t,{r:function(){return u}});var r,a,o=n(2791),s=["title","titleId"];function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function l(e,t){var n=e.title,l=e.titleId,u=c(e,s);return o.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":l},u),n?o.createElement("title",{id:l},n):null,r||(r=o.createElement("rect",{width:32,height:12,rx:2,transform:"translate(8 8)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),a||(a=o.createElement("rect",{width:32,height:12,rx:2,transform:"translate(8 28)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var u=o.forwardRef(l);n.p},6501:function(e,t,n){n.r(t);var r=n(2982),a=n(885),o=n(4569),s=n.n(o),i=n(6871),c=n(2791),l=n(6030),u=n(4643),d=n(9316),f=n(4127),_=n(5248),h=n(639),p=n(1634),b=n(733),k=n(5454),y=n(6759),v=n(354),x=n(3930),m=n(5602),g=n(906),j=n(5899),w=n(184);t.default=function(){var e=[{key:"price",value:null,type:"range"},{key:"genres",value:[],type:"multiselect"},{key:"age_group",value:[],type:"multiselect"},{key:"orderby",value:null,type:"select"}],t=(0,i.TH)(),n=(0,i.s0)(),o=(0,l.I0)(),O=(0,l.v9)((function(e){return e.WalletState})),E=(0,c.useState)(null),N=(0,a.Z)(E,2),R=N[0],Z=N[1],S=(0,c.useState)([]),I=(0,a.Z)(S,2),T=I[0],L=I[1],P=(0,c.useState)(null),C=(0,a.Z)(P,2),G=C[0],H=C[1],W=(0,c.useState)(e),A=(0,a.Z)(W,2),B=A[0],F=A[1],M=(0,c.useState)(!1),D=(0,a.Z)(M,2),q=D[0],z=D[1],Y=(0,c.useState)(!1),J=(0,a.Z)(Y,2),K=J[0],Q=J[1],U=(0,c.useState)(window.innerWidth<600?"LIST":"GRID"),V=(0,a.Z)(U,2),X=V[0],$=V[1],ee=(0,c.useState)([]),te=(0,a.Z)(ee,2),ne=te[0],re=te[1],ae=(0,c.useState)(100),oe=(0,a.Z)(ae,2),se=oe[0],ie=oe[1];return(0,c.useEffect)((function(){Z(t.state)}),[t]),(0,c.useEffect)((function(){o(q?(0,f.yh)():(0,f.v3)())}),[q,o]),(0,c.useEffect)((function(){(0,d.fb)(R)&&(z(!0),s()({url:_._+"/api/collections/books?cid="+R.id,method:"GET"}).then((function(e){200===e.status?re(e.data):o((0,u.e1)("NOT200"))})).catch((function(e){o((0,u.e1)("ERROR"))})).finally((function(){return z(!1)})))}),[o,R]),(0,c.useEffect)((function(){z(!0),(0,d.fb)(O.wallet.provider)&&H(O.wallet.address),z(!1)}),[O]),(0,c.useEffect)((function(){var e=ne;(0,d.fb)(e)&&(B.forEach((function(t){switch(t.type){case"range":(0,d.fb)(t.value)&&(e=e.filter((function(e){return e[t.key]<=t.value})));break;case"multiselect":if((0,d.vd)(t.value)){var n=[];t.value.forEach((function(r){return e.forEach((function(e){e[t.key].indexOf(r)>-1&&n.filter((function(t){return t.id===e.id})).length<1&&n.push(e)}))})),e=n}break;case"select":if("orderby"===t.key)switch(t.value){case"PRICE_L_H":e.sort((function(e,t){return e.price<t.price}));break;case"PRICE_H_L":e.sort((function(e,t){return e.price>t.price}));break;case"RATING_L_H":e.sort((function(e,t){return e.rating<t.rating}));break;case"RATING_H_L":e.sort((function(e,t){return e.rating>t.rating}))}}})),L(e))}),[B,ne]),(0,c.useEffect)((function(){if((0,d.vd)(ne)){var e=Math.max.apply(Math,(0,r.Z)(ne.map((function(e){return e.price}))));e=10*Math.ceil(e/10),ie(e||100)}}),[ne]),(0,c.useEffect)((function(){(0,j.Z)("page_view_collection")}),[]),(0,w.jsx)(p.Z,{noFooter:!0,showRibbion:!1,noPadding:!0,fluid:!0,containerClass:"explore",children:(0,w.jsxs)("div",{className:"explore__data",children:[(0,w.jsx)("div",{className:"explore__data__filter-panel-container","data-filter-open":K,children:(0,w.jsx)(v.Z,{maxPrice:se,setFiltersPanelOpen:Q,config:h.j,defaults:e,filters:B,setFilters:F})}),(0,w.jsxs)("div",{className:"explore__data__books","data-filter-open":K,children:[(0,w.jsxs)("div",{className:"explore__data__books__header",children:[(0,w.jsxs)("div",{className:"explore__data__books__header__filter",children:[(0,w.jsx)(k.Z,{type:"icon",onClick:function(){return Q((function(e){return!e}))},children:(0,w.jsx)(x.r,{fill:K?"currentColor":"transparent"})}),(0,w.jsxs)("div",{className:"typo__color--n500",children:["Found ",(0,w.jsx)("span",{className:"typo__color--n700",style:{fontWeight:"500"},children:T.length})," results"]})]}),(0,w.jsxs)("div",{className:"explore__data__books__header__layout",children:[(0,w.jsxs)(k.Z,{className:"account__data__books__header__layout__button",onClick:function(){return $("LIST")},children:[(0,w.jsx)(g.r,{}),(0,w.jsx)("span",{children:"List"})]}),(0,w.jsxs)(k.Z,{className:"account__data__books__header__layout__button",onClick:function(){return $("GRID")},children:[(0,w.jsx)(m.r,{}),(0,w.jsx)("span",{children:"GRID"})]})]})]}),(0,w.jsx)("div",{className:"explore__data__books__wrapper","data-layout":X,children:(0,d.fb)(T)&&T.length>0?function(){var e=[];return T.forEach((function(t){e.push((0,w.jsx)(y.Z,{layout:X,book:t,onBuy:function(){return function(e){(0,j.Z)("event_collection_purchase_new"),z(!0),b.Z.purchaseNft(G,e.book_address,e.price.toString(),O.wallet.signer).then((function(t){o((0,u.e1)({show:!0,message:"Book purchased.",type:1}));var n=Number(t.events.filter((function(e){return"Transfer(address,address,uint256)"===e.eventSignature}))[0].args[2]._hex);s()({url:_._+"/api/book/purchase",method:"POST",data:{ownerAddress:G,bookAddress:e.book_address,tokenId:n}}).then((function(e){200!==e.status&&o((0,u.e1)("NOT200"))})).catch((function(e){o((0,u.e1)("ERROR"))})).finally((function(){return z(!1)})),s()({url:_._+"/api/book/copies",method:"POST",data:{bookAddress:e.book_address,copies:n}}).then((function(e){200!==e.status&&o((0,u.e1)("NOT200"))})).catch((function(e){o((0,u.e1)("ERROR"))}))})).catch((function(e){z(!1),4001===e.code?o((0,u.e1)({show:!0,message:"Transaction denied by user.",type:3})):o((0,u.e1)("ERROR"))}))}(t)},onOpen:function(){return function(e){(0,j.Z)("navigate_collection_book"),n("/book/".concat(e.id))}(t)}},t.id))})),e}():(0,w.jsxs)("div",{className:"explore__data__books__wrapper__empty",children:[(0,w.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/fb06196e-29ca-4c59-9460-6fdbd43fa700/square240",alt:"books shelf",className:"explore__data__books__wrapper__image",loading:"lazy"}),(0,w.jsx)("h4",{className:"typo__head typo__head--4",children:"No eBooks yet"})]})})]})]})})}}}]);
//# sourceMappingURL=501.6bf7924b.chunk.js.map