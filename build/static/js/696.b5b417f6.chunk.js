"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[696],{14998:function(e,t,n){n.d(t,{r:function(){return m}});var r,o,i,a,l,s,c=n(72791),u=["title","titleId"];function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function f(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function h(e,t){var n=e.title,h=e.titleId,m=f(e,u);return c.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":h},m),n?c.createElement("title",{id:h},n):null,r||(r=c.createElement("path",{d:"M6,15H36",transform:"translate(6 15)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),o||(o=c.createElement("path",{d:"M36,19H6",transform:"translate(6 19)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),i||(i=c.createElement("path",{d:"M15,11H27",transform:"translate(15 11)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),a||(a=c.createElement("path",{d:"M27,7H15",transform:"translate(15 7)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),l||(l=c.createElement("path",{d:"M9,12.5h2a2,2,0,1,1-2,2v-5a4,4,0,0,1,4-4",transform:"translate(9 5.5)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),s||(s=c.createElement("path",{d:"M3,12.5H5a2,2,0,1,1-2,2v-5a4,4,0,0,1,4-4",transform:"translate(3 5.5)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var m=c.forwardRef(h);n.p},67696:function(e,t,n){n.r(t),n.d(t,{default:function(){return jn}});var r=n(1413),o=n(29439),i=n(16030),a=n(16871),l=n(72791),s=n(54270),c=n(4343);var u,d,f=function(e,t){var n=(0,l.useState)(e),r=(0,o.Z)(n,2),i=r[0],a=r[1];return(0,l.useEffect)((function(){var n=setTimeout((function(){a(e)}),t);return function(){clearTimeout(n)}}),[e,t]),i},h=n(75454),m=n(74569),_=n.n(m),p=n(65248),v=n(29316),b=function(e){var t=parseInt(e,10);return[Math.floor(t/3600),Math.floor(t/60)%60,t%60].map((function(e){return e<10?"0"+e:e})).filter((function(e,t){return"00"!==e||t>0})).join(":")},k=n(44643),y=["title","titleId"];function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g.apply(this,arguments)}function j(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function w(e,t){var n=e.title,r=e.titleId,o=j(e,y);return l.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,u||(u=l.createElement("circle",{cx:18,cy:18,r:18,transform:"translate(6 6)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),d||(d=l.createElement("path",{d:"M12,7V17l6,6",transform:"translate(12 7)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var x,O,E=l.forwardRef(w),S=(n.p,n(80184)),N=function(e){var t=e.timerUpdate,n=e.mobileView,r=e.bookMeta,s=e.preview,c=(0,i.v9)((function(e){return e.UserState})),u=(0,i.v9)((function(e){return e.BWalletState})),d=(0,l.useState)(0),f=(0,o.Z)(d,2),h=f[0],m=f[1],y=(0,l.useState)(0),g=(0,o.Z)(y,2),j=g[0],w=g[1],x=(0,l.useState)(null),O=(0,o.Z)(x,2),N=O[0],L=O[1],R=(0,i.I0)(),Z=(0,a.s0)();return(0,l.useEffect)((function(){(0,v.fb)(n)&&!1!==n||(0,v.fb)(s)&&!s&&((0,v.fb)(u.smartAccount)?L(u.smartAccount.address):Z(-1))}),[n,u,Z,s]),(0,l.useEffect)((function(){!s&&(0,v.fb)(r)&&((0,v.fb)(N)||(0,v.fb)(n)&&!0===n)&&_()({url:"".concat(p._,"/api/reader/read-time"),method:"GET",headers:{address:N,"user-id":c.user.uid,authorization:"Bearer ".concat(c.tokens.acsTkn.tkn)},params:{bookAddress:r.book_address}}).then((function(e){200===e.status&&(m(e.data.read_time),w(e.data.read_time))})).catch((function(e){R((0,k.e1)("ERROR"))}))}),[n,r,R,N,s,c]),(0,l.useEffect)((function(){if((0,v.fb)(r)||(0,v.fb)(N)||(0,v.fb)(n)||!0===n){var e=setInterval((function(){t&&m((function(e){return e+1}))}),1e3);return function(){clearInterval(e)}}}),[t,n,r,N]),(0,l.useEffect)((function(){if(!s){var e=h;e-j>10&&_()({url:"".concat(p._,"/api/reader/read-time"),method:"PUT",headers:{address:N,"user-id":c.user.uid,authorization:"Bearer ".concat(c.tokens.acsTkn.tkn)},data:{bookAddress:r.book_address,readTime:e}}).then((function(e){200===e.status&&w(e.data.read_time)})).catch((function(e){R((0,k.e1)("ERROR"))}))}}),[r,h,N,j,R,s,c]),(0,S.jsxs)("div",{className:"readtime",children:[(0,S.jsx)(E,{width:"3rem",height:"3rem",stroke:"currentColor"}),(0,S.jsx)("div",{className:"readtime__time",children:b(h)})]})},L=n(9135),R=function(e){var t=e.show,n=void 0!==t&&t,r=e.setShow,o=void 0===r?function(){}:r,i=e.position,a=void 0===i?"right":i,l=e.title,s=void 0===l?"":l,c=e.children;return(0,S.jsxs)("div",{className:function(){var e=["sidepanel"];return!0===n&&e.push("sidepanel--open"),e.push("sidepanel--".concat(a)),e.join(" ")}(),children:[(0,S.jsxs)("div",{className:"sidepanel__header",children:[(0,S.jsx)("div",{className:"sidepanel__header__close-btn",children:(0,S.jsx)(h.Z,{type:"icon",onClick:function(){return o(!1)},children:(0,S.jsx)(L.r,{width:24,height:24,stroke:"currentColor"})})}),(0,S.jsx)("div",{className:"sidepanel__header__title typo__head--6",children:s})]}),(0,S.jsx)("div",{className:"sidepanel__body",children:c})]})},Z=n(95899),I={fontSize:{min:100,max:250,step:10,offset:50},lineHeight:{min:1,max:2,step:.25},fontFamily:[{id:"reader-font-family-arial",name:"Arial",value:"'Arial', sans-serif"},{id:"reader-font-family-times",name:"Times",value:"'Times New Roman', serif"},{id:"reader-font-family-trebuchet",name:"Trebuchet",value:"'Trebuchet MS', sans-serif"}],themes:[{id:"reader-theme-light",name:"Light",backgroundColor:"white",color:"black",bodyTheme:"light"},{id:"reader-theme-dark",name:"Dark",backgroundColor:"black",color:"white",bodyTheme:"dark"}]},C={fontSize:170,lineHeight:1.6,fontFamily:I.fontFamily.find((function(e){return"reader-font-family-arial"===e.id})),theme:I.themes.find((function(e){return"reader-theme-light"===e.id}))},P={body:{"--font-family":C.fontFamily.value,"--font-size":C.fontSize+"%","--line-height":C.lineHeight,"--background-color":C.theme.backgroundColor,"--color":C.theme.color,"background-color":"var(--background-color) !important",color:"var(--color) !important","font-size":"var(--font-size) !important"},p:{"text-align":"justify","font-family":"var(--font-family) !important","line-height":"var(--line-height) !important"}},z=["title","titleId"];function M(){return M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},M.apply(this,arguments)}function W(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function q(e,t){var n=e.title,r=e.titleId,o=W(e,z);return l.createElement("svg",M({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,x||(x=l.createElement("line",{y2:28,transform:"translate(24 10)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),O||(O=l.createElement("line",{x2:28,transform:"translate(10 24)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var A,T=l.forwardRef(q),F=(n.p,["title","titleId"]);function H(){return H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(this,arguments)}function B(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function V(e,t){var n=e.title,r=e.titleId,o=B(e,F);return l.createElement("svg",H({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,A||(A=l.createElement("line",{x2:28,transform:"translate(10 24)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var D,J,U=l.forwardRef(V),G=(n.p,function(e){var t=e.value,n=void 0===t?0:t,r=e.setValue,o=void 0===r?function(){}:r,i=e.unit,a=void 0===i?"":i,l=e.min,s=void 0===l?0:l,c=e.max,u=void 0===c?100:c,d=e.step,f=void 0===d?1:d,h=e.offset,m=void 0===h?0:h;return(0,S.jsxs)("div",{className:"number-input",children:[(0,S.jsx)("div",{className:"number-input__button",onClick:function(){o(Math.max(s,n-f))},children:(0,S.jsx)(U,{width:24,stroke:"currentColor"})}),(0,S.jsxs)("div",{className:"number-input__value",children:[n-m,a]}),(0,S.jsx)("div",{className:"number-input__button",onClick:function(){o(Math.min(u,n+f))},children:(0,S.jsx)(T,{width:24,stroke:"currentColor"})})]})}),Y=function(e){var t=e.rendition,n=(0,l.useState)((0,r.Z)((0,r.Z)({},C),{},{fontFamily:C.fontFamily.id,theme:C.theme.id})),i=(0,o.Z)(n,2),a=i[0],s=i[1],c=(0,l.useCallback)((function(){try{var e=t.currentLocation();t.clear(),t.display(e.start.cfi)}catch(n){}}),[t]);(0,l.useEffect)((function(){var e=function(){if(!window.localStorage)return{};try{return JSON.parse(window.localStorage.getItem("READER_PREFERENCES"))||{}}catch(e){return{}}}(),t=e.fontSize,n=void 0===t?C.fontSize:t,r=e.lineHeight,o=void 0===r?C.lineHeight:r,i=e.fontFamily,a=void 0===i?C.fontFamily.id:i,l=e.theme,c=void 0===l?C.theme.id:l;s({fontSize:n,lineHeight:o,fontFamily:a,theme:c})}),[]),(0,l.useEffect)((function(){if((0,v.fb)(t)){var e=I.themes.find((function(e){return e.id===a.theme})),n=I.fontFamily.find((function(e){return e.id===a.fontFamily}));(0,v.fb)(e)||(e=I.themes[0]),(0,v.fb)(n)||(n=I.fontFamily[0]),t.themes.override("--font-size",a.fontSize+"%"),t.themes.override("--font-family",n.value),t.themes.override("--line-height",a.lineHeight),t.themes.override("--background-color",e.backgroundColor),t.themes.override("--color",e.color),window.document.body.setAttribute("data-theme",e.bodyTheme),c(),function(e){window.localStorage&&window.localStorage.setItem("READER_PREFERENCES",JSON.stringify(e))}(a)}}),[a,t,c]);return(0,S.jsxs)("div",{className:"panel panel__customizer",children:[(0,S.jsxs)("div",{className:"panel__customizer__field",children:[(0,S.jsx)("div",{className:"panel__customizer__field__lable typo__head--6",children:"Font Size"}),(0,S.jsx)("div",{className:"panel__customizer__field__input",children:(0,S.jsx)(G,{value:a.fontSize,setValue:function(e){(0,Z.Z)("event_customizer_fontsize_"+e),s((function(t){return(0,r.Z)((0,r.Z)({},t),{},{fontSize:e})}))},unit:"%",offset:I.fontSize.offset,min:I.fontSize.min,max:I.fontSize.max,step:I.fontSize.step})})]}),(0,S.jsxs)("div",{className:"panel__customizer__field",children:[(0,S.jsx)("div",{className:"panel__customizer__field__lable typo__head--6",children:"Line Spacing"}),(0,S.jsx)("div",{className:"panel__customizer__field__input",children:(0,S.jsx)(G,{value:a.lineHeight,setValue:function(e){(0,Z.Z)("event_customizer_lineheight_"+e),s((function(t){return(0,r.Z)((0,r.Z)({},t),{},{lineHeight:e})}))},min:I.lineHeight.min,max:I.lineHeight.max,step:I.lineHeight.step})})]}),(0,S.jsxs)("div",{className:"panel__customizer__field",children:[(0,S.jsx)("div",{className:"panel__customizer__field__lable typo__head--6",children:"Themes"}),(0,S.jsx)("div",{className:"panel__customizer__field__input panel__customizer__field__input--themes",children:I.themes.map((function(e){return(0,S.jsx)("div",{className:"panel__customizer__field__input__chip"+(a.theme===e.id?" panel__customizer__field__input__chip--selected":""),onClick:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"reader-theme-light";(0,Z.Z)("event_customizer_theme_"+e),s((function(t){return(0,r.Z)((0,r.Z)({},t),{},{theme:e})}))}(e.id)},style:{color:e.color,backgroundColor:e.backgroundColor},children:"Aa"},e.id)}))})]}),(0,S.jsxs)("div",{className:"panel__customizer__field",children:[(0,S.jsx)("div",{className:"panel__customizer__field__lable typo__head--6",children:"Fonts"}),(0,S.jsx)("div",{className:"panel__customizer__field__input panel__customizer__field__input--fonts",children:I.fontFamily.map((function(e){return(0,S.jsxs)("div",{className:"panel__customizer__field__input__font"+(a.fontFamily===e.id?" panel__customizer__field__input__font--selected":""),style:{fontFamily:e.value},onClick:function(){var t;t=e.id,(0,Z.Z)("event_customizer_font_"+t),s((function(e){return(0,r.Z)((0,r.Z)({},e),{},{fontFamily:t})}))},children:[(0,S.jsx)("div",{className:"panel__customizer__field__input__font__demo",children:"Aa"}),(0,S.jsx)("div",{className:"panel__customizer__field__input__font__name",children:e.name})]},e.id)}))})]})]})},Q=n(93433),K=n(4127),X=function(e){var t=e.mobileView,n=e.preview,r=e.rendition,s=e.bookMeta,c=e.addAnnotationRef,u=e.onRemove,d=void 0===u?function(){}:u,f=e.hideModal,m=void 0===f?function(){}:f,b=(0,i.I0)(),y=(0,a.s0)(),g=(0,i.v9)((function(e){return e.BWalletState})),j=(0,l.useState)(null),w=(0,o.Z)(j,2),x=w[0],O=w[1],E=(0,l.useState)(!1),N=(0,o.Z)(E,2),L=N[0],R=N[1],I=(0,l.useState)([]),C=(0,o.Z)(I,2),P=C[0],z=C[1];(0,l.useEffect)((function(){b(L?(0,K.yh)():(0,K.v3)())}),[L,b]),(0,l.useEffect)((function(){(0,v.fb)(t)&&!1!==t||(0,v.fb)(n)&&!n&&((0,v.fb)(g.smartAccount)?O(g.smartAccount.address):y(-1))}),[g,y,n,t]),(0,l.useEffect)((function(){(0,v.fb)(n)&&!n&&(0,v.fb)(s)&&(0,v.fb)(x)&&(0,v.fb)(r)&&(R(!0),_()({url:"".concat(p._,"/api/reader/annotations"),method:"GET",params:{bookAddress:s.book_address,ownerAddress:x}}).then((function(e){if(200===e.status){var t=JSON.parse(e.data.annotations)||[];z(t),t.forEach((function(e){r.annotations.add("highlight",e.cfiRange,{},(function(){}),"",{fill:e.color,"fill-opacity":"0.35","mix-blend-mode":"multiply"})}))}else b((0,k.e1)("NOT200"))})).catch((function(e){b((0,k.e1)("ERROR"))})).finally((function(){return R(!1)})))}),[s,x,b,r,n]);var M=function(e,t){if((0,Z.Z)("event_annotationpanel_remove"),(0,v.fb)(n)&&!n&&(0,v.fb)(s)&&(0,v.fb)(x)&&(0,v.fb)(r)){if(!(0,v.fb)(r))return;if(!(0,v.fb)(s))return;R(!0);var o=P.filter((function(t,n){return n!==e}));_()({url:"".concat(p._,"/api/reader/annotations"),method:"POST",data:{bookAddress:s.book_address,ownerAddress:x,annotations:JSON.stringify(o)}}).then((function(e){200===e.status?(z(o),r.annotations.remove(t.cfiRange,"highlight"),d()):b((0,k.e1)("NOT200"))})).catch((function(e){b((0,k.e1)("ERROR"))})).finally((function(){return R(!1)}))}},W=function(e){(0,Z.Z)("event_annotationpanel_goto_page"),(0,v.fb)(r)&&(r.display(e),r.display(e),m())},q=(0,l.useCallback)((function(e){if((0,Z.Z)("event_annotationpanel_annotate"),(0,v.fb)(n)&&!n&&(0,v.fb)(s)&&(0,v.fb)(x)&&(0,v.fb)(r)){if(!(0,v.fb)(r))return;if(!(0,v.fb)(s))return;R(!0);var t=[].concat((0,Q.Z)(P),[e]);_()({url:"".concat(p._,"/api/reader/annotations"),method:"POST",data:{bookAddress:s.book_address,ownerAddress:x,annotations:JSON.stringify(t)}}).then((function(n){200===n.status?(z(t),r.annotations.add("highlight",e.cfiRange,{},(function(){}),"",{fill:e.color,"fill-opacity":"0.35","mix-blend-mode":"multiply"})):b((0,k.e1)("NOT200"))})).catch((function(e){b((0,k.e1)("ERROR"))})).finally((function(){return R(!1)}))}}),[P,x,s,b,r,n]);return(0,l.useEffect)((function(){c.current=q}),[c,q]),(0,S.jsxs)("div",{className:"panel panel__annotation",children:[" ",function(){var e=[];return(0,v.fb)(r)&&(0,v.fb)(s)?(P.forEach((function(t,n){e.push((0,S.jsxs)("div",{className:"panel__annotation__item",onClick:function(){return W(t.cfiRange)},children:[(0,S.jsxs)("div",{className:"panel__annotation__item__container",children:[(0,S.jsx)("div",{className:"panel__annotation__item__color",style:{backgroundColor:t.color}}),(0,S.jsx)("div",{className:"panel__annotation__item__name",children:t.text})]}),(0,S.jsx)(h.Z,{size:"sm",type:"icon",onClick:function(e){e.stopPropagation(),M(n,t)},children:"remove"})]},n))})),0===e.length&&e.push((0,S.jsx)("div",{className:"panel__empty",children:"No Items"},"empty")),e):""}()," "]})},$=n(72426),ee=n.n($),te=["title","titleId"];function ne(){return ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ne.apply(this,arguments)}function re(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function oe(e,t){var n=e.title,r=e.titleId,o=re(e,te);return l.createElement("svg",ne({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-message-circle-2",width:24,height:24,viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,D||(D=l.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"})),J||(J=l.createElement("path",{d:"M3 20l1.3 -3.9a9 8 0 1 1 3.4 2.9l-4.7 1"})))}var ie,ae,le=l.forwardRef(oe),se=(n.p,n(39362)),ce=["title","titleId"];function ue(){return ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ue.apply(this,arguments)}function de(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function fe(e,t){var n=e.title,r=e.titleId,o=de(e,ce);return l.createElement("svg",ue({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-thumb-up",width:24,height:24,viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,ie||(ie=l.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"})),ae||(ae=l.createElement("path",{d:"M7 11v8a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-7a1 1 0 0 1 1 -1h3a4 4 0 0 0 4 -4v-1a2 2 0 0 1 4 0v5h3a2 2 0 0 1 2 2l-1 5a2 3 0 0 1 -2 2h-7a3 3 0 0 1 -3 -3"})))}var he,me,_e=l.forwardRef(fe),pe=(n.p,["title","titleId"]);function ve(){return ve=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ve.apply(this,arguments)}function be(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function ke(e,t){var n=e.title,r=e.titleId,o=be(e,pe);return l.createElement("svg",ve({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-thumb-down",width:24,height:24,viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,he||(he=l.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"})),me||(me=l.createElement("path",{d:"M7 13v-8a1 1 0 0 0 -1 -1h-2a1 1 0 0 0 -1 1v7a1 1 0 0 0 1 1h3a4 4 0 0 1 4 4v1a2 2 0 0 0 4 0v-5h3a2 2 0 0 0 2 -2l-1 -5a2 3 0 0 0 -2 -2h-7a3 3 0 0 0 -3 3"})))}var ye,ge,je,we=l.forwardRef(ke),xe=(n.p,["title","titleId"]);function Oe(){return Oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Oe.apply(this,arguments)}function Ee(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Se(e,t){var n=e.title,r=e.titleId,o=Ee(e,xe);return l.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-send",width:24,height:24,viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,ye||(ye=l.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"})),ge||(ge=l.createElement("line",{x1:10,y1:14,x2:21,y2:3})),je||(je=l.createElement("path",{d:"M21 3l-6.5 18a0.55 .55 0 0 1 -1 0l-3.5 -7l-7 -3.5a0.55 .55 0 0 1 0 -1l18 -6.5"})))}var Ne,Le,Re,Ze,Ie,Ce=l.forwardRef(Se),Pe=(n.p,["title","titleId"]);function ze(){return ze=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ze.apply(this,arguments)}function Me(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function We(e,t){var n=e.title,r=e.titleId,o=Me(e,Pe);return l.createElement("svg",ze({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-arrow-up-circle",width:24,height:24,viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,Ne||(Ne=l.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"})),Le||(Le=l.createElement("circle",{cx:12,cy:12,r:9})),Re||(Re=l.createElement("line",{x1:12,y1:8,x2:8,y2:12})),Ze||(Ze=l.createElement("line",{x1:12,y1:8,x2:12,y2:16})),Ie||(Ie=l.createElement("line",{x1:16,y1:12,x2:12,y2:8})))}var qe,Ae,Te,Fe,He,Be=l.forwardRef(We),Ve=(n.p,["title","titleId"]);function De(){return De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},De.apply(this,arguments)}function Je(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Ue(e,t){var n=e.title,r=e.titleId,o=Je(e,Ve);return l.createElement("svg",De({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-arrow-down-circle",width:24,height:24,viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,qe||(qe=l.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"})),Ae||(Ae=l.createElement("circle",{cx:12,cy:12,r:9})),Te||(Te=l.createElement("line",{x1:8,y1:12,x2:12,y2:16})),Fe||(Fe=l.createElement("line",{x1:12,y1:8,x2:12,y2:16})),He||(He=l.createElement("line",{x1:16,y1:12,x2:12,y2:16})))}var Ge,Ye=l.forwardRef(Ue),Qe=(n.p,function(e){var t=e.quote,n=e.bookMeta,r=e.UserState,a=e.preview,s=e.rendition,c=e.hideModal,u=(0,i.I0)(),d=(0,l.useState)(!1),f=(0,o.Z)(d,2),h=f[0],m=f[1],b=(0,l.useState)(""),y=(0,o.Z)(b,2),g=y[0],j=y[1],w=(0,l.useState)([]),x=(0,o.Z)(w,2),O=x[0],E=x[1];(0,l.useEffect)((function(){_()({url:"".concat(p._,"/api/book/quotes/comments"),method:"GET",params:{bookAddress:n.book_address,quoteId:t.book_id}}).then((function(e){200===e.status?E(e.data):204===e.status||u((0,k.e1)("NOT200"))})).catch((function(e){u((0,k.e1)("ERROR"))}))}),[n,u,s,a,t]);var N=function(e){var t=[];return e.forEach((function(e,n){t.push((0,S.jsxs)("div",{className:"quotes__comments__thread",children:[(0,S.jsxs)("div",{className:"quotes__comments__icon",children:[(0,S.jsx)(se.r,{width:22,height:24,stroke:"currentColor"}),(0,S.jsx)("div",{className:"quotes__comments__text",children:e.uid})]}),(0,S.jsx)("div",{className:"quotes__comments__body typo__body",children:e.comment})]},n))})),t};return(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"quotes__item",onClick:function(){return e=t.cfi_range,(0,Z.Z)("event_annotationpanel_goto_page"),void((0,v.fb)(s)&&(s.display(e),s.display(e),c()));var e},children:[(0,S.jsx)("div",{className:"quotes__item__body typo__body",children:t.body}),(0,S.jsx)("div",{className:"quotes__item__time typo__cap typo__cap--2",children:ee()(t.created_at).format("D MMM, YYYY")||"-"})]}),(0,S.jsx)("div",{className:"quotes__item__section"}),(0,S.jsxs)("div",{className:"quotes__item__section__icons",children:[(0,S.jsxs)("div",{className:"quotes__item__section__icon__action",children:[" ",(0,S.jsx)(le,{onClick:function(){return m(!h)},height:24,width:24}),O.length]}),(0,S.jsx)("div",{className:"quotes__item__section__icon__action",children:(0,S.jsx)(Be,{height:24,width:24})}),(0,S.jsx)("div",{className:"quotes__item__section__icon__action",children:(0,S.jsx)(Ye,{height:24,width:24})})]}),h?(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"quotes__item__section__comment-div",children:[(0,S.jsx)("input",{value:g,onChange:function(e){return j(e.target.value)},className:"quotes__item__section__comment-div__input",type:"text",placeholder:"Add a comment..."}),(0,S.jsx)("div",{className:"quotes__item__section__comment-div__action",children:(0,S.jsx)(Ce,{onClick:function(){g.length>2&&_()({url:"".concat(p._,"/api/book/quotes/comments"),method:"POST",headers:{"user-id":r.user.uid},data:{bookAddress:n.book_address,quoteId:t.book_id,comment:g}}).then((function(e){200===e.status?_()({url:"".concat(p._,"/api/book/quotes/comments"),method:"GET",params:{bookAddress:n.book_address,quoteId:t.book_id}}).then((function(e){200===e.status?(E(e.data),j("")):204===e.status||u((0,k.e1)("NOT200"))})).catch((function(e){u((0,k.e1)("ERROR"))})):u((0,k.e1)("NOT200"))})).catch((function(e){u((0,k.e1)("ERROR"))}))}})})]}),function(){var e=[];return O.forEach((function(t,n){e.push((0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"quotes__comments",children:[(0,S.jsxs)("div",{className:"quotes__comments__icon",children:[(0,S.jsx)(se.r,{width:22,height:24,stroke:"currentColor"}),(0,S.jsx)("div",{className:"quotes__comments__text",children:t.uid})]}),(0,S.jsx)("div",{className:"quotes__comments__body typo__body",children:t.comment})]},n),(0,S.jsxs)("div",{className:"quotes__item__section__icons",children:[(0,S.jsx)("div",{className:"quotes__item__section__icon__action",children:(0,S.jsx)(_e,{height:24,width:24})}),(0,S.jsx)("div",{className:"quotes__item__section__icon__action",children:(0,S.jsx)(we,{height:24,width:24})})]}),t.thread?N(t.thread):null]}))})),e}()]}):null]})}),Ke=function(e){var t=e.setDiscCount,n=e.mobileView,r=e.preview,s=e.rendition,c=e.bookMeta,u=e.hideModal,d=void 0===u?function(){}:u,f=(0,i.I0)(),m=(0,a.s0)(),b=(0,i.v9)((function(e){return e.UserState})),y=(0,i.v9)((function(e){return e.BWalletState})),g=(0,l.useState)(null),j=(0,o.Z)(g,2),w=j[0],x=j[1],O=(0,l.useState)(!1),E=(0,o.Z)(O,2),N=E[0],L=E[1],R=(0,l.useState)([]),Z=(0,o.Z)(R,2),I=Z[0],C=Z[1],P=(0,l.useState)(""),z=(0,o.Z)(P,2),M=z[0],W=z[1];(0,l.useEffect)((function(){f(N?(0,K.yh)():(0,K.v3)())}),[N,f]),(0,l.useEffect)((function(){(0,v.fb)(n)&&!1!==n||(0,v.fb)(r)&&!r&&((0,v.fb)(y.smartAccount.address)?x(y.smartAccount.address):m(-1))}),[y,m,r,n]),(0,l.useEffect)((function(){if((0,v.fb)(r)&&!r&&(0,v.fb)(c)&&(0,v.fb)(w)&&(0,v.fb)(s)){if(!(0,v.fb)(s))return;if(!(0,v.fb)(c))return;_()({url:"".concat(p._,"/api/book/quotes"),method:"GET",params:{bookAddress:c.book_address,cfi_range:s.currentLocation().start.cfi}}).then((function(e){200===e.status?(t(e.data.length),C(e.data)):204===e.status||f((0,k.e1)("NOT200"))})).catch((function(e){f((0,k.e1)("ERROR"))})).finally((function(){return L(!1)}))}}),[w,c,f,null===s||void 0===s?void 0:s.location]);var q=(0,l.useCallback)((function(e){if((0,v.fb)(r)&&!r&&(0,v.fb)(c)&&(0,v.fb)(w)&&(0,v.fb)(s)){if(!(0,v.fb)(s))return;if(!(0,v.fb)(c))return;L(!0),_()({url:"".concat(p._,"/api/book/quotes"),method:"POST",data:{bookAddress:c.book_address,ownerAddress:w,quote:{body:e},cfi_range:null===s||void 0===s?void 0:s.currentLocation().start.cfi}}).then((function(e){200===e.status?_()({url:"".concat(p._,"/api/book/quotes"),method:"GET",params:{bookAddress:c.book_address,cfi_range:s.currentLocation().start.cfi}}).then((function(e){200===e.status?(t(e.data.length),C(e.data),W(""),console.log(e.data)):204===e.status||f((0,k.e1)("NOT200"))})).catch((function(e){f((0,k.e1)("ERROR"))})).finally((function(){return L(!1)})):f((0,k.e1)("NOT200"))})).catch((function(e){f((0,k.e1)("ERROR"))})).finally((function(){return L(!1)}))}}),[I,w,c,f,s,r]);return(0,S.jsxs)("div",{className:"panel panel__annotation",children:[(0,S.jsxs)("div",{className:"quotes__input",children:[(0,S.jsx)("textarea",{className:"quotes__input__text-input",rows:6,onChange:function(e){return W(e.target.value)},placeholder:"Start a Discussion...",type:"text",value:M}),(0,S.jsx)(h.Z,{className:"quotes__input__button",type:"primary",onClick:function(){return q(M)},children:"Post"})]}),I.map((function(e){return(0,S.jsx)(Qe,{rendition:s,quote:e,bookMeta:c,preview:r,UserState:b,hideModal:d})}))]})},Xe=function(e){var t=e.onColorSelect,n=void 0===t?function(){}:t,r=e.onClose,o=void 0===r?function(){}:r;return(0,S.jsxs)("div",{className:"annotation-context-menu",children:[(0,S.jsx)("div",{className:"annotation-context-menu__container",children:["#e6192a","#0080ff","#14b84b","#ffd500","#aa00ff"].map((function(e){return(0,S.jsx)("div",{style:{"--color":e},className:"annotation-context-menu__container__item",onClick:function(){return n(e)}},e)}))}),(0,S.jsx)("div",{className:"annotation-context-menu__close",children:(0,S.jsx)(h.Z,{type:"icon",onClick:o,children:(0,S.jsx)(L.r,{})})})]})},$e=["title","titleId"];function et(){return et=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},et.apply(this,arguments)}function tt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function nt(e,t){var n=e.title,r=e.titleId,o=tt(e,$e);return l.createElement("svg",et({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,Ge||(Ge=l.createElement("path",{d:"M21,6,9,18,21,30",transform:"translate(9 6)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var rt,ot=l.forwardRef(nt),it=(n.p,["title","titleId"]);function at(){return at=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},at.apply(this,arguments)}function lt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function st(e,t){var n=e.title,r=e.titleId,o=lt(e,it);return l.createElement("svg",at({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,rt||(rt=l.createElement("path",{d:"M9,6,21,18,9,30",transform:"translate(9 6)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var ct,ut=l.forwardRef(st),dt=(n.p,["title","titleId"]);function ft(){return ft=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ft.apply(this,arguments)}function ht(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function mt(e,t){var n=e.title,r=e.titleId,o=ht(e,dt);return l.createElement("svg",ft({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,ct||(ct=l.createElement("path",{d:"M11,4H23a4,4,0,0,1,4,4V36L17,30,7,36V8a4,4,0,0,1,4-4",transform:"translate(7 4)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var _t,pt,vt,bt,kt=l.forwardRef(mt),yt=(n.p,["title","titleId"]);function gt(){return gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gt.apply(this,arguments)}function jt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function wt(e,t){var n=e.title,r=e.titleId,o=jt(e,yt);return l.createElement("svg",gt({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,_t||(_t=l.createElement("circle",{cx:7,cy:7,r:7,transform:"translate(28 24)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),pt||(pt=l.createElement("path",{d:"M3,33V12a7,7,0,1,1,14,0V33",transform:"translate(3 5)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),vt||(vt=l.createElement("path",{d:"M3,13H17",transform:"translate(3 13)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),bt||(bt=l.createElement("path",{d:"M21,12V26",transform:"translate(21 12)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var xt,Ot,Et,St,Nt,Lt,Rt,Zt,It=l.forwardRef(wt),Ct=(n.p,n(14998)),Pt=["title","titleId"];function zt(){return zt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zt.apply(this,arguments)}function Mt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Wt(e,t){var n=e.title,r=e.titleId,o=Mt(e,Pt);return l.createElement("svg",zt({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,xt||(xt=l.createElement("path",{d:"M16,4h8v8",transform:"translate(16 4)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Ot||(Ot=l.createElement("line",{y1:12,x2:12,transform:"translate(28 8)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Et||(Et=l.createElement("path",{d:"M12,24H4V16",transform:"translate(4 16)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),St||(St=l.createElement("line",{y1:12,x2:12,transform:"translate(8 28)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Nt||(Nt=l.createElement("path",{d:"M16,24h8V16",transform:"translate(16 16)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Lt||(Lt=l.createElement("line",{x2:12,y2:12,transform:"translate(28 28)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Rt||(Rt=l.createElement("path",{d:"M12,4H4v8",transform:"translate(4 4)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Zt||(Zt=l.createElement("line",{x2:12,y2:12,transform:"translate(8 8)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var qt,At,Tt,Ft,Ht,Bt,Vt,Dt,Jt=l.forwardRef(Wt),Ut=(n.p,["title","titleId"]);function Gt(){return Gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gt.apply(this,arguments)}function Yt(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Qt(e,t){var n=e.title,r=e.titleId,o=Yt(e,Ut);return l.createElement("svg",Gt({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,qt||(qt=l.createElement("path",{d:"M5,13h8V5",transform:"translate(5 5)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),At||(At=l.createElement("line",{x2:12,y2:12,transform:"translate(6 6)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Tt||(Tt=l.createElement("path",{d:"M5,15h8v8",transform:"translate(5 15)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Ft||(Ft=l.createElement("line",{y1:12,x2:12,transform:"translate(6 30)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Ht||(Ht=l.createElement("path",{d:"M23,13H15V5",transform:"translate(15 5)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Bt||(Bt=l.createElement("line",{y1:12,x2:12,transform:"translate(30 6)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Vt||(Vt=l.createElement("path",{d:"M23,15H15v8",transform:"translate(15 15)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Dt||(Dt=l.createElement("line",{x2:12,y2:12,transform:"translate(30 30)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var Kt,Xt,$t,en,tn,nn,rn=l.forwardRef(Qt),on=(n.p,["title","titleId"]);function an(){return an=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},an.apply(this,arguments)}function ln(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function sn(e,t){var n=e.title,r=e.titleId,o=ln(e,on);return l.createElement("svg",an({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,Kt||(Kt=l.createElement("line",{x2:22,transform:"translate(18 12)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),Xt||(Xt=l.createElement("line",{x2:22,transform:"translate(18 24)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),$t||($t=l.createElement("line",{x2:22,transform:"translate(18 36)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),en||(en=l.createElement("line",{y2:.02,transform:"translate(10 12)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),tn||(tn=l.createElement("line",{y2:.02,transform:"translate(10 24)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),nn||(nn=l.createElement("line",{y2:.02,transform:"translate(10 36)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var cn,un,dn,fn=l.forwardRef(sn),hn=(n.p,["title","titleId"]);function mn(){return mn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mn.apply(this,arguments)}function _n(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function pn(e,t){var n=e.title,r=e.titleId,o=_n(e,hn);return l.createElement("svg",mn({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-messages",width:24,height:24,viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",ref:t,"aria-labelledby":r},o),n?l.createElement("title",{id:r},n):null,cn||(cn=l.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"})),un||(un=l.createElement("path",{d:"M21 14l-3 -3h-7a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1h9a1 1 0 0 1 1 1v10"})),dn||(dn=l.createElement("path",{d:"M14 15v2a1 1 0 0 1 -1 1h-7l-3 3v-10a1 1 0 0 1 1 -1h2"})))}var vn=l.forwardRef(pn),bn=(n.p,function(e){var t=e.rendition,n=e.onGoto,r=void 0===n?function(){}:n,i=e.onSelect,a=void 0===i?function(){}:i,s=(0,l.useState)([]),c=(0,o.Z)(s,2),u=c[0],d=c[1];(0,l.useEffect)((function(){(0,v.fb)(t)&&(0,v.fb)(t.book)&&t.book.loaded.navigation.then((function(e){var t=e.toc.map((function(e){return{label:e.label,href:e.href}}));d(t)}))}),[t]);var f=function(e){a(),(0,Z.Z)("event_toc_panel_goto"),(0,v.fb)(t)&&(t.display(e),t.display(e),r())};return(0,S.jsx)("div",{className:"panel panel__toc",children:function(){(0,Z.Z)("event_toc_panel_show");var e=[];return(0,v.fb)(t)?(u.forEach((function(t,n){e.push((0,S.jsx)("div",{className:"panel__toc__item",onClick:function(){return f("".concat(t.href))},children:(0,S.jsx)("div",{className:"typo__body typo__body--1",children:t.label})},n))})),0===e.length&&e.push((0,S.jsx)("div",{className:"panel__empty",children:"No Items"},"empty")),e):""}()})}),kn=function(e){var t=e.className,n=void 0===t?"":t,r=e.value,o=e.onChange,i=e.min,a=void 0===i?0:i,s=e.max,c=void 0===s?100:s,u=e.step,d=void 0===u?1:u,f=(0,l.useRef)();return(0,l.useEffect)((function(){if((0,v.fb)(f.current)){var e=r/(c-a);f.current.style.setProperty("--progress",e)}}),[r,a,c,f]),(0,S.jsx)("div",{ref:f,className:"range-slider "+n,children:(0,S.jsx)("input",{type:"range",value:r,onChange:o,min:a,max:c,step:d,className:"range-slider__input"})})},yn=n(16026),gn=n(40696),jn=function(){var e=(0,a.TH)(),t=(0,i.I0)(),n=(0,a.s0)(),u=(0,i.v9)((function(e){return e.BWalletState})),d=(0,l.useState)(0),m=(0,o.Z)(d,2),b=m[0],y=m[1],g=(0,l.useState)(null),j=(0,o.Z)(g,2),w=j[0],x=j[1],O=(0,l.useState)(!1),E=(0,o.Z)(O,2),L=E[0],I=E[1],C=(0,l.useState)({}),z=(0,o.Z)(C,2),M=z[0],W=z[1],q=(0,l.useState)(0),A=(0,o.Z)(q,2),T=A[0],F=A[1],H=(0,l.useState)(),B=(0,o.Z)(H,2),V=B[0],D=B[1],J=(0,l.useState)(!1),U=(0,o.Z)(J,2),G=U[0],Q=U[1],$=(0,l.useState)(!1),ee=(0,o.Z)($,2),te=ee[0],ne=ee[1],re=(0,l.useState)(!1),oe=(0,o.Z)(re,2),ie=oe[0],ae=oe[1],le=(0,l.useState)(!1),se=(0,o.Z)(le,2),ce=se[0],ue=se[1],de=(0,l.useState)(0),fe=(0,o.Z)(de,2),he=fe[0],me=fe[1],_e=(0,l.useState)(!1),pe=(0,o.Z)(_e,2),ve=pe[0],be=pe[1],ke=(0,l.useState)(!1),ye=(0,o.Z)(ke,2),ge=ye[0],je=ye[1],we=(0,l.useState)(null),xe=(0,o.Z)(we,2),Oe=xe[0],Ee=xe[1],Se=(0,l.useState)(!0),Ne=(0,o.Z)(Se,2),Le=Ne[0],Re=Ne[1],Ze=(0,l.useState)({}),Ie=(0,o.Z)(Ze,2),Ce=Ie[0],Pe=Ie[1],ze=(0,l.useState)(!1),Me=(0,o.Z)(ze,2),We=Me[0],qe=Me[1],Ae=(0,l.useState)(""),Te=(0,o.Z)(Ae,2),Fe=Te[0],He=Te[1],Be=(0,l.useState)(""),Ve=(0,o.Z)(Be,2),De=Ve[0],Je=Ve[1],Ue=(0,l.useState)(""),Ge=(0,o.Z)(Ue,2),Ye=Ge[0],Qe=Ge[1],$e=(0,l.useState)(!0),et=(0,o.Z)($e,2),tt=et[0],nt=et[1],rt=f(T,300),it=(0,l.useRef)(),at=(0,l.useRef)(),lt=(0,l.useRef)(!1),st=(0,l.useCallback)((function(){gn.Z.connectWallet().then((function(e){t((0,yn.kH)(e.selectedAddress)),t((0,k.e1)({show:!0,message:"Wallet connected.",type:1}))})).catch((function(e){t((0,k.e1)({show:!0,message:"Error while connecting to wallet",type:4}))})).finally((function(){return I(!1)}))}),[t]),ct=(0,l.useCallback)((function(e){if((0,Z.Z)("event_reader_lastPage_save"),(0,v.fb)(window.localStorage)&&(0,v.fb)(M)){var t="".concat(M.id,":lastread");localStorage.setItem(t,e)}}),[M]),dt=(0,l.useCallback)((function(){if((0,v.fb)(V)&&(0,v.fb)(M)){var e="".concat(M.id,":bookmarks"),t=window.localStorage.getItem(e);if(!(0,v.vd)(t))return!1;var n=JSON.parse(t)||{},r=new c.OS,o=V.currentLocation();try{return 0===r.compare(n.cfi,o.start.cfi)||(0===r.compare(n.cfi,o.end.cfi)||1===r.compare(n.cfi,o.start.cfi)&&-1===r.compare(n.cfi,o.end.cfi))}catch(i){return!1}}}),[M,V]),ft=(0,l.useCallback)((function(){(0,Z.Z)("event_reader_page_bookmark");var e=dt();ue(e)}),[dt]),ht=(0,l.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.customizer,n=void 0===t||t,r=e.annotation,o=void 0===r||r,i=e.quote,a=void 0===i||i,l=e.toc,s=void 0===l||l;(0,Z.Z)("event_reader_panels_hide"),n&&be(!1),o&&ne(!1),a&&ae(!1),s&&je(!1)}),[]);(0,l.useEffect)((function(){(0,Z.Z)("page_view_reader")}),[]),(0,l.useEffect)((function(){!0===G?((0,Z.Z)("event_reader_screen_full"),mt()):((0,Z.Z)("event_reader_screen_window"),_t())}),[G]),(0,l.useEffect)((function(){t(L?(0,K.yh)():(0,K.v3)())}),[L,t]),(0,l.useEffect)((function(){I(!0),(0,v.fb)(u.smartAccount)?Ee(u.smartAccount.address):st(),I(!1)}),[u,st]),(0,l.useEffect)((function(){ht()}),[Le,ht]),(0,l.useEffect)((function(){I(!0);var n=null,r=e.state;(0,v.fb)(r.preview)&&!0===r.preview?((0,Z.Z)("event_reader_mode_preview"),n=p._+"/files/"+r.book.preview,x(!0)):((0,Z.Z)("event_reader_mode_live"),n=r.book.url,x(!1));try{var o=(0,c.ZP)(n,{openAs:"epub"});o.ready.then((function(){var e=document.querySelector("#book__reader");e&&(e.innerHTML="");var t=o.renderTo("book__reader",{width:"100%",height:"100%",manager:"continuous",flow:"paginated",snap:"true",gap:40,allowScriptedContent:!0});t.themes.default(P),t.display(),D(t),I(!1)})).catch((function(e){t((0,k.e1)({show:!0,message:"Error while loading book.",type:4})),I(!1)})),W(r.book)}catch(i){t((0,k.e1)({show:!0,message:"Error while loading book.",type:4})),I(!1)}}),[e,t]),(0,l.useEffect)((function(){if((0,v.fb)(V)){var e=function(){(0,Z.Z)("event_reader_resize"),V.manager.resize("100%","100%")},t=function(){(0,v.fb)(window.document.fullscreenElement)?((0,Z.Z)("event_reader_fullscreen"),Q(!0)):((0,Z.Z)("event_reader_window"),Q(!1)),e()};return window.addEventListener("resize",e),window.addEventListener("fullscreenchange",t),function(){window.removeEventListener("resize",e),window.removeEventListener("fullscreenchange",t)}}}),[V]),(0,l.useEffect)((function(){(0,v.fb)(V)&&((0,v.fb)(Ye)||(0,v.vd)(Ye))&&V.book.loaded.navigation.then((function(){var e,t=Ye,n=V.book.spine.get(t);if((0,v.fb)(n)){var r=V.book.navigation.get(n.href);He((null===r||void 0===r||null===(e=r.label)||void 0===e?void 0:e.trim())||"")}}))}),[V,Ye]),(0,l.useEffect)((function(){if((0,v.fb)(V)&&(0,v.fb)(M)){var e=function(e){ft(),F(e.start.location),ct(e.start.cfi),Qe(e.start.cfi)},t=function(){Re((function(e){return!e}))},n=function(e){(0,Z.Z)("event_reader_navigate_keys"),"ArrowLeft"!==e.key&&37!==(e.keyCode||e.which)||V.prev(),"ArrowRight"!==e.key&&39!==(e.keyCode||e.which)||V.next()};return V.on("relocated",e),V.on("click",t),V.on("keyup",n),document.addEventListener("keyup",n),function(){V.off("relocated",e),V.off("click",t),V.off("keyup",n),document.removeEventListener("keyup",n)}}}),[V,M,ft,ct,Qe]),(0,l.useEffect)((function(){if((0,v.fb)(V)&&(0,v.fb)(M)){var e="".concat(M.id,":locations"),t=localStorage.getItem(e);t?(V.book.locations.load(t),me(JSON.parse(t).length)):V.book.locations.generate().then((function(){me(V.book.locations.total),localStorage.setItem(e,V.book.locations.save())})).catch((function(e){}))}}),[V,M]),(0,l.useEffect)((function(){(0,v.fb)(V)&&!0===lt.current&&(V.display(V.book.locations.cfiFromLocation(rt)),lt.current=!1)}),[rt,V,lt]),(0,l.useEffect)((function(){if((0,v.fb)(window.localStorage)&&(0,v.fb)(M)&&(0,v.fb)(V)){var e="".concat(M.id,":lastread"),t=localStorage.getItem(e);(0,v.fb)(t)&&V.display(t)}}),[M,V]),(0,l.useEffect)((function(){if((0,v.fb)(V)&&(0,v.fb)(M)){var e=function(e,t){(0,Z.Z)("event_reader_content_selected"),V.book.getRange(e).then((function(t){Pe({cfiRange:e,text:null===t||void 0===t?void 0:t.toString()}),qe(!0)})).catch((function(){Pe({})}))};return V.on("selected",e),function(){V.off("selected",e)}}}),[V,M]),(0,l.useEffect)((function(){if((0,v.fb)(V)&&(0,v.fb)(M)){var e=function(e,t,n){ne(!0)};return V.on("markClicked",e),function(){V.off("markClicked",e)}}}),[V,M]);var mt=function(){pt();var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()},_t=function(){pt(),document.fullscreenElement&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())};function pt(){nt(!0),y(0)}return(0,l.useEffect)((function(){if((0,v.fb)(M)||(0,v.fb)(Oe)){var e=setInterval((function(){y((function(e){return e+1}))}),1e3);return function(){clearInterval(e)}}}),[M,Oe]),(0,l.useEffect)((function(){b>=1e3&&(nt(!1),y(0))})),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(s.q,{children:(0,S.jsx)("meta",{name:"Reader",content:"Book's Reader View"})}),(0,S.jsxs)("div",{className:"reader",children:[(0,S.jsxs)("div",{className:"reader__header"+(Le?" reader__header--show":""),children:[(0,S.jsxs)("div",{className:"reader__header__left",children:[(0,S.jsx)(h.Z,{type:"icon",onClick:function(){n(-1)},children:(0,S.jsx)(ot,{})}),(0,S.jsxs)("div",{className:"reader__header__left__timer",children:[(0,S.jsx)("span",{class:"reader__header__left__timer__dot"}),V&&(0,S.jsx)(N,{timerUpdate:tt,preview:w,bookMeta:M,rendition:V})]})]}),(0,S.jsx)("div",{className:"reader__header__center",children:(0,S.jsx)("div",{className:"typo__body--2 typo__color--n700 typo__transform--capital",children:M.title||"Untitled"})}),(0,S.jsxs)("div",{className:"reader__header__right",children:[(0,S.jsxs)(h.Z,{className:"reader__header__right__hide-on-mobile",type:"icon",onClick:function(){return Q((function(e){return!e}))},children:[" ",G?(0,S.jsx)(rn,{}):(0,S.jsx)(Jt,{})," "]}),(0,S.jsxs)(h.Z,{type:"icon",className:ge?"reader__header__right__button--active":"",onClick:function(){ht({toc:!1}),je((function(e){return!e})),pt()},children:[" ",(0,S.jsx)(fn,{})," "]}),(0,S.jsxs)(h.Z,{type:"icon",className:te?"reader__header__right__button--active":"",onClick:function(){ht({annotation:!1}),ne((function(e){return!e})),pt()},children:[" ",(0,S.jsx)(Ct.r,{})," "]}),(0,S.jsxs)(h.Z,{type:"icon",className:ie?"reader__header__right__button--active":"",onClick:function(){ht({quotePanel:!1}),ae((function(e){return!e})),pt()},children:[" ",(0,S.jsx)(vn,{})," "]}),(0,S.jsx)(h.Z,{type:"icon",className:ce?"reader__header__right__button--active":"",onClick:function(){pt(),!0===dt()?function(){if((0,Z.Z)("event_bookmarkpanel_bookmark_remove"),(0,v.fb)(w)&&!w&&(0,v.fb)(M)&&(0,v.fb)(Oe)){if(!(0,v.fb)(V))return;if(!(0,v.fb)(M))return;I(!0),_()({url:"".concat(p._,"/api/reader/bookmarks"),method:"POST",data:{bookAddress:M.book_address,ownerAddress:Oe,bookmarks:""}}).then((function(e){if(200===e.status){var n="".concat(M.id,":bookmarks");localStorage.setItem(n,""),ft()}else t((0,k.e1)("NOT200"))})).catch((function(e){t((0,k.e1)("ERROR"))})).finally((function(){return I(!1)}))}}():function(){if((0,Z.Z)("event_bookmarkpanel_bookmark"),(0,v.fb)(w)&&!w&&(0,v.fb)(M)&&(0,v.fb)(Oe)){if(!(0,v.fb)(V))return;if(!(0,v.fb)(M))return;I(!0);var e={cfi:V.currentLocation().start.cfi,percent:V.currentLocation().start.percentage};_()({url:"".concat(p._,"/api/reader/bookmarks"),method:"POST",data:{bookAddress:M.book_address,ownerAddress:Oe,bookmarks:JSON.stringify(e)}}).then((function(n){if(200===n.status){var r="".concat(M.id,":bookmarks");localStorage.setItem(r,JSON.stringify(e)),ft()}else t((0,k.e1)("NOT200"))})).catch((function(e){t((0,k.e1)("ERROR"))})).finally((function(){return I(!1)}))}}()},children:(0,S.jsx)(kt,{})}),(0,S.jsx)(h.Z,{type:"icon",className:ve?"reader__header__right__button--active":"",onClick:function(){ht({customizer:!1}),be((function(e){return!e})),pt()},children:(0,S.jsx)(It,{})})]})]}),(0,S.jsxs)("div",{className:"reader__container",children:[ie?null:(0,S.jsxs)("div",{className:"quotes__discussions ",children:["Discussions:",(0,S.jsx)("div",{className:"quotes__discussions__count",children:De})]}),(0,S.jsx)("div",{className:ce?"reader__container__bookmark reader__container__bookmark--show":"reader__container__bookmark"}),(0,S.jsx)("div",{className:"reader__container__prev-btn",children:(0,S.jsx)("div",{className:"reader__container__prev-btn__button",onClick:function(){V.prev(),pt()},children:(0,S.jsx)(ot,{width:32,stroke:"currentColor"})})}),(0,S.jsx)("div",{id:"book__reader",className:"reader__container__book"}),(0,S.jsx)("div",{className:"reader__container__next-btn",children:(0,S.jsx)("div",{className:"reader__container__next-btn__button",onClick:function(){V.next(),pt()},children:(0,S.jsx)(ut,{width:32,stroke:"currentColor"})})}),!w&&(0,S.jsx)("div",{className:We?"reader__container__context-menu-container reader__container__context-menu-container--show":"reader__container__context-menu-container",children:(0,S.jsx)(Xe,{onColorSelect:function(e){!function(e){pt(),(0,v.fb)(Ce)&&(0,v.fb)(V)&&(0,v.fb)(M)&&(0,v.fb)(it.current)&&"function"===typeof it.current&&it.current((0,r.Z)((0,r.Z)({},Ce),{},{color:e}))}(e),qe(!1)},onClose:function(){return qe(!1)}})}),(0,S.jsx)(R,{show:ge,setShow:je,position:"right",title:"Table of Content",children:(0,S.jsx)(bn,{onSelect:function(){ht({toc:!1}),je(!1)},rendition:V})}),(0,S.jsx)(R,{show:te,setShow:ne,position:"right",title:"Annotations",children:(0,S.jsx)(X,{preview:w,rendition:V,bookMeta:M,show:te,addAnnotationRef:it,hideModal:function(){ne(!1),pt()},onRemove:function(){ne(!1)}})}),(0,S.jsx)(R,{show:ie,setShow:ae,position:"right",title:"Discussions",children:(0,S.jsx)(Ke,{setDiscCount:Je,preview:w,rendition:V,bookMeta:M,show:ie,addQuotesRef:at,hideModal:function(){ae(!1)}})}),(0,S.jsx)(R,{show:ve,setShow:be,position:"right-bottom",title:"Preferences",children:(0,S.jsx)(Y,{initialFontSize:100,rendition:V})})]}),(0,S.jsxs)("nav",{className:"reader__nav"+(Le?" reader__nav--show":""),children:[(0,S.jsxs)("div",{className:"reader__nav__value",children:[(0,S.jsx)("div",{className:"reader__nav__value__chapter-title typo__gray--n600 typo__transform--capital",children:Fe||M.title||""}),(0,S.jsxs)("div",{children:[Math.floor(100*rt/he)||"0","%"]})]}),(0,S.jsx)("div",{className:"reader__nav__progress",children:(0,S.jsx)(kn,{value:T,onChange:function(e){pt(),lt.current=!0,F(e.target.value)},max:he,className:"reader__nav__progress"})})]})]})]})}}}]);
//# sourceMappingURL=696.b5b417f6.chunk.js.map