"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[472],{7269:function(e,t,r){r.d(t,{r:function(){return c}});var n,a=r(2791),o=["title","titleId"];function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function l(e,t){var r=e.title,l=e.titleId,c=i(e,o);return a.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":l},c),r?a.createElement("title",{id:l},r):null,n||(n=a.createElement("path",{d:"M21,6,9,18,21,30",transform:"translate(9 6)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var c=a.forwardRef(l);r.p},2623:function(e,t,r){r.d(t,{r:function(){return c}});var n,a=r(2791),o=["title","titleId"];function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function l(e,t){var r=e.title,l=e.titleId,c=i(e,o);return a.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":l},c),r?a.createElement("title",{id:l},r):null,n||(n=a.createElement("path",{d:"M9,6,21,18,9,30",transform:"translate(9 6)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var c=a.forwardRef(l);r.p},1536:function(e,t,r){r(5454),r(7269),r(2623),r(184);t.Z=function(e){e.max,e.current,e.onPageChange;return null}},5472:function(e,t,r){r.r(t);var n=r(2982),a=r(885),o=r(4569),s=r.n(o),i=r(6871),l=r(2791),c=r(6030),u=r(4643),f=r(9316),d=r(4127),_=r(5248),p=r(639),h=r(8979),b=r(733),y=r(5454),v=r(6759),k=r(1536),x=r(354),g=r(3930),m=r(5602),j=r(906),w=r(5899),O=r(184);t.default=function(){var e=[{key:"price",value:null,type:"range"},{key:"genres",value:[],type:"multiselect"},{key:"age_group",value:[],type:"multiselect"},{key:"orderby",value:null,type:"select"}],t=(0,i.s0)(),r=(0,c.I0)(),o=(0,c.v9)((function(e){return e.WalletState})),E=(0,l.useState)([]),N=(0,a.Z)(E,2),Z=N[0],R=N[1],S=(0,l.useState)(null),I=(0,a.Z)(S,2),P=I[0],T=I[1],C=(0,l.useState)(e),L=(0,a.Z)(C,2),G=L[0],M=L[1],W=(0,l.useState)(!1),A=(0,a.Z)(W,2),B=A[0],H=A[1],F=(0,l.useState)(!1),D=(0,a.Z)(F,2),q=D[0],z=D[1],Y=(0,l.useState)(window.innerWidth<600?"LIST":"GRID"),J=(0,a.Z)(Y,2),K=J[0],Q=J[1],U=(0,l.useState)(1),V=(0,a.Z)(U,2),X=V[0],$=V[1],ee=(0,l.useState)(10),te=(0,a.Z)(ee,2),re=te[0],ne=(te[1],(0,l.useState)([])),ae=(0,a.Z)(ne,2),oe=ae[0],se=ae[1],ie=(0,l.useState)(100),le=(0,a.Z)(ie,2),ce=le[0],ue=le[1];return(0,l.useEffect)((function(){(0,w.Z)("page_view_explore")}),[]),(0,l.useEffect)((function(){r(B?(0,d.yh)():(0,d.v3)())}),[B,r]),(0,l.useEffect)((function(){H(!0),s()({url:_._+"/api/book/all",method:"GET"}).then((function(e){200===e.status?se(e.data):r((0,u.e1)("NOT200"))})).catch((function(e){r((0,u.e1)("ERROR"))})).finally((function(){return H(!1)}))}),[r]),(0,l.useEffect)((function(){H(!0),(0,f.fb)(o.wallet.provider)&&T(o.wallet.address),H(!1)}),[o]),(0,l.useEffect)((function(){var e=oe;(0,f.fb)(e)&&(G.forEach((function(t){switch(t.type){case"range":(0,f.fb)(t.value)&&(e=e.filter((function(e){return e[t.key]<=t.value})));break;case"multiselect":if((0,f.vd)(t.value)){var r=[];t.value.forEach((function(n){return e.forEach((function(e){e[t.key].indexOf(n)>-1&&r.filter((function(t){return t.id===e.id})).length<1&&r.push(e)}))})),e=r}break;case"select":if("orderby"===t.key)switch(t.value){case"PRICE_L_H":e.sort((function(e,t){return e.price<t.price}));break;case"PRICE_H_L":e.sort((function(e,t){return e.price>t.price}));break;case"RATING_L_H":e.sort((function(e,t){return e.rating<t.rating}));break;case"RATING_H_L":e.sort((function(e,t){return e.rating>t.rating}))}}})),R(e))}),[G,oe]),(0,l.useEffect)((function(){if((0,f.vd)(oe)){var e=Math.max.apply(Math,(0,n.Z)(oe.map((function(e){return e.price}))));e=10*Math.ceil(e/10),ue(e||100)}}),[oe]),(0,O.jsx)(h.Z,{noFooter:!0,showRibbion:!1,noPadding:!0,fluid:!0,containerClass:"explore",children:(0,O.jsxs)("div",{className:"explore__data",children:[(0,O.jsx)("div",{className:"explore__data__filter-panel-container","data-filter-open":q,children:(0,O.jsx)(x.Z,{maxPrice:ce,setFiltersPanelOpen:z,config:p.j,defaults:e,filters:G,setFilters:M})}),(0,O.jsxs)("div",{className:"explore__data__books","data-filter-open":q,children:[(0,O.jsxs)("div",{className:"explore__data__books__header",children:[(0,O.jsxs)("div",{className:"explore__data__books__header__filter",children:[(0,O.jsx)(y.Z,{type:"icon",onClick:function(){return z((function(e){return!e}))},children:(0,O.jsx)(g.r,{fill:q?"currentColor":"transparent"})}),(0,O.jsxs)("div",{className:"typo__body typo__color--n500",children:["Found ",(0,O.jsx)("span",{className:"typo__color--n700",style:{fontWeight:"500"},children:Z.length})," results"]})]}),(0,O.jsxs)("div",{className:"explore__data__books__header__layout",children:[(0,O.jsxs)(y.Z,{className:"account__data__books__header__layout__button typo__act",onClick:function(){return Q("LIST")},children:[(0,O.jsx)(j.r,{}),(0,O.jsx)("span",{children:"List"})]}),(0,O.jsxs)(y.Z,{className:"account__data__books__header__layout__button typo__act",onClick:function(){return Q("GRID")},children:[(0,O.jsx)(m.r,{}),(0,O.jsx)("span",{children:"GRID"})]})]})]}),(0,O.jsxs)("div",{className:"explore__data__books__wrapper","data-layout":K,children:[(0,f.fb)(Z)&&Z.length>0?function(){var e=[];return Z.forEach((function(n){e.push((0,O.jsx)(v.Z,{layout:K,book:n,onBuy:function(){return function(e){(0,w.Z)("event_explore_purchase_new"),H(!0),b.Z.purchaseNft(P,e.book_address,e.price.toString(),o.wallet.signer).then((function(t){r((0,u.e1)({show:!0,message:"Book purchased.",type:1}));var n=Number(t.events.filter((function(e){return"Transfer(address,address,uint256)"===e.eventSignature}))[0].args[2]._hex);s()({url:_._+"/api/book/purchase",method:"POST",data:{ownerAddress:P,bookAddress:e.book_address,tokenId:n}}).then((function(e){200!==e.status&&r((0,u.e1)("NOT200"))})).catch((function(e){r((0,u.e1)("ERROR"))})).finally((function(){return H(!1)})),s()({url:_._+"/api/book/copies",method:"POST",data:{bookAddress:e.book_address,copies:n}}).then((function(e){200!==e.status&&r((0,u.e1)("NOT200"))})).catch((function(e){r((0,u.e1)("ERROR"))}))})).catch((function(e){H(!1),4001===e.code?r((0,u.e1)({show:!0,message:"Transaction denied by user.",type:3})):r((0,u.e1)("ERROR"))}))}(n)},onOpen:function(){return function(e){(0,w.Z)("navigate_explore_book"),t("/book",{state:e})}(n)}},n.id))})),e}():(0,O.jsxs)("div",{className:"explore__data__books__wrapper__empty",children:[(0,O.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/fb06196e-29ca-4c59-9460-6fdbd43fa700/square240",alt:"books shelf",className:"explore__data__books__wrapper__image",loading:"lazy"}),(0,O.jsx)("h4",{className:"typo__head typo__head--4",children:"No eBooks yet"})]}),(0,O.jsx)("div",{className:"explore__data__books__wrapper__pagination",children:(0,O.jsx)(k.Z,{max:re,current:X,onPageChange:function(e){return $(e)}})})]})]})]})})}}}]);
//# sourceMappingURL=472.db62ad61.chunk.js.map