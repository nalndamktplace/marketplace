"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[27],{5972:function(e,t,a){a.d(t,{r:function(){return u}});var n,o,r,i,s=a(2791),l=["title","titleId"];function p(){return p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},p.apply(this,arguments)}function _(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}function c(e,t){var a=e.title,c=e.titleId,u=_(e,l);return s.createElement("svg",p({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":c},u),a?s.createElement("title",{id:c},a):null,n||(n=s.createElement("line",{x2:.02,transform:"translate(30 16)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),o||(o=s.createElement("rect",{width:32,height:32,rx:3,transform:"translate(8 8)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),r||(r=s.createElement("path",{d:"M4,19.67l8-8a4.029,4.029,0,0,1,6,0l10,10",transform:"translate(4 10.33)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),i||(i=s.createElement("path",{d:"M14,15.67l2-2a4.029,4.029,0,0,1,6,0l4,4",transform:"translate(14 12.33)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var u=s.forwardRef(c);a.p},7018:function(e,t,a){var n=a(2791),o=a(184);t.Z=function(e){var t=e.progress,a=(0,n.useRef)();return(0,n.useEffect)((function(){var e;null===a||void 0===a||null===(e=a.current)||void 0===e||e.style.setProperty("--progress",t)}),[t]),(0,o.jsx)("div",{className:"progressbar",children:(0,o.jsx)("div",{ref:a,className:"progressbar__value"})})}},6332:function(e,t,a){a.d(t,{d:function(){return n}});var n=["Children (0-14 years)","Youth (15-24 years)","Adults (25-64 years)","Seniors 65+"]},3483:function(e,t,a){a.d(t,{x:function(){return n}});var n=["Adventure","Art","Autobiography","Biography","Business","Children's","Children's History","Classics","Comics","Contemporary Fiction","Cookbooks","Crime Fiction","Drama","Dystopian","Essays","Family","Fantasy","Fiction","Food & Drink","Graphic Novels","Guide / How-To","Health","Historical Fiction","History","Horror","Humanities & Social Sciences","Humor","LGBTQ+","Literary Fiction","Magical Realism","Management","Memoir","Music","Mystery","New Adult","Parenting & Families","Personal Development","Philosophy","Photography","Poetry","Politics","Psychological Thrillers","Psychology","Relationships","Religion & Spirituality","Romance","Science","Science & Technology","Science Fiction","Self Help","Short Story","Society & Culture","Sports","Thriller","Travel","Women's Fiction","Young Adult"]},5771:function(e,t,a){a.d(t,{a:function(){return n}});var n=["EN - English","ZH - Chinese","DE - German","ES - Spanish","JA - Japanese","RU - Russian","FR - French","KO - Korean","IT - Italian","NL - Dutch","PT - Portugese","HI - Hindi","PL - Polish","DA - Danish","BN - Bangla"]},8027:function(e,t,a){a.r(t);var n=a(5861),o=a(1413),r=a(885),i=a(7757),s=a.n(i),l=a(4569),p=a.n(l),_=a(2426),c=a.n(_),u=a(6871),d=a(2791),h=a(6030),b=a(8979),f=a(3958),g=a(5899),m=a(733),v=a(4643),y=a(9316),k=a(4127),x=a(5454),w=a(7018),j=a(5972),Z=a(3483),S=a(5248),N=a(5771),E=a(6332),F=a(8669),C=a(184);t.default=function(e){var t=(0,h.I0)(),a=(0,u.s0)(),i=(0,h.v9)((function(e){return e.UserState})),l=(0,h.v9)((function(e){return e.WalletState})),_=(0,d.useState)(!1),O=(0,r.Z)(_,2),I=O[0],T=O[1],P=(0,d.useState)(null),L=(0,r.Z)(P,2),D=L[0],G=L[1],R=(0,d.useState)(null),H=(0,r.Z)(R,2),M=H[0],A=H[1],B=(0,d.useState)({name:"",author:"",cover:null,preview:null,book:null,genres:[],ageGroup:[],price:"",pages:"",publication:"",isbn:"",synopsis:"",language:"",published:"",secondarySalesDate:"",primarySales:"",idos:"",secondaryFrom:c()().add(1,"days")}),U=(0,r.Z)(B,2),W=U[0],J=U[1],Y=(0,d.useState)(0),z=(0,r.Z)(Y,2),V=z[0],K=z[1],q=(0,d.useState)(!0),Q=(0,r.Z)(q,2),X=Q[0],$=Q[1];function ee(){return(ee=(0,n.Z)(s().mark((function e(){var n,o,r,_,u,d,h,b,f,k,x,w,j,E;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=W.name,o=W.author,r=W.cover,_=W.book,u=W.genres,d=W.ageGroup,h=W.price,b=W.pages,f=W.publication,k=W.synopsis,x=W.language,w=W.published,W.idos,j=W.secondaryFrom,(0,y.fb)(n)&&(0,y.vd)(o)&&(0,y.fb)(r)&&(0,y.fb)(_)&&(0,y.fb)(u)&&(0,y.fb)(d)&&(0,y.fb)(h)&&(0,y.fb)(b)&&(0,y.fb)(k)&&(0,y.fb)(x)&&(0,y.fb)(w)&&(0,y.fb)(j)?((0,g.Z)("event_ito_publish_list"),T(!0),(E=new FormData).append("book",W.book),E.append("cover",W.cover),E.append("bookTitle",W.title),E.append("synopsis",W.synopsis),p()({url:S._+"/api/book/submarine",method:"POST",headers:{"user-id":i.user.uid,address:i.user.wallet,authorization:"Bearer ".concat(i.tokens.acsTkn.tkn)},data:E}).then((function(e){var i=e.data.book.url,s=e.data.cover.url,g=[];u.forEach((function(e){return g.push(Z.x.indexOf(e).toString())}));var E=N.a.indexOf(x).toString(),C=Math.round(c().duration(W.secondaryFrom-c()()).asDays());(0,y.fb)(E)&&(0,y.fb)(g)&&!isNaN(C)&&(0,y.vd)(n)&&(0,y.vd)(o)&&(0,y.fb)(r)&&(0,y.fb)(_)&&(0,y.vd)(b)?m.Z.listNftForSales(M,s,h,C,E,g,l.wallet.signer).then((function(e){var r=e.events.filter((function(e){return"OwnershipTransferred"===e.event}))[0].address,l=e.status,_=e.transactionHash;if((0,y.fb)(r)&&(0,y.fb)(l)&&1===l&&(0,y.fb)(_)){var c=new FormData;c.append("epub",W.preview),c.append("name",n),c.append("author",o),c.append("cover",s),c.append("coverFile",W.cover),c.append("book",i),c.append("genres",JSON.stringify(u.sort((function(e,t){return e>t})))),c.append("ageGroup",JSON.stringify(d.sort((function(e,t){return e>t})))),c.append("price",h),c.append("pages",b),c.append("publication",f),c.append("synopsis",k.replace(/<[^>]+>/g,"")),c.append("language",x),c.append("published",w),c.append("secondarySalesFrom",j),c.append("publisherAddress",M),c.append("bookAddress",r),c.append("txHash",_),p()({url:S._+"/api/book/publish",method:"POST",data:c}).then((function(e){200===e.status?((0,F.SR)("ito-publish-book-form-data"),T(!1),a("/library",{state:{tab:"published"}})):t((0,v.e1)("ERROR"))})).catch((function(e){(0,y.fb)(e.response)?413===e.response.status?t((0,v.e1)("LIMIT_FILE_SIZE")):415===e.response.status&&t((0,v.e1)("INVALID_FILE_TYPE")):t((0,v.e1)("NOT200")),T(!1)}))}else T(!1),(0,y.fb)(_)?t((0,v.e1)({show:!0,message:"The transaction to mint eBook failed.\ntxhash: ".concat(_),type:3})):t((0,v.e1)({show:!0,message:"The transaction to mint eBook failed.",type:3}))})).catch((function(e){t((0,v.e1)("NOT200")),T(!1)})):(t((0,v.e1)({show:!0,message:"Incomplete details",type:3})),T(!1))})).catch((function(e){(0,y.fb)(e.response)?413===e.response.status?t((0,v.e1)("LIMIT_FILE_SIZE")):415===e.response.status&&t((0,v.e1)("INVALID_FILE_TYPE")):t((0,v.e1)("NOT200")),T(!1)}))):t((0,v.e1)({show:!0,message:"Incomplete details",type:3}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,d.useEffect)((function(){(0,g.Z)("page_view_ito_publish")}),[]),(0,d.useEffect)((function(){(0,y.fb)(W.cover)&&G(URL.createObjectURL(W.cover))}),[W]),(0,d.useEffect)((function(){t(I?(0,k.yh)():(0,k.v3)())}),[I,t]),(0,d.useEffect)((function(){T(!0),(0,y.fb)(l.wallet.provider)&&A(l.wallet.address),T(!1)}),[l]),(0,d.useEffect)((function(){var e=["publication","isbn","primarySales","secondarySalesDate"],t=0,a=Object.keys(W).length;Object.keys(W).forEach((function(n){var o;if(e.includes(n))return a--;""!==W[n]&&0!==(null===(o=W[n])||void 0===o?void 0:o.length)&&null!==W[n]&&t++})),K(t/a)}),[W]),(0,d.useEffect)((function(){if(window.localStorage)try{(0,g.Z)("event_ito_publish_load_data");var e=JSON.parse(window.localStorage.getItem("ito-publish-book-form-data"));if(!(0,y.fb)(e))return void $(!1);J((0,o.Z)((0,o.Z)({},W),{},{name:e.name,author:e.author,genres:e.genres,ageGroup:e.ageGroup,price:e.price,pages:e.pages,publication:e.publication,synopsis:e.synopsis,language:e.language})),$(!1)}catch(t){$(!1)}}),[]),(0,d.useEffect)((function(){(0,g.Z)("event_ito_publish_save_data"),X||window.localStorage&&window.localStorage.setItem("ito-publish-book-form-data",JSON.stringify(W))}),[W,X]),(0,C.jsx)(b.Z,{noFooter:!0,containerClass:"publish publish__bg",children:(0,C.jsxs)("div",{className:"publish__data",children:[(0,C.jsxs)("div",{className:"publish__data__form utils__padding__bottom--s",children:[(0,C.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Publish ITO eBook"}),(0,C.jsx)(f.Z,{type:"string",label:"book name",value:W.name,onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{name:e.target.value}))},description:"Enter name of the book"}),(0,C.jsx)(f.Z,{type:"string",label:"book author",value:W.author,onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{author:e.target.value}))},description:"Enter name of the author"}),(0,C.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Upload Files"}),(0,C.jsx)(f.Z,{type:"file",label:"cover",accept:"image/*",onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{cover:e.target.files[0]}))},description:"Upload a picture of book cover. File types supported: JPG, PNG, GIF, SVG, WEBP"}),(0,C.jsx)(f.Z,{type:"file",label:"preview",accept:"application/epub+zip",onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{preview:e.target.files[0]}))},description:"Upload a sample of book for preview. File types supported: EPUB"}),(0,C.jsx)(f.Z,{type:"file",label:"book",accept:"application/epub+zip",onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{book:e.target.files[0]}))},description:"Upload a book. File types supported: EPUB"}),(0,C.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Meta Data"}),(0,C.jsx)(f.Z,{type:"number",label:"price in USDC",value:W.price,onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{price:e.target.value}))},description:"Price of book in USDC"}),(0,C.jsx)(f.Z,{type:"list",label:"genres",listType:"multiple",minLimit:1,maxLimit:5,values:Z.x,value:W.genres,onSave:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{genres:e}))},placeholder:"e.g., Action, Adventure",description:"Select genres for the book. Max 5 genres can be selected"}),(0,C.jsx)(f.Z,{type:"list",label:"age group",listType:"multiple",minLimit:1,maxLimit:E.d.length,values:E.d,value:W.ageGroup,onSave:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{ageGroup:e}))},placeholder:"e.g., Youth (15-24 years)",description:"Select the most appropriate age group for the book."}),(0,C.jsx)(f.Z,{type:"number",label:"number of print pages",value:W.pages,onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{pages:e.target.value}))},description:"Enter number of pages in the book"}),(0,C.jsx)(f.Z,{type:"string",label:"publication",value:W.publication,onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{publication:e.target.value}))},description:"Enter name of the publisher",required:!1}),(0,C.jsx)(f.Z,{type:"text",label:"synopsis",lines:8,value:W.synopsis,onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{synopsis:e.target.value}))},description:"Write a brief description about the book"}),(0,C.jsx)(f.Z,{type:"list",label:"language",listType:"single",values:N.a,value:W.language,onSave:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{language:e}))},description:"Select the language of the book"}),(0,C.jsx)(f.Z,{type:"date",label:"published",onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{published:e.target.value}))},description:"Enter when book was published"}),(0,C.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"ITO Details"}),(0,C.jsx)(f.Z,{type:"number",label:"initial distributed owners",min:500,max:1e3,onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{idos:e.target.value}))},description:"Number of people who can participate in Inital Title Offering"}),(0,C.jsx)(f.Z,{type:"date",label:"Secondary Market opens on",min:c()().add(90,"days"),max:c()().add(150,"days"),onChange:function(e){return J((0,o.Z)((0,o.Z)({},W),{},{secondaryFrom:e.target.value}))},description:"From when to start secondary sales"})]}),(0,C.jsx)("div",{className:"publish__data__preview",children:(0,C.jsxs)("div",{className:"publish__data__preview__container",children:[(0,C.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--n",children:"Preview"}),(0,C.jsxs)("div",{className:"publish__data__preview__book",onClick:function(){},children:[(0,C.jsx)("div",{className:"publish__data__preview__book__cover",children:(0,y.fb)(D)?(0,C.jsx)("img",{className:"publish__data__preview__book__cover__img",src:D,alt:W.name+" cover"}):(0,C.jsxs)("div",{className:"publish__data__preview__book__cover__placeholder",children:[(0,C.jsx)(j.r,{stroke:"currentColor"}),(0,C.jsx)("span",{className:"utils__margin__top--m",children:"Book Cover"})]})}),(0,C.jsxs)("div",{className:"publish__data__preview__book__data",children:[(0,C.jsx)("div",{className:"publish__data__preview__book__data__title  typo__head--5",children:W.name}),(0,C.jsx)("div",{className:"publish__data__preview__book__data__author typo__subtitle typo__color--n500",children:W.author}),W.price&&(0,C.jsx)("div",{className:"publish__data__preview__book__data__price typo__color--success",children:0===parseFloat(W.price)?"FREE":(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",W.price]})}),W.language&&(0,C.jsxs)("div",{className:"publish__data__preview__book__data__field",children:[(0,C.jsx)("div",{className:"publish__data__preview__book__data__field__label typo__body typo__color--n700",children:"Language"}),(0,C.jsx)("div",{className:"publish__data__preview__book__data__field__value typo__body typo__color--n500",children:W.language})]}),(0,y.vd)(W.genres)&&(0,C.jsxs)("div",{className:"publish__data__preview__book__data__field",children:[(0,C.jsx)("div",{className:"publish__data__preview__book__data__field__label typo__body typo__color--n700",children:"Genres"}),(0,C.jsx)("div",{className:"publish__data__preview__book__data__field__chips",children:W.genres.map((function(e){return(0,C.jsx)("div",{className:"publish__data__preview__book__data__field__chips__item typo__body",children:e},e)}))})]}),W.publication&&(0,C.jsxs)("div",{className:"publish__data__preview__book__data__field",children:[(0,C.jsx)("div",{className:"publish__data__preview__book__data__field__label typo__body typo__color--n700",children:"Publication"}),(0,C.jsx)("div",{className:"publish__data__preview__book__data__field__value typo__body typo__color--n500",children:W.publication})]})]})]}),(0,C.jsxs)("div",{className:"publish__data__preview__progress",children:[(0,C.jsxs)("div",{className:"publish__data__preview__progress__container",children:[(0,C.jsxs)("div",{className:"publish__data__preview__progress__container__value typo__color--n700",children:[Math.round(100*V),"%"]}),(0,C.jsx)(w.Z,{progress:V})]}),(0,C.jsx)(x.Z,{type:"primary",disabled:!1,size:"lg",onClick:function(){return function(){return ee.apply(this,arguments)}()},children:"Create ITO"})]})]})})]})})}}}]);
//# sourceMappingURL=27.a5b150c9.chunk.js.map