"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[501],{50906:function(e,t,n){n.d(t,{r:function(){return u}});var r,a,o=n(72791),s=["title","titleId"];function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function l(e,t){var n=e.title,l=e.titleId,u=i(e,s);return o.createElement("svg",c({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:t,"aria-labelledby":l},u),n?o.createElement("title",{id:l},n):null,r||(r=o.createElement("rect",{width:32,height:12,rx:2,transform:"translate(8 8)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),a||(a=o.createElement("rect",{width:32,height:12,rx:2,transform:"translate(8 28)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var u=o.forwardRef(l);n.p},6501:function(e,t,n){n.r(t);var r=n(93433),a=n(29439),o=n(74569),s=n.n(o),c=n(16871),i=n(72791),l=n(16030),u=n(44643),d=n(29316),f=n(4127),_=n(65248),h=n(50639),p=n(88952),b=n(43935),k=n(75454),y=n(56759),m=n(40354),v=n(72808),x=n(15602),g=n(50906),j=n(95899),w=n(54270),O=n(80184);t.default=function(){var e=[{key:"price",value:null,type:"range"},{key:"genres",value:[],type:"multiselect"},{key:"age_group",value:[],type:"multiselect"},{key:"orderby",value:null,type:"select"}],t=(0,c.TH)(),n=(0,c.s0)(),o=(0,l.I0)(),E=(0,l.v9)((function(e){return e.BWalletState})),N=(0,i.useState)(null),R=(0,a.Z)(N,2),Z=R[0],S=R[1],I=(0,i.useState)([]),T=(0,a.Z)(I,2),L=T[0],C=T[1],P=(0,i.useState)(null),A=(0,a.Z)(P,2),G=A[0],H=A[1],W=(0,i.useState)(e),B=(0,a.Z)(W,2),F=B[0],M=B[1],D=(0,i.useState)(!1),q=(0,a.Z)(D,2),z=q[0],V=q[1],Y=(0,i.useState)(!1),J=(0,a.Z)(Y,2),K=J[0],Q=J[1],U=(0,i.useState)(window.innerWidth<600?"LIST":"GRID"),X=(0,a.Z)(U,2),$=X[0],ee=X[1],te=(0,i.useState)([]),ne=(0,a.Z)(te,2),re=ne[0],ae=ne[1],oe=(0,i.useState)(100),se=(0,a.Z)(oe,2),ce=se[0],ie=se[1];return(0,i.useEffect)((function(){S(t.state)}),[t]),(0,i.useEffect)((function(){o(z?(0,f.yh)():(0,f.v3)())}),[z,o]),(0,i.useEffect)((function(){(0,d.fb)(Z)&&(V(!0),s()({url:_._+"/api/collections/books?cid="+Z.id,method:"GET"}).then((function(e){200===e.status?ae(e.data):o((0,u.e1)("NOT200"))})).catch((function(e){o((0,u.e1)("ERROR"))})).finally((function(){return V(!1)})))}),[o,Z]),(0,i.useEffect)((function(){V(!0),(0,d.fb)(E.smartAccount)&&H(E.smartAccount.address),V(!1)}),[E]),(0,i.useEffect)((function(){var e=re;(0,d.fb)(e)&&(F.forEach((function(t){switch(t.type){case"range":(0,d.fb)(t.value)&&(e=e.filter((function(e){return e[t.key]<=t.value})));break;case"multiselect":if((0,d.vd)(t.value)){var n=[];t.value.forEach((function(r){return e.forEach((function(e){e[t.key].indexOf(r)>-1&&n.filter((function(t){return t.id===e.id})).length<1&&n.push(e)}))})),e=n}break;case"select":if("orderby"===t.key)switch(t.value){case"PRICE_L_H":e.sort((function(e,t){return e.price<t.price}));break;case"PRICE_H_L":e.sort((function(e,t){return e.price>t.price}));break;case"RATING_L_H":e.sort((function(e,t){return e.rating<t.rating}));break;case"RATING_H_L":e.sort((function(e,t){return e.rating>t.rating}))}}})),C(e))}),[F,re]),(0,i.useEffect)((function(){if((0,d.vd)(re)){var e=Math.max.apply(Math,(0,r.Z)(re.map((function(e){return e.price}))));e=10*Math.ceil(e/10),ie(e||100)}}),[re]),(0,i.useEffect)((function(){(0,j.Z)("page_view_collection")}),[]),(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(w.q,{children:(0,O.jsx)("meta",{name:"Collection",content:"View your books collection"})}),(0,O.jsx)(p.Z,{noFooter:!0,showRibbion:!1,noPadding:!0,fluid:!0,containerClass:"explore",children:(0,O.jsxs)("div",{className:"explore__data",children:[(0,O.jsx)("div",{className:"explore__data__filter-panel-container","data-filter-open":K,children:(0,O.jsx)(m.Z,{maxPrice:ce,setFiltersPanelOpen:Q,config:h.j,defaults:e,filters:F,setFilters:M})}),(0,O.jsxs)("div",{className:"explore__data__books","data-filter-open":K,children:[(0,O.jsxs)("div",{className:"explore__data__books__header",children:[(0,O.jsxs)("div",{className:"explore__data__books__header__filter",children:[(0,O.jsx)(k.Z,{type:"icon",onClick:function(){return Q((function(e){return!e}))},children:(0,O.jsx)(v.r,{fill:K?"currentColor":"transparent"})}),(0,O.jsxs)("div",{className:"typo__color--n500",children:["Found ",(0,O.jsx)("span",{className:"typo__color--n700",style:{fontWeight:"500"},children:L.length})," results"]})]}),(0,O.jsxs)("div",{className:"explore__data__books__header__layout",children:[(0,O.jsxs)(k.Z,{className:"account__data__books__header__layout__button",onClick:function(){return ee("LIST")},children:[(0,O.jsx)(g.r,{}),(0,O.jsx)("span",{children:"List"})]}),(0,O.jsxs)(k.Z,{className:"account__data__books__header__layout__button",onClick:function(){return ee("GRID")},children:[(0,O.jsx)(x.r,{}),(0,O.jsx)("span",{children:"GRID"})]})]})]}),(0,O.jsx)("div",{className:"explore__data__books__wrapper","data-layout":$,children:(0,d.fb)(L)&&L.length>0?function(){var e=[];return L.forEach((function(t){e.push((0,O.jsx)(y.Z,{layout:$,book:t,onBuy:function(){return function(e){(0,j.Z)("event_collection_purchase_new"),V(!0),b.Z.purchaseNft(G,e.book_address,e.price.toString(),E.smartAccount.signer).then((function(t){o((0,u.e1)({show:!0,message:"Book purchased.",type:1}));var n=Number(t.events.filter((function(e){return"Transfer(address,address,uint256)"===e.eventSignature}))[0].args[2]._hex);s()({url:_._+"/api/book/purchase",method:"POST",data:{ownerAddress:G,bookAddress:e.book_address,tokenId:n}}).then((function(e){200!==e.status&&o((0,u.e1)("NOT200"))})).catch((function(e){o((0,u.e1)("ERROR"))})).finally((function(){return V(!1)})),s()({url:_._+"/api/book/copies",method:"POST",data:{bookAddress:e.book_address,copies:n}}).then((function(e){200!==e.status&&o((0,u.e1)("NOT200"))})).catch((function(e){o((0,u.e1)("ERROR"))}))})).catch((function(e){V(!1),4001===e.code?o((0,u.e1)({show:!0,message:"Transaction denied by user.",type:3})):o((0,u.e1)("ERROR"))}))}(t)},onOpen:function(){return function(e){(0,j.Z)("navigate_collection_book"),n("/book/".concat(e.id))}(t)}},t.id))})),e}():(0,O.jsxs)("div",{className:"explore__data__books__wrapper__empty",children:[(0,O.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/fb06196e-29ca-4c59-9460-6fdbd43fa700/square240",alt:"books shelf",className:"explore__data__books__wrapper__image",loading:"lazy"}),(0,O.jsx)("h4",{className:"typo__head typo__head--4",children:"No eBooks yet"})]})})]})]})})]})}}}]);
//# sourceMappingURL=501.d9e45ae7.chunk.js.map