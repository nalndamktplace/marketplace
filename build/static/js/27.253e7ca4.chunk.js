"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[27],{45972:(e,a,t)=>{t.d(a,{r:()=>p});var s,o,i,r,n=t(72791);function l(){return l=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},l.apply(this,arguments)}function _(e,a){let{title:t,titleId:_,...p}=e;return n.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:a,"aria-labelledby":_},p),t?n.createElement("title",{id:_},t):null,s||(s=n.createElement("line",{x2:.02,transform:"translate(30 16)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),o||(o=n.createElement("rect",{width:32,height:32,rx:3,transform:"translate(8 8)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),i||(i=n.createElement("path",{d:"M4,19.67l8-8a4.029,4.029,0,0,1,6,0l10,10",transform:"translate(4 10.33)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),r||(r=n.createElement("path",{d:"M14,15.67l2-2a4.029,4.029,0,0,1,6,0l4,4",transform:"translate(14 12.33)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}const p=n.forwardRef(_);t.p},7018:(e,a,t)=>{t.d(a,{Z:()=>i});var s=t(72791),o=t(80184);const i=e=>{let{progress:a}=e;const t=(0,s.useRef)();return(0,s.useEffect)((()=>{var e;null===t||void 0===t||null===(e=t.current)||void 0===e||e.style.setProperty("--progress",a)}),[a]),(0,o.jsx)("div",{className:"progressbar",children:(0,o.jsx)("div",{ref:t,className:"progressbar__value"})})}},46332:(e,a,t)=>{t.d(a,{d:()=>s});const s=["Children (0-14 years)","Youth (15-24 years)","Adults (25-64 years)","Seniors 65+"]},83483:(e,a,t)=>{t.d(a,{x:()=>s});const s=["Adventure","Art","Autobiography","Biography","Business","Children's","Children's History","Classics","Comics","Contemporary Fiction","Cookbooks","Crime Fiction","Drama","Dystopian","Essays","Family","Fantasy","Fiction","Food & Drink","Graphic Novels","Guide / How-To","Health","Historical Fiction","History","Horror","Humanities & Social Sciences","Humor","LGBTQ+","Literary Fiction","Magical Realism","Management","Memoir","Music","Mystery","New Adult","Parenting & Families","Personal Development","Philosophy","Photography","Poetry","Politics","Psychological Thrillers","Psychology","Relationships","Religion & Spirituality","Romance","Science","Science & Technology","Science Fiction","Self Help","Short Story","Society & Culture","Sports","Thriller","Travel","Women's Fiction","Young Adult"]},35771:(e,a,t)=>{t.d(a,{a:()=>s});const s=["EN - English","ZH - Chinese","DE - German","ES - Spanish","JA - Japanese","RU - Russian","FR - French","KO - Korean","IT - Italian","NL - Dutch","PT - Portugese","HI - Hindi","PL - Polish","DA - Danish","BN - Bangla"]},28027:(e,a,t)=>{t.r(a),t.d(a,{default:()=>E});var s=t(74569),o=t.n(s),i=t(72426),r=t.n(i),n=t(16871),l=t(72791),_=t(16030),p=t(54270),d=t(88952),c=t(61199),u=t(95899),h=t(43935),b=t(44643),m=t(29316),g=t(4127),v=t(75454),y=t(7018),f=t(45972),k=t(83483),x=t(65248),j=t(35771),w=t(46332),S=t(98669),N=t(80184);const E=e=>{const a=(0,_.I0)(),t=(0,n.s0)(),s=(0,_.v9)((e=>e.UserState)),i=(0,_.v9)((e=>e.BWalletState)),[E,F]=(0,l.useState)(!1),[C,T]=(0,l.useState)(null),[I,L]=(0,l.useState)(null),[P,Z]=(0,l.useState)({name:"",author:"",cover:null,preview:null,book:null,genres:[],ageGroup:[],price:"",pages:"",publication:"",isbn:"",synopsis:"",language:"",published:"",secondarySalesDate:"",primarySales:"",idos:"",secondaryFrom:r()().add(1,"days")}),[O,D]=(0,l.useState)(0),[A,G]=(0,l.useState)(!0);return(0,l.useEffect)((()=>{(0,u.Z)("page_view_ito_publish")}),[]),(0,l.useEffect)((()=>{(0,m.fb)(P.cover)&&T(URL.createObjectURL(P.cover))}),[P]),(0,l.useEffect)((()=>{a(E?(0,g.yh)():(0,g.v3)())}),[E,a]),(0,l.useEffect)((()=>{F(!0),(0,m.fb)(i.smartAccount)&&L(i.smartAccount.address),F(!1)}),[i]),(0,l.useEffect)((()=>{const e=["publication","isbn","primarySales","secondarySalesDate"];let a=0,t=Object.keys(P).length;Object.keys(P).forEach((s=>{var o;if(e.includes(s))return t--;""!==P[s]&&0!==(null===(o=P[s])||void 0===o?void 0:o.length)&&null!==P[s]&&a++})),D(a/t)}),[P]),(0,l.useEffect)((()=>{if(window.localStorage)try{(0,u.Z)("event_ito_publish_load_data");let e=JSON.parse(window.localStorage.getItem("ito-publish-book-form-data"));if(!(0,m.fb)(e))return void G(!1);Z({...P,name:e.name,author:e.author,genres:e.genres,ageGroup:e.ageGroup,price:e.price,pages:e.pages,publication:e.publication,synopsis:e.synopsis,language:e.language}),G(!1)}catch(e){G(!1)}}),[]),(0,l.useEffect)((()=>{(0,u.Z)("event_ito_publish_save_data"),A||window.localStorage&&window.localStorage.setItem("ito-publish-book-form-data",JSON.stringify(P))}),[P,A]),(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(p.q,{children:(0,N.jsx)("meta",{name:"ITO",content:""})}),(0,N.jsx)(d.Z,{noFooter:!0,containerClass:"publish publish__bg",children:(0,N.jsxs)("div",{className:"publish__data",children:[(0,N.jsxs)("div",{className:"publish__data__form utils__padding__bottom--s",children:[(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Publish ITO eBook"}),(0,N.jsx)(c.Z,{type:"string",label:"book name",value:P.name,onChange:e=>Z({...P,name:e.target.value}),description:"Enter name of the book"}),(0,N.jsx)(c.Z,{type:"string",label:"book author",value:P.author,onChange:e=>Z({...P,author:e.target.value}),description:"Enter name of the author"}),(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Upload Files"}),(0,N.jsx)(c.Z,{type:"file",label:"cover",accept:"image/*",onChange:e=>Z({...P,cover:e.target.files[0]}),description:"Upload a picture of book cover. File types supported: JPG, PNG, GIF, SVG, WEBP"}),(0,N.jsx)(c.Z,{type:"file",label:"preview",accept:"application/epub+zip",onChange:e=>Z({...P,preview:e.target.files[0]}),description:"Upload a sample of book for preview. File types supported: EPUB"}),(0,N.jsx)(c.Z,{type:"file",label:"book",accept:"application/epub+zip",onChange:e=>Z({...P,book:e.target.files[0]}),description:"Upload a book. File types supported: EPUB"}),(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Meta Data"}),(0,N.jsx)(c.Z,{type:"number",label:"price in USDC",value:P.price,onChange:e=>Z({...P,price:e.target.value}),description:"Price of book in USDC"}),(0,N.jsx)(c.Z,{type:"list",label:"genres",listType:"multiple",minLimit:1,maxLimit:5,values:k.x,value:P.genres,onSave:e=>Z({...P,genres:e}),placeholder:"e.g., Action, Adventure",description:"Select genres for the book. Max 5 genres can be selected"}),(0,N.jsx)(c.Z,{type:"list",label:"age group",listType:"multiple",minLimit:1,maxLimit:w.d.length,values:w.d,value:P.ageGroup,onSave:e=>Z({...P,ageGroup:e}),placeholder:"e.g., Youth (15-24 years)",description:"Select the most appropriate age group for the book."}),(0,N.jsx)(c.Z,{type:"number",label:"number of print pages",value:P.pages,onChange:e=>Z({...P,pages:e.target.value}),description:"Enter number of pages in the book"}),(0,N.jsx)(c.Z,{type:"string",label:"publication",value:P.publication,onChange:e=>Z({...P,publication:e.target.value}),description:"Enter name of the publisher",required:!1}),(0,N.jsx)(c.Z,{type:"text",label:"synopsis",lines:8,value:P.synopsis,onChange:e=>Z({...P,synopsis:e.target.value}),description:"Write a brief description about the book"}),(0,N.jsx)(c.Z,{type:"list",label:"language",listType:"single",values:j.a,value:P.language,onSave:e=>Z({...P,language:e}),description:"Select the language of the book"}),(0,N.jsx)(c.Z,{type:"date",label:"published",onChange:e=>Z({...P,published:e.target.value}),description:"Enter when book was published"}),(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"ITO Details"}),(0,N.jsx)(c.Z,{type:"number",label:"initial distributed owners",min:500,max:1e3,onChange:e=>Z({...P,idos:e.target.value}),description:"Number of people who can participate in Inital Title Offering"}),(0,N.jsx)(c.Z,{type:"date",label:"Secondary Market opens on",min:r()().add(90,"days"),max:r()().add(150,"days"),onChange:e=>Z({...P,secondaryFrom:e.target.value}),description:"From when to start secondary sales"})]}),(0,N.jsx)("div",{className:"publish__data__preview",children:(0,N.jsxs)("div",{className:"publish__data__preview__container",children:[(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--n",children:"Preview"}),(0,N.jsxs)("div",{className:"publish__data__preview__book",onClick:()=>{},children:[(0,N.jsx)("div",{className:"publish__data__preview__book__cover",children:(0,m.fb)(C)?(0,N.jsx)("img",{className:"publish__data__preview__book__cover__img",src:C,alt:P.name+" cover"}):(0,N.jsxs)("div",{className:"publish__data__preview__book__cover__placeholder",children:[(0,N.jsx)(f.r,{stroke:"currentColor"}),(0,N.jsx)("span",{className:"utils__margin__top--m",children:"Book Cover"})]})}),(0,N.jsxs)("div",{className:"publish__data__preview__book__data",children:[(0,N.jsx)("div",{className:"publish__data__preview__book__data__title  typo__head--5",children:P.name}),(0,N.jsx)("div",{className:"publish__data__preview__book__data__author typo__subtitle typo__color--n500",children:P.author}),P.price&&(0,N.jsx)("div",{className:"publish__data__preview__book__data__price typo__color--success",children:0===parseFloat(P.price)?"FREE":(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",P.price]})}),P.language&&(0,N.jsxs)("div",{className:"publish__data__preview__book__data__field",children:[(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__label typo__body typo__color--n700",children:"Language"}),(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__value typo__body typo__color--n500",children:P.language})]}),(0,m.vd)(P.genres)&&(0,N.jsxs)("div",{className:"publish__data__preview__book__data__field",children:[(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__label typo__body typo__color--n700",children:"Genres"}),(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__chips",children:P.genres.map((e=>(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__chips__item typo__body",children:e},e)))})]}),P.publication&&(0,N.jsxs)("div",{className:"publish__data__preview__book__data__field",children:[(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__label typo__body typo__color--n700",children:"Publication"}),(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__value typo__body typo__color--n500",children:P.publication})]})]})]}),(0,N.jsxs)("div",{className:"publish__data__preview__progress",children:[(0,N.jsxs)("div",{className:"publish__data__preview__progress__container",children:[(0,N.jsxs)("div",{className:"publish__data__preview__progress__container__value typo__color--n700",children:[Math.round(100*O),"%"]}),(0,N.jsx)(y.Z,{progress:O})]}),(0,N.jsx)(v.Z,{type:"primary",disabled:!1,size:"lg",onClick:()=>async function(){const{name:e,author:n,cover:l,book:_,genres:p,ageGroup:d,price:c,pages:g,publication:v,synopsis:y,language:f,published:w,idos:N,secondaryFrom:E}=P;if((0,m.fb)(e)&&(0,m.vd)(n)&&(0,m.fb)(l)&&(0,m.fb)(_)&&(0,m.fb)(p)&&(0,m.fb)(d)&&(0,m.fb)(c)&&(0,m.fb)(g)&&(0,m.fb)(y)&&(0,m.fb)(f)&&(0,m.fb)(w)&&(0,m.fb)(E)){(0,u.Z)("event_ito_publish_list"),F(!0);let N=new FormData;N.append("book",P.book),N.append("cover",P.cover),N.append("bookTitle",P.title),N.append("synopsis",P.synopsis),o()({url:x._+"/api/book/submarine",method:"POST",headers:{"user-id":s.user.uid,address:s.user.wallet,authorization:`Bearer ${s.tokens.acsTkn.tkn}`},data:N}).then((s=>{const u=s.data.book.url,N=s.data.cover.url;let C=[];p.forEach((e=>C.push(k.x.indexOf(e).toString())));const T=j.a.indexOf(f).toString(),L=Math.round(r().duration(P.secondaryFrom-r()()).asDays());(0,m.fb)(T)&&(0,m.fb)(C)&&!isNaN(L)&&(0,m.vd)(e)&&(0,m.vd)(n)&&(0,m.fb)(l)&&(0,m.fb)(_)&&(0,m.vd)(g)?h.Z.listNftForSales(I,N,c,L,T,C,i.smartAccount.signer).then((s=>{const i=s.events.filter((e=>"OwnershipTransferred"===e.event))[0].address,r=s.status,l=s.transactionHash;if((0,m.fb)(i)&&(0,m.fb)(r)&&1===r&&(0,m.fb)(l)){let s=new FormData;s.append("epub",P.preview),s.append("name",e),s.append("author",n),s.append("cover",N),s.append("coverFile",P.cover),s.append("book",u),s.append("genres",JSON.stringify(p.sort(((e,a)=>e>a)))),s.append("ageGroup",JSON.stringify(d.sort(((e,a)=>e>a)))),s.append("price",c),s.append("pages",g),s.append("publication",v),s.append("synopsis",y.replace(/<[^>]+>/g,"")),s.append("language",f),s.append("published",w),s.append("secondarySalesFrom",E),s.append("publisherAddress",I),s.append("bookAddress",i),s.append("txHash",l),o()({url:x._+"/api/book/publish",method:"POST",data:s}).then((e=>{200===e.status?((0,S.SR)("ito-publish-book-form-data"),F(!1),t("/library",{state:{tab:"published"}})):a((0,b.e1)("ERROR"))})).catch((e=>{(0,m.fb)(e.response)?413===e.response.status?a((0,b.e1)("LIMIT_FILE_SIZE")):415===e.response.status&&a((0,b.e1)("INVALID_FILE_TYPE")):a((0,b.e1)("NOT200")),F(!1)}))}else F(!1),(0,m.fb)(l)?a((0,b.e1)({show:!0,message:`The transaction to mint eBook failed.\ntxhash: ${l}`,type:3})):a((0,b.e1)({show:!0,message:"The transaction to mint eBook failed.",type:3}))})).catch((e=>{a((0,b.e1)("NOT200")),F(!1)})):(a((0,b.e1)({show:!0,message:"Incomplete details",type:3})),F(!1))})).catch((e=>{(0,m.fb)(e.response)?413===e.response.status?a((0,b.e1)("LIMIT_FILE_SIZE")):415===e.response.status&&a((0,b.e1)("INVALID_FILE_TYPE")):a((0,b.e1)("NOT200")),F(!1)}))}else a((0,b.e1)({show:!0,message:"Incomplete details",type:3}))}(),children:"Create ITO"})]})]})})]})})]})}}}]);
//# sourceMappingURL=27.253e7ca4.chunk.js.map