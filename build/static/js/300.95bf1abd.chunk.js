"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[300],{84300:(e,a,s)=>{s.r(a),s.d(a,{default:()=>ee});var _,t,o,r,d,i,n=s(74569),c=s.n(n),l=s(72426),h=s.n(l),m=s(16030),u=s(16871),b=s(72791),p=s(54270),k=s(88952),y=s(43935),v=s(4254),f=s(75454),j=s(90709),x=s(85807),g=s(46472),N=s(77107),w=s(89018),E=s(95899),R=s(29316),O=s(87928),A=s(9135);function T(){return T=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var _ in s)Object.prototype.hasOwnProperty.call(s,_)&&(e[_]=s[_])}return e},T.apply(this,arguments)}function S(e,a){let{title:s,titleId:n,...c}=e;return b.createElement("svg",T({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",ref:a,"aria-labelledby":n},c),s?b.createElement("title",{id:n},s):null,_||(_=b.createElement("path",{d:"M0,0H24V24H0Z",fill:"none"})),t||(t=b.createElement("path",{d:"M3,7v4a1,1,0,0,0,1,1H7",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),o||(o=b.createElement("path",{d:"M7,7V17",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),r||(r=b.createElement("path",{d:"M10,8v8a1,1,0,0,0,1,1h2a1,1,0,0,0,1-1V8a1,1,0,0,0-1-1H11A1,1,0,0,0,10,8Z",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),d||(d=b.createElement("path",{d:"M17,7v4a1,1,0,0,0,1,1h3",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})),i||(i=b.createElement("path",{d:"M21,7V17",fill:"none",stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2})))}const Z=b.forwardRef(S);s.p;var C=s(80184);const G=e=>{let{onOldBookPurchase:a,data:s}=e;const _=(0,m.v9)((e=>e.ModalState)),[t,o]=(0,b.useState)(!1),[r,d]=(0,b.useState)([]);return(0,b.useEffect)((()=>{window.document.documentElement.style.overflowY=t?"hidden":"auto"}),[t]),(0,b.useEffect)((()=>{!0===_.show&&_.type===O.m0?((0,E.Z)("modal_view_purchase"),o(!0)):o(!1)}),[_]),(0,b.useEffect)((()=>{if(!0===t&&(0,R.fb)(s)){const e=[];e.push(s),d(e)}}),[t,s]),(0,C.jsx)(w.Z,{show:t,children:(0,C.jsxs)("div",{className:(()=>{let e=["purchase purchase__wrapper"];return t?e.push("purchase__wrapper--open"):e.push("purchase__wrapper--close"),e.join(" ")})(),children:[(0,C.jsx)("div",{className:"purchase__wrapper__header",children:(0,C.jsx)("div",{className:"purchase__wrapper__header__close-button",children:(0,C.jsx)("div",{onClick:()=>o(!1),children:(0,C.jsx)(A.r,{width:20,height:20})})})}),(0,C.jsx)("div",{className:"purchase__wrapper__content",children:(0,C.jsx)("div",{className:"purchase__wrapper__content__options",children:(0,R.vd)(r)?(0,C.jsxs)("div",{className:"purchase__wrapper__content__options__item",onClick:()=>{a(s)},children:[(0,C.jsx)("p",{className:"typo__body utils__d__flex typo__align--center",children:"Buy Copy at"}),(0,C.jsx)("h5",{className:"typo__head typo__head--4 typo__transform--upper utils__d__flex utils__align__center",children:0===s.price?"FREE":(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:32,height:32,objectFit:"contain"},alt:"USDC"}),"\xa0",s.price]})})]}):(0,C.jsxs)("div",{className:"purchase__wrapper__content__options__item",children:[(0,C.jsx)("p",{className:"typo__body utils__d__flex typo__align--center",children:"No old copies available yet."}),(0,C.jsxs)("h5",{className:"typo__head typo__head--4 typo__transform--upper utils__d__flex utils__align__center",children:["\xa0",(0,C.jsx)(Z,{height:32,width:32})]})]})})})]})})};var B=s(40696),P=s(65248),L=s(44643),M=s(4127),F=s(37793),$=s(25897),I=s(23358),q=s(88465),D=s(33653),Y=s(40116),U=s(96744),W=s(7445),z=s(14998),V=s(88079),H=s(1692),K=s(7215),Q=s(65748),J=s(70476),X=s(298);const ee=e=>{const a=[{id:"TAB01",label:"Synopsis",icon:(0,C.jsx)(U.r,{})},{id:"TAB02",label:"reviews",icon:(0,C.jsx)(W.r,{})},{id:"TAB03",label:"quotes",icon:(0,C.jsx)(z.r,{})}],s=(0,u.UO)(),_=(0,m.I0)(),t=(0,u.s0)(),o=(0,F.Z)(),{address:r,loading:d,userInfo:i,connect:n,disconnect:l,getUserInfo:w,provider:A}=(0,X.dD)(),T=(0,m.v9)((e=>e.UserState)),S=(0,m.v9)((e=>e.BWalletState)),[Z,ee]=(0,b.useState)(null),[ae,se]=(0,b.useState)(!1),[_e,te]=(0,b.useState)("TAB01"),[oe,re]=(0,b.useState)(null),[de,ie]=(0,b.useState)(null),[ne,ce]=(0,b.useState)(null),[le,he]=(0,b.useState)(null),[me,ue]=(0,b.useState)(null),[be,pe]=(0,b.useState)(null),[ke,ye]=(0,b.useState)(null),[ve,fe]=(0,b.useState)(0),[je,xe]=(0,b.useState)(!1),[ge,Ne]=(0,b.useState)(0),[we,Ee]=(0,b.useState)(null),[Re,Oe]=(0,b.useState)([]),[Ae,Te]=(0,b.useState)(0),[Se,Ze]=(0,b.useState)({title:"",body:"",rating:0}),[Ce,Ge]=(0,b.useState)(null),[Be,Pe]=(0,b.useState)([]),[Le,Me]=(0,b.useState)({quote:""}),[Fe,$e]=(0,b.useState)(0),[Ie,qe]=(0,b.useState)(0),[De,Ye]=(0,b.useState)(0),Ue=(0,b.useRef)();(0,b.useEffect)((()=>{(0,E.Z)("page_view_book")}),[]),(0,b.useEffect)((()=>{"TAB01"===_e?(0,E.Z)("tab_view_book_synopsis"):"TAB02"===_e?(0,E.Z)("tab_view_book_reviews"):(0,E.Z)("tab_view_book_quotes")}),[_e]),(0,b.useEffect)((()=>{(0,R.fb)(oe)&&ce(1===oe.listed)}),[oe]);const We=(0,b.useCallback)((()=>{(0,R.fb)(oe)&&(se(!0),c()({url:`${P._}/api/book/reviews`,method:"GET",params:{bookAddress:oe.book_address}}).then((e=>{200===e.status?(Oe(e.data.reviews),Ne(e.data.rating),Te(e.data.total)):_((0,L.e1)("NOT200"))})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))}),[oe,_]),ze=(0,b.useCallback)((()=>{(0,R.fb)(oe)&&(0,R.fb)(Z)&&(se(!0),c()({url:`${P._}/api/book/reviewed`,method:"GET",params:{bookAddress:oe.book_address,ownerAddress:Z}}).then((e=>{200===e.status&&(0,R.UE)(e.data)&&Ee(e.data)})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))}),[oe,Z,_]),Ve=(0,b.useCallback)((()=>{(0,R.fb)(oe)&&(se(!0),c()({url:`${P._}/api/book/quotes`,method:"GET",params:{bookAddress:oe.book_address}}).then((e=>{200===e.status?Pe(e.data):204===e.status||_((0,L.e1)("NOT200"))})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))}),[oe,_]),He=(0,b.useCallback)((()=>{(0,R.fb)(oe)&&(0,R.fb)(Z)&&(se(!0),c()({url:`${P._}/api/book/quoted`,method:"GET",params:{bookAddress:oe.book_address,ownerAddress:Z}}).then((e=>{200===e.status&&(0,R.UE)(e.data)&&Ge(e.data)})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))}),[oe,Z,_]);(0,b.useEffect)((()=>{We()}),[We]),(0,b.useEffect)((()=>{ze()}),[ze]),(0,b.useEffect)((()=>{Ve()}),[Ve]),(0,b.useEffect)((()=>{He()}),[He]),(0,b.useEffect)((()=>{(0,R.fb)(oe)&&(se(!0),c()({url:`${P._}/api/book/likes`,method:"GET",params:{bookAddress:oe.book_address}}).then((e=>{200===e.status?fe(e.data.likes):_((0,L.e1)("NOT200"))})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))}),[oe,_]),(0,b.useEffect)((()=>{(0,R.fb)(oe)&&(0,R.fb)(Z)&&(se(!0),c()({url:`${P._}/api/book/liked`,method:"GET",params:{bookAddress:oe.book_address,ownerAddress:Z}}).then((e=>{200===e.status&&xe(e.data.liked)})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))}),[oe,Z,_]),(0,b.useEffect)((()=>{(0,R.fb)(oe)&&(se(!0),c()({url:`${P._}/api/reader/total-reader-count`,method:"GET",params:{bookAddress:oe.book_address}}).then((e=>{200===e.status&&$e(e.data.total_readers)})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))}),[oe,_]),(0,b.useEffect)((()=>{(0,R.fb)(oe)&&(se(!0),c()({url:`${P._}/api/reader/count`,method:"GET",params:{bookAddress:oe.book_address}}).then((e=>{200===e.status&&qe(e.data.reader_count)})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))}),[oe,_]),(0,b.useEffect)((()=>{(0,R.fb)(oe)&&(se(!0),c()({url:`${P._}/api/reader/total-read-time`,method:"GET",params:{bookAddress:oe.book_address}}).then((e=>{200===e.status&&Ye(e.data.total_read_time)})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))}),[oe,_]),(0,b.useEffect)((()=>{se(!0),(0,R.fb)(S.smartAccount)&&ee(S.smartAccount.address),se(!1)}),[S]),(0,b.useEffect)((()=>{(0,R.fb)(we)&&Ze({title:we.title,body:we.body,rating:we.rating})}),[we]),(0,b.useEffect)((()=>{const e=s.bookID;c()({url:`${P._}/api/book/listedbook`,method:"GET",params:{bookID:e}}).then((e=>{re(e.data.book),ye(e.data.secondary_book)}))}),[s]),(0,b.useEffect)((()=>{if((0,R.fb)(Z)){se(!0);const e=oe;e.new_owner===Z?ie(!0):ie(!1),e.publisher_address===Z?ue(!0):ue(!1),c()({url:P._+"/api/book/owner",method:"GET",params:{ownerAddress:Z,bookAddress:e.book_address}}).then((e=>{200===e.status&&ie(!0)})).catch((e=>{})).finally((()=>se(!1)))}}),[oe,s,_,Z]),(0,b.useEffect)((()=>{(0,R.fb)(oe)&&(0,R.fb)(me)&&(0,R.fb)(de)&&se(!1)}),[oe,me,de]),(0,b.useEffect)((()=>{_(ae?(0,M.yh)():(0,M.v3)())}),[ae,_]),(0,b.useEffect)((()=>{let e=document.getElementById("BOOK_PAGE_"+_e);(0,R.fb)(e)&&(0,R.fb)(Ue.current)&&Ue.current.style.setProperty("--marker-x",e.offsetLeft)}),[_e]),(0,b.useEffect)((()=>{de&&c()({url:`${P._}/api/user/book`,method:"GET",headers:{"user-id":T.user.uid,address:S.smartAccount.address,authorization:`Bearer ${T.tokens.acsTkn.tkn}`},params:{walletAddress:S.smartAccount.address,bookAddress:oe.book_address}}).then((e=>{200===e.status?(he(e.data),ce(e.data.listed)):_((0,L.e1)("NOT200"))})).catch((e=>{_((0,L.e1)("ERROR"))}))}),[de,T,S,_,oe]);const Ke=()=>{if((0,R.fb)(S.smartAccount))return ee(S.smartAccount.address),!0;r||(async()=>{n()})(),(0,B.Z)(A,_)},Qe=async()=>{(0,E.Z)("event_book_read"),se(!0);try{c()({url:`${P._}/api/verify`,method:"GET",params:{bookAddress:oe.book_address,ownerAddress:Z}}).then((e=>{if(200===e.status){const a=e.data;B.Z.signMessage(S.smartAccount.signer,JSON.stringify(a)).then((e=>{!0===e.isValid?c()({url:P._+"/api/verify",method:"POST",headers:{address:S.smartAccount.address,"user-id":T.user.uid,authorization:`Bearer ${T.tokens.acsTkn.tkn}`},data:{accountAddress:Z,bookAddress:oe.book_address,signedData:e.signedData,cid:oe.book.slice(oe.book.lastIndexOf("/")+1)}}).then((e=>{200===e.status?((0,E.Z)("navigate_book_reader"),t("/library/reader",{state:{book:{...oe,url:e.data.url},preview:!1}})):_((0,L.e1)({show:!0,message:"Error",type:4}))})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1))):_((0,L.e1)({show:!0,message:"Could not verify the authenticity of the signature.",type:3}))}))}else _((0,L.e1)("NOT200"))}))}catch(e){se(!1)}};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(p.q,{children:(0,C.jsx)("meta",{name:"Listed Books",content:""})}),(0,C.jsxs)(k.Z,{children:[(0,C.jsx)("div",{className:"book__bg",children:(0,C.jsx)("img",{src:$.Z,alt:"background",loading:"lazy"})}),(0,R.fb)(oe)?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)("div",{className:"book__data",children:[(0,C.jsx)("div",{className:"book__data__background"}),(0,C.jsxs)("div",{className:"book__data__container",children:[(0,C.jsxs)("div",{children:[(0,C.jsx)("div",{className:"book__data__container__cover",children:(0,C.jsx)("img",{className:"book__data__container__cover__image",src:oe.cover_display_url?oe.cover_display_url:oe.cover_public_url?oe.cover_public_url:oe.cover,alt:oe.name})}),(0,C.jsxs)("div",{className:"book__data__container__meta",children:[(0,C.jsx)("h3",{className:"typo__color--n700 typo__head typo__head--3 typo__transform--capital",children:oe.title}),(0,C.jsx)("h5",{className:"typo__color--n500 typo__head typo__head--6 typo__transform--upper",children:oe.author}),de||me?null:(0,C.jsx)("div",{className:"book__data__container__meta__price typo-head--6 typo__act typo__color--success",children:0===ke.price?"FREE":(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",ke.price]})}),(0,C.jsxs)("div",{className:"book__data__container__meta__rating",children:[(0,C.jsx)("div",{className:"book__data__container__meta__rating__stars",children:(0,C.jsx)(v.Z,{size:"small",rating:ge})}),(0,C.jsxs)("div",{className:"book__data__container__meta__rating__count typo__body",children:[Ae," reviews"]})]}),(0,C.jsx)("div",{className:"book__data__container__meta__cta",children:ne?(0,C.jsx)(f.Z,{type:"primary",size:"lg",onClick:()=>((0,E.Z)("event_book_unlist"),void((0,R.fb)(Z)&&(se(!0),c()({url:P._+"/api/user/book/listed",method:"GET",headers:{"user-id":T.user.uid,authorization:`Bearer ${T.tokens.acsTkn.tkn}`},params:{ownerAddress:Z,tokenId:le.token_id,bookAddress:oe.book_address}}).then((e=>{if(200===e.status){se(!0);const a=e.data.order_id;y.Z.unlistBookFromMarketplace(a,S.smartAccount.signer).then((e=>{se(!0),c()({url:P._+"/api/book/unlist",method:"POST",data:{ownerAddress:Z,bookAddress:oe.book_address}}).then((e=>{200===e.status?(ce(!1),_((0,O.VG)()),_((0,L.e1)({show:!0,message:"Book unlisted from marketplace.",type:1})),t("/")):_((0,L.e1)("NOT200"))})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>{se(!1)}))})).catch((e=>{se(!1),(0,R.fb)(e.reason)?e.reason.includes("NFT not yet listed / already sold")&&_((0,L.e1)({show:!0,message:"eBook already sold or not listed.",type:3})):_((0,L.e1)("ERROR"))}))}else _((0,L.e1)("NOT200"))})).catch((e=>{se(!1),_((0,L.e1)("ERROR"))}))))),children:"Unlist"}):me?(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(f.Z,{type:"primary",size:"lg",onClick:()=>Qe(),children:"Read"})}):de?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(f.Z,{type:"primary",size:"lg",onClick:()=>Qe(),children:"Read"}),(0,C.jsx)(f.Z,{onClick:()=>(_((0,O.K4)(O.gG)),void(h()(oe.secondary_sales_from).isSame(h()())||h()(oe.secondary_sales_from).isBefore(h()())?_((0,O.K4)(O.gG)):h()(oe.secondary_sales_from).isAfter(h()())&&_((0,L.e1)({show:!0,message:`Secondary Sales will open only after ${h()(oe.secondary_sales_from).format("D MMM, YYYY")}.`,type:2})))),children:"List"})]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(f.Z,{type:"primary",size:"lg",onClick:()=>_(o?(0,O.K4)(O.m0):(0,L.e1)("NOT_LOGGED_IN")),children:"Buy Now"}),(0,C.jsx)(f.Z,{onClick:()=>((0,E.Z)("navigate_book_preview"),void t("/book/preview",{state:{book:oe,preview:!0}})),children:"Preview"})]})})]})]}),(0,C.jsxs)("div",{className:"book__data__container__desc",children:[(0,C.jsx)("div",{className:"book__data__container__desc__left",children:(0,C.jsxs)("div",{className:"book__data__container__desc__summary",children:[(0,C.jsxs)("div",{className:"book__data__container__desc__summary__contract",children:[(0,C.jsxs)("div",{className:"book__data__container__desc__summary__contract__data",children:[(0,C.jsx)("div",{className:"book__data__container__desc__summary__contract__label typo__color--n700",children:"Contract Address"}),(0,C.jsxs)("div",{className:"book__data__container__desc__summary__contract__value typo__color--n500",onClick:()=>window.open(`https://mumbai.polygonscan.com/address/${oe.book_address}`,"_blank"),children:[(oe.book_address||"").slice(0,12),"\u2026",(oe.book_address||"").slice((oe.contract||"").length-10)]})]}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__contract__icon",children:(0,C.jsx)(V.r,{width:24,height:24})})]}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"DA Score"}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__data",children:ke.da_score}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Token ID"}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__data",children:ke.token_id}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Genres"}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__chips typo__transform--capital",children:JSON.parse(oe.genres).map((e=>(0,C.jsx)("div",{className:"book__data__container__desc__summary__chips__item",children:e})))}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__head typo__color--n700",children:"Prefered Age Group"}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__chips typo__transform--capital",children:JSON.parse(oe.age_group).map((e=>(0,C.jsx)("div",{className:"book__data__container__desc__summary__chips__item",children:e})))}),(0,C.jsxs)("div",{className:"book__data__container__desc__summary__grid typo__color--n700",children:[(0,C.jsxs)("div",{className:"book__data__container__desc__summary__grid__item",children:[(0,C.jsx)(H.r,{}),(0,C.jsx)("div",{className:"book__data__container__desc__summary__grid__item__data",children:oe.language})]}),(0,C.jsxs)("div",{className:"book__data__container__desc__summary__grid__item",children:[(0,C.jsx)(J.r,{}),(0,C.jsxs)("div",{className:"book__data__container__desc__summary__grid__item__data",children:[Fe," readers"]})]}),(0,C.jsxs)("div",{className:"book__data__container__desc__summary__grid__item",children:[(0,C.jsx)(K.r,{}),(0,C.jsxs)("div",{className:"book__data__container__desc__summary__grid__item__data",children:[Ie," people reading"]})]}),(0,C.jsxs)("div",{className:"book__data__container__desc__summary__grid__item",children:[(0,C.jsx)(Q.r,{}),(0,C.jsxs)("div",{className:"book__data__container__desc__summary__grid__item__data",children:[Math.ceil(De/60)," minutes"]})]})]})]})}),(0,C.jsxs)("div",{className:"book__data__container__desc__right",children:[(0,C.jsxs)("div",{className:"book__data__container__desc__interacts",children:[(0,C.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,C.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Likes"}),(0,C.jsx)(I.r,{width:24,height:24,className:"book__data__container__desc__interacts__item__icon",stroke:je?"#ff5722":"currentColor",fill:je?"#ff5722":"transparent",onClick:()=>{Ke()?de?(je?(fe((e=>e-1)),(0,E.Z)("event_book_unlike")):(fe((e=>e+1)),(0,E.Z)("event_book_like")),c()({url:`${P._}/api/book/likes`,method:"POST",data:{bookAddress:oe.book_address,ownerAddress:Z,likedState:!je}}).then((e=>{200===e.status?xe((e=>!e)):_((0,L.e1)("NOT200"))})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1)))):_((0,L.e1)({show:!0,message:"Only owners can like a book.",type:3})):_((0,L.e1)({show:!0,message:"Please login first.",type:3}))}}),(0,C.jsx)("div",{className:"typo__head--5 typo__color--n600",children:ve||"0"})]}),(0,C.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,C.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Reviews"}),(0,C.jsx)(W.r,{width:24,height:24,stroke:"currentColor"}),(0,C.jsx)("div",{className:"typo__head--5 typo__color--n600",children:Ae||"0"})]}),(0,C.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,C.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Pages"}),(0,C.jsx)(q.r,{width:24,height:24,stroke:"currentColor"}),(0,C.jsx)("div",{className:"typo__head--5 typo__color--n600",children:oe.print||"00"})]}),(0,C.jsxs)("div",{className:"book__data__container__desc__interacts__item",children:[(0,C.jsx)("div",{className:"typo__subtitle typo__color--n500",children:"Sold"}),(0,C.jsx)(Y.r,{width:24,height:24,stroke:"currentColor"}),(0,C.jsx)("div",{className:"typo__head--5 typo__color--n600",children:oe.copies||"00"})]})]}),(0,C.jsxs)("div",{className:"book__data__container__desc__tabs",children:[(0,C.jsx)("div",{ref:Ue,className:"book__data__container__desc__tabs__container",children:(()=>{let e=[];return a.forEach((a=>{e.push((0,C.jsxs)("div",{onClick:()=>te(a.id),id:"BOOK_PAGE_"+a.id,className:a.id===_e?"book__data__container__desc__tabs__container__item book__data__container__desc__tabs__container__item--active":"book__data__container__desc__tabs__container__item utils__cursor--pointer",children:[(0,R.fb)(a.icon)&&a.icon,(0,C.jsx)("h5",{className:"typo__head typo__head--6 typo__transform--capital",children:a.label})]},a.id))})),e})()}),(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data",children:(()=>{switch(_e){case"TAB01":return(0,C.jsx)("p",{className:"typo--break-spaces typo__body typo__color--n600",children:oe.synopsis});case"TAB02":const e=e=>{let a=[];return(0,R.vd)(e)&&e.forEach((e=>a.push((0,C.jsxs)("div",{className:"book__data__container__desc__tabs__data__reviews__item",children:[(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__reviews__item__header__head typo__head typo__head--6",children:e.title}),(0,C.jsxs)("div",{className:"book__data__container__desc__tabs__data__reviews__item__header",children:[(0,C.jsx)(v.Z,{rating:e.rating,size:"small"}),(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__reviews__item__header__time typo__color--n500",children:h()(e.reviewed_at).format("D MMM, YYYY")})]}),(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__reviews__item__body typo__body typo__body--2",children:e.body})]})))),a};return(0,C.jsxs)(b.Fragment,{children:[!(0,R.fb)(we)&&de?(0,C.jsxs)("div",{className:"book__data__container__desc__tabs__data__action",children:[(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__action__icon",children:(0,C.jsx)(W.r,{width:32,height:32,stroke:"currentColor"})}),(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__action__label typo__head--6",children:"Write a Review"}),(0,C.jsx)(f.Z,{type:"primary",onClick:()=>_(o?(0,O.K4)(O.wW):(0,L.e1)("NOT_LOGGED_IN")),children:"Review"})]}):null,(0,C.jsxs)("div",{className:"book__data__container__desc__tabs__data__reviews",children:[e(Re),0===(null===Re||void 0===Re?void 0:Re.length)?(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__empty",children:"No Reviews"}):""]})]});case"TAB03":const a=e=>{let a=[];return e.forEach(((e,s)=>{a.push((0,C.jsxs)("div",{className:"book__data__container__desc__tabs__data__quotes__item",children:[(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__quotes__item__icon",children:(0,C.jsx)(D.r,{width:32,height:32,fill:"currentColor"})}),(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__quotes__item__body typo__body",children:e.body}),(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__quotes__item__time typo__cap typo__cap--2",children:h()(e.created_at).format("D MMM, YYYY")||"-"})]},s))})),a};return(0,C.jsxs)(b.Fragment,{children:[(0,R.fb)(Ce)||!me&&!de?null:(0,C.jsxs)("div",{className:"book__data__container__desc__tabs__data__action",children:[(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__action__icon",children:(0,C.jsx)(z.r,{width:32,height:32,stroke:"currentColor"})}),(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__action__label typo__head--6",children:"Write a Quote"}),(0,C.jsx)(f.Z,{type:"primary",onClick:()=>_(o?(0,O.K4)(O.D4):(0,L.e1)("NOT_LOGGED_IN")),children:"Quote"})]}),(0,C.jsxs)("div",{className:"book__data__container__desc__tabs__data__quotes",children:[a(Be),0===(null===Be||void 0===Be?void 0:Be.length)?(0,C.jsx)("div",{className:"book__data__container__desc__tabs__data__empty",children:"No Quotes"}):""]})]})}})()})]})]})]})]})]}),(0,C.jsx)(G,{data:ke,onOldBookPurchase:e=>(e=>{(0,E.Z)("event_book_purchase_old"),Ke()&&(se(!0),y.Z.buyListedCover(e.order_id,e.price,S.smartAccount.signer).then((a=>{c()({url:P._+"/api/book/purchase/secondary",method:"POST",data:{newOwnerAddress:Z,previousOwnerAddress:e.previous_owner,bookAddress:e.book_address,tokenId:e.token_id,purchasePrice:e.price,orderId:e.order_id,daScore:e.da_score}}).then((e=>{200===e.status?(_((0,O.VG)()),ie(!0)):_((0,L.e1)("NOT200"))})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>se(!1)))})).catch((e=>{se(!1)})))})(e)}),(0,C.jsx)(j.Z,{book:oe,userCopy:le,onListHandler:e=>(e=>{(0,E.Z)("event_book_list"),(0,R.fb)(Z)&&(se(!0),y.Z.listBookToMarketplace(oe.book_address,le.token_id,e,S.smartAccount.signer).then((a=>{se(!0);const s=parseInt(a.events.filter((e=>"CoverListed"===e.event))[0].args[0]._hex);c()({url:P._+"/api/book/list",method:"POST",data:{ownerAddress:Z,bookAddress:oe.book_address,bookPrice:e,bookOrderId:s,bookTokenId:le.token_id}}).then((e=>{200===e.status?(ce(!0),_((0,O.VG)()),_((0,L.e1)({show:!0,message:"Book listed on marketplace.",type:1})),e.data&&(pe(e.data),_((0,O.K4)(O.Sh)))):_((0,L.e1)("NOT200"))})).catch((e=>{_((0,L.e1)("ERROR"))})).finally((()=>{se(!1)}))})).catch((e=>{(0,R.fb)(e.reason)?e.reason.includes("Can't list the cover at this time")?_((0,L.e1)({show:!0,message:"Please wait for some more time before listing the book.",type:3})):e.reason.includes("Listing for this book is disabled")?_((0,L.e1)({show:!0,message:"Listing this book is not allowed right now. Please try again later.",type:3})):e.reason.includes("Seller should own the NFT to list")&&_((0,L.e1)({show:!0,message:"Book is already listed. Please contact us on support@nalnda.com",type:3})):_((0,L.e1)("ERROR"))})).finally((()=>se(!1))))})(e)}),(0,C.jsx)(g.Z,{ReviewForm:Se,setReviewForm:Ze,reviewHandler:()=>{(0,E.Z)("event_book_review"),(0,R.fb)(Z)?(0,R.UE)(Se.body)&&(0,R.UE)(Se.rating)&&(0,R.UE)(Se.title)?(se(!0),c()({url:`${P._}/api/book/reviews`,method:"POST",data:{review:{...Se},bookAddress:oe.book_address,ownerAddress:Z}}).then((e=>{200===e.status?(_((0,O.VG)()),ze(),We()):_((0,L.e1)("NOT200"))})).catch((e=>{se(!1),_((0,L.e1)("ERROR"))}))):_((0,L.e1)({show:!0,message:"Please fill the review.",type:3})):_((0,L.e1)({show:!0,message:"Please login first",type:3}))}}),(0,C.jsx)(x.Z,{QuotesForm:Le,setQuotesForm:Me,quoteHandler:()=>{(0,E.Z)("event_book_quote"),(0,R.fb)(Z)?(0,R.UE)(Le.quote)?(se(!0),c()({url:`${P._}/api/book/quotes`,method:"POST",data:{quote:{body:Le.quote},bookAddress:oe.book_address,ownerAddress:Z}}).then((e=>{200===e.status?(_((0,O.VG)()),He(),Ve()):_((0,L.e1)("NOT200"))})).catch((e=>{se(!1),_((0,L.e1)("ERROR"))}))):_((0,L.e1)({show:!0,message:"Please enter the quote.",type:3})):_((0,L.e1)({show:!0,message:"Please login first",type:3}))}}),(0,C.jsx)(N.Z,{bookID:be})]}):null]})]})}}}]);
//# sourceMappingURL=300.95bf1abd.chunk.js.map