{"version":3,"file":"static/js/680.935b3289.chunk.js","mappings":"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","sources":["components/modal/Search/SearchModal.jsx","pages/Explore.jsx"],"sourcesContent":["import { useNavigate } from 'react-router'\nimport { useDispatch, useSelector } from 'react-redux'\nimport React, { useEffect, useState } from 'react'\n\nimport Button from '../../ui/Buttons/Button'\nimport Backdrop from '../../hoc/Backdrop/Backdrop'\n\nimport { hideModal, SHOW_SEARCH_MODAL } from '../../../store/actions/modal'\n\nimport { ReactComponent as CloseIcon } from '../../../assets/icons/close-icon.svg'\nimport { ReactComponent as SearchIcon } from '../../../assets/icons/search.svg'\n\nimport { isFilled } from '../../../helpers/functions'\nimport { BASE_URL } from '../../../config/env'\nimport axios from 'axios'\nimport { setSnackbar } from '../../../store/actions/snackbar'\nimport { hideSpinner, showSpinner } from '../../../store/actions/spinner'\n\nconst Modal = ({\n    title = '',\n    open = false,\n    toggleModal,\n    children,\n    cancellable,\n}) => {\n    const dispatch = useDispatch()\n\n    useEffect(() => {\n        window.document.documentElement.style.overflowY = open\n            ? 'hidden'\n            : 'auto'\n    }, [open])\n\n    const getClasses = () => {\n        let classes = ['modal_search__wrapper']\n        if (open) classes.push('modal__wrapper--open')\n        else classes.push('modal__wrapper--close')\n        return classes.join(' ')\n    }\n\n    return (\n        <Backdrop show={open} hideOnClick={true}>\n            <div className={getClasses()}>\n                <div className=\"modal_search__header\">\n                    <div className=\"modal__wrapper__header__title typo__head--6\">\n                        {title}\n                    </div>\n                    <div className=\"modal__wrapper__header__close-button\">\n                        {cancellable ? (\n                            <Button\n                                type=\"icon\"\n                                className=\"modal_search__wrapper__close-icon\"\n                                onClick={() => dispatch(hideModal())}\n                            >\n                                <CloseIcon />\n                            </Button>\n                        ) : null}\n                    </div>\n                </div>\n                <div className=\"modal_search__content\">{children}</div>\n            </div>\n        </Backdrop>\n    )\n}\n\nconst SearchModal = () => {\n    const dispatch = useDispatch()\n    const navigate = useNavigate()\n\n    const ModalState = useSelector((state) => state.ModalState)\n    const [Loading, setLoading] = useState(false)\n    const [Show, setShow] = useState(false)\n    const [SearchResults, setSearchResults] = useState([])\n    const [SearchQuery, setSearchQuery] = useState('')\n\n    useEffect(() => {\n        if (SearchQuery.length > 3 && SearchQuery.length < 16) {\n            setLoading(true)\n            axios({\n                url: BASE_URL + '/api/book/search',\n                method: 'GET',\n                params: { query: SearchQuery },\n            })\n                .then((res) => {\n                    if (res.status === 200) setSearchResults(res.data)\n                    else dispatch(setSnackbar('NOT200'))\n                })\n                .catch((err) => {\n                    dispatch(setSnackbar('ERROR'))\n                })\n                .finally(() => setLoading(false))\n        }\n    }, [dispatch, SearchQuery])\n\n    useEffect(() => {\n        if (ModalState.show === true && ModalState.type === SHOW_SEARCH_MODAL) {\n            setShow(true)\n        } else setShow(false)\n    }, [ModalState])\n\n    useEffect(() => {\n        if(Loading) dispatch(showSpinner())\n        else dispatch(hideSpinner())\n    }, [Loading, dispatch])\n\n    const modalCloseHandler = (state) => {\n        if (state === false) dispatch(hideModal())\n    }\n\n    const getSearchResultsClasses = () => {\n        let classes = ['modal_search__options']\n        if (isFilled(SearchQuery) && SearchQuery.length > 3)\n            classes.push('dropdown__options--open')\n        return classes.join(' ')\n    }\n\n    const renderSearchResults = () => {\n        let searchResultsDOM = []\n        if (isFilled(SearchResults))\n            SearchResults.forEach((result) => {\n                searchResultsDOM.push(\n                    <div\n                        onClick={() => {\n                            navigate('/book', { state: result })\n                            setSearchQuery('')\n                        }}\n                        className=\"header__content__search__result\"\n                        key={result.id}\n                    >\n                        <img\n                            src={\n                                result.cover_public_url\n                                    ? result.cover_public_url\n                                    : result.cover\n                            }\n                            alt={result.title + \"'s Cover\"}\n                            className=\"header__content__search__result__cover\"\n                            loading=\"lazy\"\n                        />\n                        <div className=\"header__content__search__result__info\">\n                            <div className=\"header__content__search__result__info__name typo__head typo__subtitle typo__transform--capital\">\n                                {result.title}\n                            </div>\n                            <div className=\"header__content__search__result__info__author typo__subtitle typo__subtitle--2 typo__transform--upper\">\n                                {result.author}\n                            </div>\n                            <div className=\"index__collection__books__item__data__price typo__act typo__color--success\">\n                                {result.price === 0 ? (\n                                    'FREE'\n                                ) : (\n                                    <>\n                                        <img\n                                            src=\"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48\"\n                                            style={{\n                                                width: 20,\n                                                height: 20,\n                                                objectFit: 'contain',\n                                            }}\n                                            alt=\"USDC\"\n                                        />\n                                        &nbsp;{result.price}\n                                    </>\n                                )}\n                            </div>\n                        </div>\n                    </div>\n                )\n            })\n        return searchResultsDOM\n    }\n\n    return (\n        <Backdrop show={Show}>\n            <Modal\n                title=\"Search\"\n                open={Show}\n                toggleModal={modalCloseHandler}\n                cancellable\n            >\n                <div className=\"modal_search\">\n                    <input\n                        value={SearchQuery}\n                        onChange={(e) => setSearchQuery(e.target.value)}\n                        type=\"text\"\n                        placeholder=\"Search books and authors\"\n                        className=\"modal_search__input\"\n                    />\n                    <div className=\"modal_search__icon\">\n                        <SearchIcon\n                            width={24}\n                            height={24}\n                            stroke=\"currentColor\"\n                        />\n                    </div>\n                </div>\n                <div className={getSearchResultsClasses()}>\n                    {renderSearchResults()}\n                </div>\n            </Modal>\n        </Backdrop>\n    )\n}\n\nexport default SearchModal\n","import axios from 'axios'\nimport { useNavigate } from 'react-router'\nimport { useEffect, useState } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\n\nimport { setSnackbar } from '../store/actions/snackbar'\nimport { isFilled, isUsable } from '../helpers/functions'\nimport { hideSpinner, showSpinner } from '../store/actions/spinner'\n\nimport { BASE_URL } from '../config/env'\nimport { EXPLORE_PAGE_FILTERS } from '../config/filters'\n\nimport Page from '../components/hoc/Page/Page'\nimport Contracts from '../connections/contracts'\nimport Button from '../components/ui/Buttons/Button'\nimport BookItem from '../components/ui/BookItem/BookItem'\nimport FilterPanel from '../components/ui/FilterPanel/FilterPanel'\nimport { showModal, SHOW_SEARCH_MODAL } from '../store/actions/modal'\nimport SearchModal from '../components/modal/Search/SearchModal'\n\nimport {ReactComponent as FilterIcon} from \"../assets/icons/filter.svg\"\nimport {ReactComponent as SearchIcon} from \"../assets/icons/search.svg\"\nimport GaTracker from '../trackers/ga-tracker'\n\nconst ExplorePage = () => {\n\n\tconst DEFAULT_FILTERS = [{key: 'price', value: null, type: 'range'}, {key: 'genres', value: [], type: 'multiselect'}, {key: 'age_group', value: [], type: 'multiselect'}, {key: 'orderby', value: null, type: 'select'}]\n\n\tconst navigate = useNavigate()\n\tconst dispatch = useDispatch()\n\n\tconst WalletState = useSelector(state => state.WalletState)\n\n\tconst [Nfts, setNfts] = useState([])\n\tconst [WalletAddress, setWalletAddress] = useState(null)\n\tconst [Filters, setFilters] = useState(DEFAULT_FILTERS)\n\tconst [Loading, setLoading] = useState(false)\n\tconst [FiltersPanelOpen, setFiltersPanelOpen] = useState(false)\n\tconst [AllNfts, setAllNfts] = useState([])\n\tconst [maxPrice, setMaxPrice] = useState(100);\n\tconst buyHandler = nft => {\n\t\tGaTracker('event_explore_purchase_new')\n\t\tsetLoading(true)\n\t\tContracts.purchaseNft(WalletAddress, nft.book_address, nft.price.toString(), WalletState.wallet.signer).then(res => {\n\t\t\tdispatch(setSnackbar({show: true, message: \"Book purchased.\", type: 1}))\n\t\t\tconst tokenId = Number(res.events.filter(event => event.eventSignature === \"Transfer(address,address,uint256)\")[0].args[2]._hex)\n\t\t\taxios({\n\t\t\t\turl: BASE_URL+'/api/book/purchase',\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {ownerAddress: WalletAddress, bookAddress: nft.book_address, tokenId}\n\t\t\t}).then(res => {\n\t\t\t\tif(res.status !== 200) dispatch(setSnackbar('NOT200'))\n\t\t\t}).catch(err => {\n\t\t\t\tdispatch(setSnackbar('ERROR'))\n\t\t\t}).finally(() => setLoading(false))\n\t\t\taxios({ url: BASE_URL+'/api/book/copies', method: 'POST', data: { bookAddress: nft.book_address, copies: tokenId } }).then(res => {\n\t\t\t\tif(res.status !== 200) dispatch(setSnackbar('NOT200'))\n\t\t\t}).catch(err => {\n\t\t\t\tdispatch(setSnackbar('ERROR'))\n\t\t\t})\n\t\t}).catch(err => {\n\t\t\tsetLoading(false)\n\t\t\tif(err.code === 4001)\n\t\t\t\tdispatch(setSnackbar({show: true, message: \"Transaction denied by user.\", type: 3}))\n\t\t\telse dispatch(setSnackbar('ERROR'))\n\t\t})\n\t}\n\n\tconst openHandler = nft => {\n\t\tGaTracker('navigate_explore_book')\n\t\tnavigate(`/book/${nft.id}`)\n\t}\n\n\tconst renderNfts = () => {\n\t\tlet nftDOM = []\n\t\tNfts.forEach(nft => {\n\t\t\tnftDOM.push(<BookItem layout={window.innerWidth<600?\"LIST\":\"GRID\"} key={nft.id} book={nft} onBuy={()=>buyHandler(nft)} onOpen={()=>openHandler(nft)}/>)\n\t\t})\n\t\treturn nftDOM\n\t}\n\n\tuseEffect(() => { GaTracker('page_view_explore') }, [])\n\n\tuseEffect(() => {\n\t\tif(Loading) dispatch(showSpinner())\n\t\telse dispatch(hideSpinner())\n\t}, [Loading, dispatch])\n\n\tuseEffect(() => {\n\t\tsetLoading(true)\n\t\taxios({\n\t\t\turl: BASE_URL + '/api/book',\n\t\t\tmethod: 'GET'\n\t\t}).then(res => {\n\t\t\tif(res.status === 200) setAllNfts(res.data)\n\t\t\telse dispatch(setSnackbar('NOT200'))\n\t\t}).catch(err => {\n\t\t\tdispatch(setSnackbar('ERROR'))\n\t\t}).finally(() => setLoading(false))\n\t}, [dispatch])\n\n\tuseEffect(() => {\n\t\tsetLoading(true)\n\t\tif(isUsable(WalletState.wallet.provider)) setWalletAddress(WalletState.wallet.address)\n\t\tsetLoading(false)\n\t}, [WalletState])\n\n\tuseEffect(() => {\n\t\tlet nfts = AllNfts\n\t\tif(isUsable(nfts)){\n\t\t\tFilters.forEach(filter => {\n\t\t\t\tswitch (filter.type) {\n\t\t\t\t\tcase 'range':\n\t\t\t\t\t\tif(isUsable(filter.value))\n\t\t\t\t\t\tnfts = nfts.filter(nft => nft[filter.key] <= filter.value)\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 'multiselect':\n\t\t\t\t\t\tif(isFilled(filter.value)){\n\t\t\t\t\t\t\tlet tempNfts = []\n\t\t\t\t\t\t\tfilter.value.forEach(filterValue => nfts.forEach(nft => { if(nft[filter.key].indexOf(filterValue)>-1 && tempNfts.filter(tempNft => tempNft[\"id\"] === nft.id).length<1) tempNfts.push(nft) }) )\n\t\t\t\t\t\t\tnfts = tempNfts\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak\n\t\t\t\t\tcase 'select':\n\t\t\t\t\t\tif(filter.key === 'orderby'){\n\t\t\t\t\t\t\tswitch (filter.value) {\n\t\t\t\t\t\t\t\tcase 'PRICE_L_H':\n\t\t\t\t\t\t\t\t\tnfts.sort((a,b) => a.price<b.price)\n\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\tcase 'PRICE_H_L':\n\t\t\t\t\t\t\t\t\tnfts.sort((a,b) => a.price>b.price)\n\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\tcase 'RATING_L_H':\n\t\t\t\t\t\t\t\t\tnfts.sort((a,b) => a.rating<b.rating)\n\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\tcase 'RATING_H_L':\n\t\t\t\t\t\t\t\t\tnfts.sort((a,b) => a.rating>b.rating)\n\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t})\n\t\t\tsetNfts(nfts)\n\t\t}\n\t}, [Filters, AllNfts])\n\n\tuseEffect(()=>{\n\t\tif(!isFilled(AllNfts)) return ;\n\t\tlet maxNftPrice = Math.max(...AllNfts.map(nft => nft.price));\n\t\tmaxNftPrice = Math.ceil(maxNftPrice / 10) * 10 ; \n\t\tsetMaxPrice(maxNftPrice||100)\n\t},[AllNfts])\n\n\tconst onSearch = () => {\n\t\tdispatch(showModal(SHOW_SEARCH_MODAL));\n\t}\n\n\treturn (\n\t\t<Page noFooter={true} showRibbion={false} noPadding={true} fluid={true} containerClass={'explore'}>\n\t\t\t<div className=\"explore__data\">\n\t\t\t\t<div className=\"explore__data__filter-panel-container\" data-filter-open={FiltersPanelOpen}>\n\t\t\t\t\t<FilterPanel maxPrice={maxPrice} setFiltersPanelOpen={setFiltersPanelOpen} config={EXPLORE_PAGE_FILTERS} defaults={DEFAULT_FILTERS} filters={Filters} setFilters={setFilters}/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"explore__data__books\" data-filter-open={FiltersPanelOpen}> \n\t\t\t\t\t<div className=\"explore__data__books__header\">\n\t\t\t\t\t\t<div className='explore__data__books__header__filter'>\n\t\t\t\t\t\t\t<Button type=\"icon\" onClick={()=>setFiltersPanelOpen(s=>!s)}><FilterIcon fill={FiltersPanelOpen?\"currentColor\":\"transparent\"} /></Button>\n\t\t\t\t\t\t\t<div className=\"typo__body typo__color--n500\">Found <span className=\"typo__color--n700\" style={{fontWeight:\"500\"}}>{Nfts.length}</span> results</div>\n\t\t\t\t\t\t</div>{\n\t\t\t\t\t\t\twindow.innerWidth<600?<div className=\"explore__data__books__header__layout\">\n\t\t\t\t\t\t\t<Button className=\"account__data__books__header__layout__button typo__act\" onClick={()=>onSearch()} ><SearchIcon/></Button>\n\t\t\t\t\t\t</div>:null\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"explore__data__books__wrapper\" data-layout={window.innerWidth<600?\"LIST\":\"GRID\"}>\n\t\t\t\t\t\t{isUsable(Nfts) && Nfts.length > 0\n\t\t\t\t\t\t\t? \trenderNfts()\n\t\t\t\t\t\t\t: \t<div className='explore__data__books__wrapper__empty'>\n\t\t\t\t\t\t\t\t\t<img src='https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/fb06196e-29ca-4c59-9460-6fdbd43fa700/square240' alt=\"books shelf\" className=\"explore__data__books__wrapper__image\" loading=\"lazy\"/>\n\t\t\t\t\t\t\t\t\t<h4 className=\"typo__head typo__head--4\">No eBooks yet</h4>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<SearchModal/>\n\t\t</Page>\n\t)\n}\n\nexport default ExplorePage\n"],"names":["Modal","title","open","children","toggleModal","cancellable","dispatch","useDispatch","useEffect","window","document","documentElement","style","overflowY","Backdrop","show","hideOnClick","className","classes","push","join","getClasses","Button","type","onClick","hideModal","navigate","useNavigate","ModalState","useSelector","state","useState","Loading","setLoading","Show","setShow","SearchResults","setSearchResults","SearchQuery","setSearchQuery","length","axios","url","BASE_URL","method","params","query","then","res","status","data","setSnackbar","catch","err","finally","SHOW_SEARCH_MODAL","showSpinner","hideSpinner","value","onChange","e","target","placeholder","width","height","stroke","isFilled","getSearchResultsClasses","searchResultsDOM","forEach","result","src","cover_public_url","cover","alt","loading","author","price","objectFit","id","renderSearchResults","DEFAULT_FILTERS","key","WalletState","Nfts","setNfts","WalletAddress","setWalletAddress","Filters","setFilters","FiltersPanelOpen","setFiltersPanelOpen","AllNfts","setAllNfts","maxPrice","setMaxPrice","GaTracker","isUsable","wallet","provider","address","nfts","filter","nft","tempNfts","filterValue","indexOf","tempNft","sort","a","b","rating","maxNftPrice","Math","max","map","ceil","Page","noFooter","showRibbion","noPadding","fluid","containerClass","FilterPanel","config","EXPLORE_PAGE_FILTERS","defaults","filters","s","fill","fontWeight","innerWidth","showModal","nftDOM","BookItem","layout","book","onBuy","Contracts","book_address","toString","signer","message","tokenId","Number","events","event","eventSignature","args","_hex","ownerAddress","bookAddress","copies","code","buyHandler","onOpen","openHandler","renderNfts"],"sourceRoot":""}