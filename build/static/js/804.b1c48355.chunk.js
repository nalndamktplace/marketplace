"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[804],{3483:function(e,a,t){t.d(a,{x:function(){return n}});var n=["Adventure","Art","Autobiography","Biography","Business","Children's","Children's History","Classics","Comics","Contemporary Fiction","Cookbooks","Crime Fiction","Drama","Dystopian","Essays","Family","Fantasy","Fiction","Food & Drink","Graphic Novels","Guide / How-To","Health","Historical Fiction","History","Horror","Humanities & Social Sciences","Humor","LGBTQ+","Literary Fiction","Magical Realism","Management","Memoir","Music","Mystery","New Adult","Parenting & Families","Personal Development","Philosophy","Photography","Poetry","Politics","Psychological Thrillers","Psychology","Relationships","Religion & Spirituality","Romance","Science","Science & Technology","Science Fiction","Self Help","Short Story","Society & Culture","Sports","Thriller","Travel","Women's Fiction","Young Adult"]},3804:function(e,a,t){t.r(a),t.d(a,{default:function(){return H}});var n,o,r,i,s=t(5861),l=t(1413),p=t(885),_=t(7757),c=t.n(_),u=t(4569),d=t.n(u),h=t(2426),b=t.n(h),f=t(6871),g=t(2791),m=t(6030),v=t(8979),y=t(3958),k=t(5899),x=t(733),w=t(4643),j=t(9316),Z=t(4127),S=t(5454),N=t(184),E=function(e){var a=e.progress,t=(0,g.useRef)();return(0,g.useEffect)((function(){var e;null===t||void 0===t||null===(e=t.current)||void 0===e||e.style.setProperty("--progress",a)}),[a]),(0,N.jsx)("div",{className:"progressbar",children:(0,N.jsx)("div",{ref:t,className:"progressbar__value"})})},F=["title","titleId"];function C(){return C=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},C.apply(this,arguments)}function P(e,a){if(null==e)return{};var t,n,o=function(e,a){if(null==e)return{};var t,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||(o[t]=e[t]);return o}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function O(e,a){var t=e.title,s=e.titleId,l=P(e,F);return g.createElement("svg",C({xmlns:"http://www.w3.org/2000/svg",width:48,height:48,viewBox:"0 0 48 48",ref:a,"aria-labelledby":s},l),t?g.createElement("title",{id:s},t):null,n||(n=g.createElement("line",{x2:.02,transform:"translate(30 16)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),o||(o=g.createElement("rect",{width:32,height:32,rx:3,transform:"translate(8 8)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),r||(r=g.createElement("path",{d:"M4,19.67l8-8a4.029,4.029,0,0,1,6,0l10,10",transform:"translate(4 10.33)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})),i||(i=g.createElement("path",{d:"M14,15.67l2-2a4.029,4.029,0,0,1,6,0l4,4",transform:"translate(14 12.33)",fill:"none",stroke:"currentcolor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3.6})))}var L=g.forwardRef(O),I=(t.p,t(3483)),T=t(5248),D=["EN - English","ZH - Chinese","DE - German","ES - Spanish","JA - Japanese","RU - Russian","FR - French","KO - Korean","IT - Italian","NL - Dutch","PT - Portugese","HI - Hindi","PL - Polish","DA - Danish","BN - Bangla"],G=["Children (0-14 years)","Youth (15-24 years)","Adults (25-64 years)","Seniors 65+"],R=t(8669),H=function(e){var a=(0,m.I0)(),t=(0,f.s0)(),n=(0,m.v9)((function(e){return e.UserState})),o=(0,m.v9)((function(e){return e.WalletState})),r=(0,g.useState)(!1),i=(0,p.Z)(r,2),_=i[0],u=i[1],h=(0,g.useState)(null),F=(0,p.Z)(h,2),C=F[0],P=F[1],O=(0,g.useState)(null),H=(0,p.Z)(O,2),A=H[0],B=H[1],M=(0,g.useState)({name:"",author:"",cover:null,preview:null,book:null,genres:[],ageGroup:[],price:"",pages:"",publication:"",isbn:"",synopsis:"",language:"",published:"",secondarySalesDate:"",primarySales:"",secondaryFrom:b()().add(1,"days")}),U=(0,p.Z)(M,2),W=U[0],J=U[1],Y=(0,g.useState)(0),z=(0,p.Z)(Y,2),V=z[0],K=z[1],q=(0,g.useState)(!0),Q=(0,p.Z)(q,2),X=Q[0],$=Q[1];function ee(){return(ee=(0,s.Z)(c().mark((function e(){var r,i,s,l,p,_,h,f,g,m,v,y,Z,S;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=W.name,i=W.author,s=W.cover,l=W.book,p=W.genres,_=W.ageGroup,h=W.price,f=W.pages,g=W.publication,m=W.synopsis,v=W.language,y=W.published,Z=W.secondaryFrom,(0,j.fb)(r)&&(0,j.vd)(i)&&(0,j.fb)(s)&&(0,j.fb)(l)&&(0,j.fb)(p)&&(0,j.fb)(_)&&(0,j.fb)(h)&&(0,j.fb)(f)&&(0,j.fb)(m)&&(0,j.fb)(v)&&(0,j.fb)(y)&&(0,j.fb)(Z)?((0,k.Z)("event_publish_list"),u(!0),(S=new FormData).append("book",W.book),S.append("cover",W.cover),S.append("bookTitle",W.title),S.append("synopsis",W.synopsis),d()({url:T._+"/api/book/submarine",method:"POST",headers:{"user-id":n.user.uid,address:n.user.wallet,authorization:"Bearer ".concat(n.tokens.acsTkn.tkn)},data:S}).then((function(e){var n=e.data.book.url,c=e.data.cover.url,k=[];p.forEach((function(e){return k.push(I.x.indexOf(e).toString())}));var S=D.indexOf(v).toString(),N=Math.round(b().duration(W.secondaryFrom-b()()).asDays());(0,j.fb)(S)&&(0,j.fb)(k)&&!isNaN(N)&&(0,j.vd)(r)&&(0,j.vd)(i)&&(0,j.fb)(s)&&(0,j.fb)(l)&&(0,j.vd)(f)?x.Z.listNftForSales(A,c,h,N,S,k,o.wallet.signer).then((function(e){var o=e.events.filter((function(e){return"OwnershipTransferred"===e.event}))[0].address,s=e.status,l=e.transactionHash;if((0,j.fb)(o)&&(0,j.fb)(s)&&1===s&&(0,j.fb)(l)){var b=new FormData;b.append("epub",W.preview),b.append("name",r),b.append("author",i),b.append("cover",c),b.append("coverFile",W.cover),b.append("book",n),b.append("genres",JSON.stringify(p.sort((function(e,a){return e>a})))),b.append("ageGroup",JSON.stringify(_.sort((function(e,a){return e>a})))),b.append("price",h),b.append("pages",f),b.append("publication",g),b.append("synopsis",m.replace(/<[^>]+>/g,"")),b.append("language",v),b.append("published",y),b.append("secondarySalesFrom",Z),b.append("publisherAddress",A),b.append("bookAddress",o),b.append("txHash",l),d()({url:T._+"/api/book/publish",method:"POST",data:b}).then((function(e){200===e.status?((0,R.SR)("publish-book-form-data"),u(!1),t("/library",{state:{tab:"published"}})):a((0,w.e1)("ERROR"))})).catch((function(e){(0,j.fb)(e.response)?413===e.response.status?a((0,w.e1)("LIMIT_FILE_SIZE")):415===e.response.status&&a((0,w.e1)("INVALID_FILE_TYPE")):a((0,w.e1)("NOT200")),u(!1)}))}else u(!1),(0,j.fb)(l)?a((0,w.e1)({show:!0,message:"The transaction to mint eBook failed.\ntxhash: ".concat(l),type:3})):a((0,w.e1)({show:!0,message:"The transaction to mint eBook failed.",type:3}))})).catch((function(e){a((0,w.e1)("NOT200")),u(!1)})):(a((0,w.e1)({show:!0,message:"Incomplete details",type:3})),u(!1))})).catch((function(e){(0,j.fb)(e.response)?413===e.response.status?a((0,w.e1)("LIMIT_FILE_SIZE")):415===e.response.status&&a((0,w.e1)("INVALID_FILE_TYPE")):a((0,w.e1)("NOT200")),u(!1)}))):a((0,w.e1)({show:!0,message:"Incomplete details",type:3}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,g.useEffect)((function(){(0,k.Z)("page_view_publish")}),[]),(0,g.useEffect)((function(){(0,j.fb)(W.cover)&&P(URL.createObjectURL(W.cover))}),[W]),(0,g.useEffect)((function(){a(_?(0,Z.yh)():(0,Z.v3)())}),[_,a]),(0,g.useEffect)((function(){u(!0),(0,j.fb)(o.wallet.provider)&&B(o.wallet.address),u(!1)}),[o]),(0,g.useEffect)((function(){var e=["publication","isbn","primarySales","secondarySalesDate"],a=0,t=Object.keys(W).length;Object.keys(W).forEach((function(n){var o;if(e.includes(n))return t--;""!==W[n]&&0!==(null===(o=W[n])||void 0===o?void 0:o.length)&&null!==W[n]&&a++})),K(a/t)}),[W]),(0,g.useEffect)((function(){if(window.localStorage)try{(0,k.Z)("event_publish_load_data");var e=JSON.parse(window.localStorage.getItem("publish-book-form-data"));if(!(0,j.fb)(e))return void $(!1);J((0,l.Z)((0,l.Z)({},W),{},{name:e.name,author:e.author,genres:e.genres,ageGroup:e.ageGroup,price:e.price,pages:e.pages,publication:e.publication,synopsis:e.synopsis,language:e.language})),$(!1)}catch(a){$(!1)}}),[]),(0,g.useEffect)((function(){(0,k.Z)("event_publish_save_data"),X||window.localStorage&&window.localStorage.setItem("publish-book-form-data",JSON.stringify(W))}),[W,X]),(0,N.jsx)(v.Z,{noFooter:!0,containerClass:"publish publish__bg",children:(0,N.jsxs)("div",{className:"publish__data",children:[(0,N.jsxs)("div",{className:"publish__data__form utils__padding__bottom--s",children:[(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Publish eBook"}),(0,N.jsx)(y.Z,{type:"string",label:"book name",value:W.name,onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{name:e.target.value}))},description:"Enter name of the book"}),(0,N.jsx)(y.Z,{type:"string",label:"book author",value:W.author,onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{author:e.target.value}))},description:"Enter name of the author"}),(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Upload Files"}),(0,N.jsx)(y.Z,{type:"file",label:"cover",accept:"image/*",onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{cover:e.target.files[0]}))},description:"Upload a picture of book cover. File types supported: JPG, PNG, GIF, SVG, WEBP"}),(0,N.jsx)(y.Z,{type:"file",label:"preview",accept:"application/epub+zip",onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{preview:e.target.files[0]}))},description:"Upload a sample of book for preview. File types supported: EPUB"}),(0,N.jsx)(y.Z,{type:"file",label:"book",accept:"application/epub+zip",onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{book:e.target.files[0]}))},description:"Upload a book. File types supported: EPUB"}),(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Meta Data"}),(0,N.jsx)(y.Z,{type:"number",label:"price in USDC",value:W.price,onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{price:e.target.value}))},description:"Price of book in USDC"}),(0,N.jsx)(y.Z,{type:"list",label:"genres",listType:"multiple",minLimit:1,maxLimit:5,values:I.x,value:W.genres,onSave:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{genres:e}))},placeholder:"e.g., Action, Adventure",description:"Select genres for the book. Max 5 genres can be selected"}),(0,N.jsx)(y.Z,{type:"list",label:"age group",listType:"multiple",minLimit:1,maxLimit:G.length,values:G,value:W.ageGroup,onSave:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{ageGroup:e}))},placeholder:"e.g., Youth (15-24 years)",description:"Select the most appropriate age group for the book."}),(0,N.jsx)(y.Z,{type:"number",label:"number of print pages",value:W.pages,onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{pages:e.target.value}))},description:"Enter number of pages in the book"}),(0,N.jsx)(y.Z,{type:"string",label:"publication",value:W.publication,onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{publication:e.target.value}))},description:"Enter name of the publisher",required:!1}),(0,N.jsx)(y.Z,{type:"text",label:"synopsis",lines:8,value:W.synopsis,onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{synopsis:e.target.value}))},description:"Write a brief description about the book"}),(0,N.jsx)(y.Z,{type:"list",label:"language",listType:"single",values:D,value:W.language,onSave:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{language:e}))},description:"Select the language of the book"}),(0,N.jsx)(y.Z,{type:"date",label:"published",onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{published:e.target.value}))},description:"Enter when book was published"}),(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--b utils__margin__bottom--m",children:"Secondary Sales Conditions"}),(0,N.jsx)(y.Z,{type:"date",label:"open on",min:b()().add(1,"days"),max:b()().add(150,"days"),onChange:function(e){return J((0,l.Z)((0,l.Z)({},W),{},{secondaryFrom:e.target.value}))},description:"From when to start secondary sales"})]}),(0,N.jsx)("div",{className:"publish__data__preview",children:(0,N.jsxs)("div",{className:"publish__data__preview__container",children:[(0,N.jsx)("h3",{className:"typo__head typo__head--5 utils__margin__top--n",children:"Preview"}),(0,N.jsxs)("div",{className:"publish__data__preview__book",onClick:function(){},children:[(0,N.jsx)("div",{className:"publish__data__preview__book__cover",children:(0,j.fb)(C)?(0,N.jsx)("img",{className:"publish__data__preview__book__cover__img",src:C,alt:W.name+" cover"}):(0,N.jsxs)("div",{className:"publish__data__preview__book__cover__placeholder",children:[(0,N.jsx)(L,{stroke:"currentColor"}),(0,N.jsx)("span",{className:"utils__margin__top--m",children:"Book Cover"})]})}),(0,N.jsxs)("div",{className:"publish__data__preview__book__data",children:[(0,N.jsx)("div",{className:"publish__data__preview__book__data__title  typo__head--5",children:W.name}),(0,N.jsx)("div",{className:"publish__data__preview__book__data__author typo__subtitle typo__color--n500",children:W.author}),W.price&&(0,N.jsx)("div",{className:"publish__data__preview__book__data__price typo__color--success",children:0===parseFloat(W.price)?"FREE":(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/59c27d12-e4eb-4f74-7a6e-b33ba6537600/icon48",style:{width:20,height:20,objectFit:"contain"},alt:"USDC"}),"\xa0",W.price]})}),W.language&&(0,N.jsxs)("div",{className:"publish__data__preview__book__data__field",children:[(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__label typo__body typo__color--n700",children:"Language"}),(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__value typo__body typo__color--n500",children:W.language})]}),(0,j.vd)(W.genres)&&(0,N.jsxs)("div",{className:"publish__data__preview__book__data__field",children:[(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__label typo__body typo__color--n700",children:"Genres"}),(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__chips",children:W.genres.map((function(e){return(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__chips__item typo__body",children:e},e)}))})]}),W.publication&&(0,N.jsxs)("div",{className:"publish__data__preview__book__data__field",children:[(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__label typo__body typo__color--n700",children:"Publication"}),(0,N.jsx)("div",{className:"publish__data__preview__book__data__field__value typo__body typo__color--n500",children:W.publication})]})]})]}),(0,N.jsxs)("div",{className:"publish__data__preview__progress",children:[(0,N.jsxs)("div",{className:"publish__data__preview__progress__container",children:[(0,N.jsxs)("div",{className:"publish__data__preview__progress__container__value typo__color--n700",children:[Math.round(100*V),"%"]}),(0,N.jsx)(E,{progress:V})]}),(0,N.jsx)(S.Z,{type:"primary",disabled:!1,size:"lg",onClick:function(){return function(){return ee.apply(this,arguments)}()},children:"Publish"})]})]})})]})})}}}]);
//# sourceMappingURL=804.b1c48355.chunk.js.map