"use strict";(self.webpackChunkmarketplace=self.webpackChunkmarketplace||[]).push([[501],{6501:function(e,t,n){n.r(t);var a=n(2982),s=n(885),r=n(4569),o=n.n(r),c=n(6871),i=n(2791),l=n(6030),u=n(4643),_=n(9316),d=n(4127),f=n(5248),p=n(639),h=n(8979),k=n(733),b=n(5454),x=n(6759),y=n(354),v=n(3930),m=n(5602),g=n(906),j=n(5899),N=n(184);t.default=function(){var e=[{key:"price",value:null,type:"range"},{key:"genres",value:[],type:"multiselect"},{key:"age_group",value:[],type:"multiselect"},{key:"orderby",value:null,type:"select"}],t=(0,c.TH)(),n=(0,c.s0)(),r=(0,l.I0)(),R=(0,l.v9)((function(e){return e.WalletState})),Z=(0,i.useState)(null),w=(0,s.Z)(Z,2),E=w[0],S=w[1],T=(0,i.useState)([]),O=(0,s.Z)(T,2),I=O[0],C=O[1],L=(0,i.useState)(null),P=(0,s.Z)(L,2),G=P[0],H=P[1],A=(0,i.useState)(e),F=(0,s.Z)(A,2),M=F[0],W=F[1],B=(0,i.useState)(!1),D=(0,s.Z)(B,2),q=D[0],z=D[1],Y=(0,i.useState)(!1),J=(0,s.Z)(Y,2),K=J[0],Q=J[1],U=(0,i.useState)(window.innerWidth<600?"LIST":"GRID"),V=(0,s.Z)(U,2),X=V[0],$=V[1],ee=(0,i.useState)([]),te=(0,s.Z)(ee,2),ne=te[0],ae=te[1],se=(0,i.useState)(100),re=(0,s.Z)(se,2),oe=re[0],ce=re[1];return(0,i.useEffect)((function(){S(t.state)}),[t]),(0,i.useEffect)((function(){r(q?(0,d.yh)():(0,d.v3)())}),[q,r]),(0,i.useEffect)((function(){(0,_.fb)(E)&&(z(!0),o()({url:f._+"/api/collections/books?cid="+E.id,method:"GET"}).then((function(e){200===e.status?ae(e.data):r((0,u.e1)("NOT200"))})).catch((function(e){r((0,u.e1)("ERROR"))})).finally((function(){return z(!1)})))}),[r,E]),(0,i.useEffect)((function(){z(!0),(0,_.fb)(R.wallet.provider)&&H(R.wallet.address),z(!1)}),[R]),(0,i.useEffect)((function(){var e=ne;(0,_.fb)(e)&&(M.forEach((function(t){switch(t.type){case"range":(0,_.fb)(t.value)&&(e=e.filter((function(e){return e[t.key]<=t.value})));break;case"multiselect":if((0,_.vd)(t.value)){var n=[];t.value.forEach((function(a){return e.forEach((function(e){e[t.key].indexOf(a)>-1&&n.filter((function(t){return t.id===e.id})).length<1&&n.push(e)}))})),e=n}break;case"select":if("orderby"===t.key)switch(t.value){case"PRICE_L_H":e.sort((function(e,t){return e.price<t.price}));break;case"PRICE_H_L":e.sort((function(e,t){return e.price>t.price}));break;case"RATING_L_H":e.sort((function(e,t){return e.rating<t.rating}));break;case"RATING_H_L":e.sort((function(e,t){return e.rating>t.rating}))}}})),C(e))}),[M,ne]),(0,i.useEffect)((function(){if((0,_.vd)(ne)){var e=Math.max.apply(Math,(0,a.Z)(ne.map((function(e){return e.price}))));e=10*Math.ceil(e/10),ce(e||100)}}),[ne]),(0,i.useEffect)((function(){(0,j.Z)("page_view_collection")}),[]),(0,N.jsx)(h.Z,{noFooter:!0,showRibbion:!1,noPadding:!0,fluid:!0,containerClass:"explore",children:(0,N.jsxs)("div",{className:"explore__data",children:[(0,N.jsx)("div",{className:"explore__data__filter-panel-container","data-filter-open":K,children:(0,N.jsx)(y.Z,{maxPrice:oe,setFiltersPanelOpen:Q,config:p.j,defaults:e,filters:M,setFilters:W})}),(0,N.jsxs)("div",{className:"explore__data__books","data-filter-open":K,children:[(0,N.jsxs)("div",{className:"explore__data__books__header",children:[(0,N.jsxs)("div",{className:"explore__data__books__header__filter",children:[(0,N.jsx)(b.Z,{type:"icon",onClick:function(){return Q((function(e){return!e}))},children:(0,N.jsx)(v.r,{fill:K?"currentColor":"transparent"})}),(0,N.jsxs)("div",{className:"typo__color--n500",children:["Found ",(0,N.jsx)("span",{className:"typo__color--n700",style:{fontWeight:"500"},children:I.length})," results"]})]}),(0,N.jsxs)("div",{className:"explore__data__books__header__layout",children:[(0,N.jsxs)(b.Z,{className:"account__data__books__header__layout__button",onClick:function(){return $("LIST")},children:[(0,N.jsx)(g.r,{}),(0,N.jsx)("span",{children:"List"})]}),(0,N.jsxs)(b.Z,{className:"account__data__books__header__layout__button",onClick:function(){return $("GRID")},children:[(0,N.jsx)(m.r,{}),(0,N.jsx)("span",{children:"GRID"})]})]})]}),(0,N.jsx)("div",{className:"explore__data__books__wrapper","data-layout":X,children:(0,_.fb)(I)&&I.length>0?function(){var e=[];return I.forEach((function(t){e.push((0,N.jsx)(x.Z,{layout:X,book:t,onBuy:function(){return function(e){(0,j.Z)("event_collection_purchase_new"),z(!0),k.Z.purchaseNft(G,e.book_address,e.price.toString(),R.wallet.signer).then((function(t){r((0,u.e1)({show:!0,message:"Book purchased.",type:1}));var n=Number(t.events.filter((function(e){return"Transfer(address,address,uint256)"===e.eventSignature}))[0].args[2]._hex);o()({url:f._+"/api/book/purchase",method:"POST",data:{ownerAddress:G,bookAddress:e.book_address,tokenId:n}}).then((function(e){200!==e.status&&r((0,u.e1)("NOT200"))})).catch((function(e){r((0,u.e1)("ERROR"))})).finally((function(){return z(!1)})),o()({url:f._+"/api/book/copies",method:"POST",data:{bookAddress:e.book_address,copies:n}}).then((function(e){200!==e.status&&r((0,u.e1)("NOT200"))})).catch((function(e){r((0,u.e1)("ERROR"))}))})).catch((function(e){z(!1),4001===e.code?r((0,u.e1)({show:!0,message:"Transaction denied by user.",type:3})):r((0,u.e1)("ERROR"))}))}(t)},onOpen:function(){return function(e){(0,j.Z)("navigate_collection_book"),n("/book",{state:e})}(t)}},t.id))})),e}():(0,N.jsxs)("div",{className:"explore__data__books__wrapper__empty",children:[(0,N.jsx)("img",{src:"https://imagedelivery.net/yOWneHxM1h9mu46Te3Yjwg/fb06196e-29ca-4c59-9460-6fdbd43fa700/square240",alt:"books shelf",className:"explore__data__books__wrapper__image",loading:"lazy"}),(0,N.jsx)("h4",{className:"typo__head typo__head--4",children:"No eBooks yet"})]})})]})]})})}}}]);
//# sourceMappingURL=501.635e3c15.chunk.js.map